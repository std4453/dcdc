{"version":3,"sources":["steps/SongSelection.jsx","steps/MoodboardCanvas.jsx","steps/Moodboard.jsx","steps/Loading.jsx","steps/Length.jsx","steps/Segmentation.jsx","retex/MyNode.js","retex/sockets.js","components/BeanComponent.js","components/InitiatorComponent.js","components/io.js","components/common.js","components/render/FontComponent.js","components/render/index.js","components/render/CanvasComponent.js","components/render/CharComponent.js","components/generation/SplitComponent.js","components/utils.js","components/generation/BalancedAComponent.js","components/generation/BalancedBComponent.js","components/generation/NeutralComponent.js","components/generation/ActiveAComponent.js","components/generation/ActiveBComponent.js","components/generation/index.js","components/calculation/UniformComponent.js","components/calculation/StepComponent.js","components/calculation/conditional.js","components/calculation/index.js","components/index.js","retex/NodeMap.jsx","steps/params.js","retex/engine.js","retex/exec.js","steps/render.js","steps/Generation.jsx","steps/index.js","steps/Rules.jsx","App.jsx","index.js","assets/logo-colored.svg"],"names":["useStyles","makeStyles","form","height","grid","input","width","SongSelection","next","setId","setStep","classes","useForm","register","handleSubmit","onSubmit","useCallback","id","className","Grid","container","justify","spacing","alignItems","direction","item","src","logo","alt","TextField","name","label","variant","size","root","inputRef","required","Button","color","disableElevation","type","Container","maxWidth","Link","href","fillRoundRect","ctx","x","y","radius","save","translate","beginPath","arc","Math","PI","lineTo","closePath","fill","restore","drawShape","shape","canvaswidth","canvasheight","loc1_x","loc1_y","loc2_x","loc2_y","loc3_x","loc3_y","r1","r2","r3","loc_flag","random","fillRect","drawTriangle","drawPentagon","colorGenerate","dan","ene","val","aco","tem","liv","liv_flag","tinycolor","require","hue","sat","bri","hue_arg","sat_arg","bri_arg","bw","text_flag","graph_flag","rand_flag","hue_flag","sat2","bri2","BG","TX","GR","complement","greyscale","shape_flag","toString","fontGenerate","fontName","backupFont","r","log","pow","round","loc_x","loc_y","moveTo","i","ang","rotate","initCanvas","tempo","energy","danceability","acousticness","valence","song","mb","liveness","letterSpacing","fontSize","fontWeight","c","document","getElementById","getContext","fillStyle","style","font","textAlign","fillText","progress","text","marginTop","marginBottom","backgroundColor","outline","CanvasButton","withStyles","boxShadow","padding","Moodboard","setMoodboard","data","artist","album","al_name","featuress","useState","index","selectCanvas","setMB","items","Array","from","length","useEffect","nextStep","xs","Typography","align","onClick","overflow","map","key","Loading","action","a","loadFont","console","LinearProgress","FontFace","load","fonts","add","Length","time","secs","s","m","ss","sm","content","marginLeft","sections","position","section","top","bottom","border","cursor","edge","zIndex","Segmentation","prev","setData","localData","setLocalData","localSections","duration_s","url","prevStep","audio","useMemo","Audio","pause","currentTime","setCurrentTime","playing","setPlaying","onUpdate","onPlay","onPause","addEventListener","removeEventListener","onSeek","_","newVal","play","useDimensions","ref","grey","Slider","value","onChange","max","start","climax","left","right","newData","axis","bounds","onDrag","__","end","duration","onStop","Label","justifyContent","middle","lineHeight","DefaultInput","inputDef","defaultVal","options","controlType","io","props","connections","typeName","path","min","step","Wrapper","children","onPointerMove","MyNode","node","this","initialState","inputDefs","setState","editor","bindSocket","bindControl","state","outputs","controls","inputs","convert","trigger","output","socket","innerRef","control","e","stopPropagation","showControl","Node","sockets","Proxy","any","Rete","Socket","get","obj","prop","combineWith","BeanComponent","outputDefs","Object","keys","displayName","Input","addInput","Output","addOutput","Component","InitiatorComponent","parseFloat","values","expr","parser","Parser","parsed","parse","evaluate","z","textWidth","sizes","background","canvas","scale","parentNode","clientWidth","clientHeight","transform","x0","y0","dir","ignoreWhitespaces","alignBaseline","ch","split","join","bx","by","closed","fontFamily","textBaseline","SplitComponent","parts","randomness","deltas","begin","substring","interp","b","divide","uniform","x1","y1","scatter","opposite","mirrored","vertical","horizontal","n","f","BalancedAComponent","dist","BalancedBComponent","rows","cols","indices","pickRandom","u","v","reduce","count","sort","u1","v1","u2","v2","NeutralComponent","lineSpacing","point","delta","ActiveAComponent","angle","rx","ry","distToLine","x2","y2","abs","sqrt","atan2","sin","shapes","distToShape","p1","p2","newDist","bestCandidate","tries","maxR","minR","polygon","inside","d","push","chosen","debug","chains","chain","splice","candidates","filter","rest","k","dimension","sortAngle","sortScale","shouldSort","sorted","UniformComponent","StepComponent","cond","thres","lt","gt","ind","n0","n1","n2","n3","n4","n5","n6","n7","n8","n9","vals","conditional","common","render","generation","calculation","buttons","NodeMap","defaults","setRoot","NodeEditor","onUpdateRef","useRef","current","use","ConnectionPlugin","ReactRenderPlugin","component","ContextMenuPlugin","components","forEach","fromJSON","on","toJSON","download","JSON","stringify","blob","Blob","saveAs","upload","files","file","readAsText","fileTypes","handleFiles","config","Engine","nodes","graph","inputNodes","nodeInputs","dkey","nid","skey","includes","queue","processed","unprocessed","it","run","newCtx","find","undefined","every","iid","Error","findNode","nodeData","inputVals","sid","worker","call","outputVals","engine","process","balancedA","balancedB","neutral","activeA","activeB","patternType","params","t","float","pattern","char","rotation","easing1","BezierEasing","easing2","sides","square","triangle","pentagon","cos","char2","lyric","chi","outEffect","inEffect","inEndTime","inStartTime","outStartTime","outEndTime","opacity","Color","textColor","alpha","string","easing","patch","seed","rng","seedrandom","modes","enabled","mode","indexOf","num","int","splitMax","ceil","minDist","maxDist","minAngle","maxAngle","side","boxSizing","canvasContainer","bottomInner","title","paddingLeft","Generation","steps","FetchData","fetch","resp","json","FetchFont","lrc","moodboard","family","weight","Lrc","lyrics","chs","Set","method","headers","body","glyphs","arrayBuffer","InitialValues","initial","setInitial","initialGraph","initialRef","timestamp","l","ls","le","sd","idx","len","setParams","Promise","all","exec","then","setCanvas","fn","currentSegment","Date","getTime","initTime","setInitTime","renewTime","renderFrame","lyricIdx","valid","requestAnimationFrame","onFrameWrapped","newParams","nextSteps","prevSteps","theme","createMuiTheme","palette","primary","main","secondary","useAutoSave","saveKey","timeout","actualInitial","localStorage","valueRef","setValue","setTimeout","App","error","setError","defaultInitial","defaultGeneration","setGeneration","generationRef","ReactDOM","querySelector","module","exports"],"mappings":"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","file":"static/js/main.20f2bc04.chunk.js","sourcesContent":["import React, { useCallback } from 'react';\nimport { makeStyles, Button, TextField, Grid, Link, Container } from '@material-ui/core';\nimport { useForm } from 'react-hook-form';\nimport logo from '../assets/logo-colored.svg';\n\nconst useStyles = makeStyles({\n    form: {\n        height: '100%',\n    },\n    grid: {\n        height: '100%',\n    },\n    input: {\n        width: 500,\n    },\n});\n\nfunction SongSelection({ next, setId, setStep }) {\n    const classes = useStyles();\n    const { register, handleSubmit } = useForm();\n    const onSubmit = useCallback(({ id }) => {\n        setId(id);\n        setStep(next);\n    }, [setStep, setId, next]);\n    return (\n        <form onSubmit={handleSubmit(onSubmit)} className={classes.form}>\n            <Grid\n                container\n                justify=\"center\"\n                spacing={4}\n                className={classes.grid}\n                alignItems=\"center\"\n                direction=\"column\"\n            >\n                <Grid item>\n                    <img src={logo} alt=\"\" height=\"51\" />\n                </Grid>\n                <Grid item container\n                    spacing={1}\n                    justify=\"center\"\n                    alignItems=\"center\"\n                >\n                    <Grid item>\n                        <TextField\n                            name=\"id\"\n                            label=\"网易云音乐ID\"\n                            variant=\"outlined\"\n                            size=\"small\"\n                            classes={{ root: classes.input }}\n                            inputRef={register({ required: true })}\n                        />\n                    </Grid>\n                    <Grid item>\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            disableElevation\n                            type=\"submit\"\n                        >\n                            开始创建\n                        </Button>\n                    </Grid>\n                </Grid>\n                <Container maxWidth = 'sm'>\n                    <Link\n                        variant = \"caption\"\n                        href=\"#\"\n                        color=\"secondary\"\n                    >\n                        如何获取?\n                    </Link>\n                </Container>\n            </Grid>\n        </form>\n    )\n}\n\nexport default SongSelection;\n","const initCanvas = (tempo, energy, danceability, acousticness, valence, song, canvaswidth, canvasheight) => {\n    var mb = [];\n    for( var i = 1; i <= 200; i++ ){\n        var [BG,GR,TX,shape,liveness] = colorGenerate(danceability,energy,valence,acousticness,tempo);\n        var [letterSpacing,fontSize,fontWeight,fontName,backupFont] = fontGenerate(danceability,energy,valence,acousticness,tempo);\n        letterSpacing /= 4;\n        fontSize /= 4;\n        let c = document.getElementById(\"littleCanvas\"+i);\n        let ctx = c.getContext(\"2d\");\n        ctx.fillStyle = BG;\n        fillRoundRect(ctx, 0, 0, canvaswidth, canvasheight, 4);\n        ctx.fillStyle = GR;\n        drawShape(ctx, shape, canvaswidth, canvasheight);\n        c.style.letterSpacing = letterSpacing+'px';\n        ctx.font = fontWeight+' '+fontSize+'px '+fontName+'subfont, '+backupFont+'subfont';\n        ctx.fillStyle = TX;\n        ctx.textAlign = \"center\";\n        ctx.fillText(\"动词打次\",(canvaswidth+letterSpacing)*0.5,canvasheight*0.5+fontSize/3);\n        ctx.font = fontWeight+' '+(fontSize*0.5)+'px '+fontName+'subfont, '+backupFont+'subfont';\n        ctx.fillStyle = TX;\n        ctx.textAlign = \"center\";\n        ctx.fillText(fontName,(canvaswidth+letterSpacing)*0.5,canvasheight*0.8);\n        mb[i] = { BG, GR, TX, letterSpacing, fontSize, fontWeight, fontName, backupFont, liveness, shape };\n    }\n    return mb;\n};\n\nconst fillRoundRect = (ctx, x, y, width, height, radius) => {     \n    if (2 * radius > width || 2 * radius > height) { return false; }\n    ctx.save();\n    ctx.translate(x, y); \n    ctx.beginPath(0);\n    ctx.arc(width - radius, height - radius, radius, 0, Math.PI / 2);\n    ctx.lineTo(radius, height);\n    ctx.arc(radius, height - radius, radius, Math.PI / 2, Math.PI);\n    ctx.lineTo(0, radius);\n    ctx.arc(radius, radius, radius, Math.PI, Math.PI * 3 / 2);\n    ctx.lineTo(width - radius, 0);  \n    ctx.arc(width - radius, radius, radius, Math.PI * 3 / 2, Math.PI * 2);  \n    ctx.lineTo(width, height - radius);\n    ctx.closePath();\n    ctx.fill();\n    ctx.restore();\n};\n\nconst drawShape = (ctx, shape, canvaswidth, canvasheight) => {\n    var loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y;\n    var r1, r2, r3;\n    var loc_flag = Math.random();\n    if(loc_flag <= 0.2) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.75, 0.5, 0.5, 0.2, 0.2, 0.8];\n    else if(loc_flag <= 0.4) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.22, 0.3, 0.75, 0.5, 0.5, 0.8];\n    else if(loc_flag <= 0.6) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.43, 0.23, 0.8, 0.6, 0.2, 0.85];\n    else if(loc_flag <= 0.8) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.67, 0.7, 0.25, 0.5, 0.85, 0.2];\n    else if(loc_flag <= 1) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.2, 0.72, 0.53, 0.2, 0.8, 0.7];\n    loc_flag = Math.random()*0.1-0.05;\n    loc1_x += loc_flag;\n    loc1_y += loc_flag;\n    loc2_x += loc_flag;\n    loc2_y += loc_flag;\n    loc3_x += loc_flag;\n    loc3_y += loc_flag;\n\n    if(shape === \"circle\"){\n        [r1,r2,r3] = [0.2,0.15,0.12];\n        ctx.beginPath();\n        ctx.arc(canvaswidth*loc1_x,canvasheight*loc1_y,canvasheight*r1,0,2*Math.PI);\n        ctx.fill();\n        ctx.beginPath();\n        ctx.arc(canvaswidth*loc2_x,canvasheight*loc2_y,canvasheight*r2,0,2*Math.PI);\n        ctx.fill();\n        ctx.beginPath();\n        ctx.arc(canvaswidth*loc3_x,canvasheight*loc3_y,canvasheight*r3,0,2*Math.PI);\n        ctx.fill();\n    }\n    else if(shape === \"square\"){\n        [r1,r2,r3] = [0.2,0.15,0.12];\n        ctx.fillRect(canvaswidth*loc1_x-canvasheight*r1,canvasheight*loc1_y-canvasheight*r1,canvasheight*r1*2,canvasheight*r1*2);\n        ctx.fillRect(canvaswidth*loc2_x-canvasheight*r2,canvasheight*loc2_y-canvasheight*r2,canvasheight*r2*2,canvasheight*r2*2);\n        ctx.fillRect(canvaswidth*loc3_x-canvasheight*r3,canvasheight*loc3_y-canvasheight*r3,canvasheight*r3*2,canvasheight*r3*2);\n    }\n    else if(shape === \"line\"){\n        [r1,r2,r3] = [0.3,0.2,0.15];\n        ctx.fillRect(canvaswidth*loc1_x-canvasheight*r1,canvasheight*loc1_y-canvasheight*0.025,canvasheight*r1*2,canvasheight*0.05);\n        ctx.fillRect(canvaswidth*loc2_x-canvasheight*r2,canvasheight*loc2_y-canvasheight*0.025,canvasheight*r2*2,canvasheight*0.05);\n        ctx.fillRect(canvaswidth*loc3_x-canvasheight*r3,canvasheight*loc3_y-canvasheight*0.025,canvasheight*r3*2,canvasheight*0.05);\n    }\n    else if(shape === \"triangle\"){\n        [r1,r2,r3] = [0.4,0.25,0.2];\n        drawTriangle(ctx,loc1_x,loc1_y,r1,canvaswidth,canvasheight);\n        drawTriangle(ctx,loc2_x,loc2_y,r2,canvaswidth,canvasheight);\n        drawTriangle(ctx,loc3_x,loc3_y,r3,canvaswidth,canvasheight);\n    }\n    else if(shape === \"pentagon\"){\n        [r1,r2,r3] = [0.25,0.16,0.12];\n        drawPentagon(ctx,loc1_x,loc1_y,r1,canvaswidth,canvasheight);\n        drawPentagon(ctx,loc2_x,loc2_y,r2,canvaswidth,canvasheight);\n        drawPentagon(ctx,loc3_x,loc3_y,r3,canvaswidth,canvasheight);\n    }\n}\n\nconst colorGenerate = (dan, ene, val, aco, tem) => {\n    //get liveness\n    var tinycolor = require(\"tinycolor2\");\n    var liv, liv_flag;\n    if(val < 0.4) liv_flag = 0.2 * dan + 0.8 * val;\n    else liv_flag = 0.7 * dan + 0.3 * val;\n    if(aco < 0.2) liv_flag += 0.2;\n\n    if(liv_flag > 0.6) liv = 1;\n    else if(liv_flag > 0.35) liv = 0.5;\n    else liv = 0;\n\n    //color generate\n    var bw = 1;\n    if(Math.random() < 0.3) bw = 0;\n\n    var hue, sat, bri;\n    var hue_arg, sat_arg, bri_arg;\n    var text_flag = 1, graph_flag = 1, rand_flag = 1;\n    var hue_flag = 1.0 - val * 0.5 - dan * 0.25 - ene * 0.25;\n\n    if(Math.random() * 10 < 5) rand_flag = -1;\n\n    if(hue_flag < 0.4) hue_arg = 0;\n    else if(hue_flag < 0.6) hue_arg = 0.5;\n    else hue_arg = 1;\n    \n    if(hue_arg === 0.5) hue = (Math.random() * 150 + 120 + 360) % 360;\n    else if(hue_arg === 0) hue = (20 - rand_flag * hue_flag / 0.4 * 35 + rand_flag * Math.random() * 15 + 360) % 360;\n    else if(hue_arg === 1) hue = (185 - rand_flag * (1 - hue_flag) / 0.4 * 110 + rand_flag * Math.random() * 100 + 360) % 360;\n\n    if(aco > 0.5) sat_arg = (((dan * 1.2 + ene * 1.2 - aco * 2.4) * 100) * 0.5) + 50;\n    else if(dan > 0.6) sat_arg = (((dan * 0.4 + ene * 0.6) * 100) * 0.5) + 50;\n    else sat_arg = (((dan * 0.5 + ene * 0.5 - aco * 0.1) * 100) * 0.5) + 50;\n\n    sat = (Math.random() * 10 - 5 + sat_arg) / 100;\n    if(hue_arg === 0.5) sat *= 0.8;\n\n    bri_arg = (((ene * 0.6 + aco * 0.4) * 100) * 0.3) + val * 120;\n    bri = (Math.random() * 20 - 10 + bri_arg) / 100;\n    if(bri > 0.95) bri = 0.95;\n\n    if(sat > 0.7) sat = 0.7;\n    if(sat < 0.2) sat = 0.2;\n\n    if(sat*0.3 + 0.7 - bri < 0){\n        text_flag = 0;\n        graph_flag = 0;\n    }\n\n    var BG = tinycolor(\"hsv(\" + hue + \",\" + sat + \",\" + bri + \")\");\n    var TX = (text_flag === 0) ? tinycolor(\"hsv(\" + (hue + rand_flag * 10 + 360) % 360 + \",\" + 0.9 + \",\" + 0.2 + \")\") : tinycolor(\"hsv(\" + (hue + rand_flag * 10 + 360) % 360 + \",\" + 0.05 + \",\" + 0.95 + \")\");\n    var sat2, bri2;\n    if(graph_flag === 0){\n        sat2 = sat - 0.05;\n        if(sat2 < 0) sat2 = 0;\n        bri2 = bri + 0.1;\n        if(bri2 > 1) bri2 = 1;\n    }\n    else{\n        sat2 = sat + 0.05;\n        if(sat2 > 1) sat2 = 1;\n        bri2 = bri - 0.1;\n        if(bri2 < 0) bri2 = 0;\n    }\n    var GR = tinycolor(\"hsv(\" + (hue + rand_flag * 20 + Math.random() * 10 + 360) % 360 + \",\" + sat2 + \",\" + bri2 + \")\");\n    if(Math.random() > 0 && liv === 1) GR = GR.complement();\n    \n    if(bw === 0){\n        if(Math.random() > 0.5){\n            BG = tinycolor(\"black\");\n            TX = tinycolor(\"white\");\n        }\n        else{\n            TX = tinycolor(\"black\");\n            BG = tinycolor(\"white\");\n        } \n        if(Math.random() > 0.5) GR = GR.greyscale();\n    }\n    \n    var shape = \"circle\", shape_flag = Math.random();\n    if(shape_flag <= 0.2) shape = \"circle\";\n    else if(shape_flag <= 0.4) shape = \"square\";\n    else if(shape_flag <= 0.6) shape = \"line\";\n    else if(shape_flag <= 0.8) shape = \"triangle\";\n    else if(shape_flag <= 1) shape = \"pentagon\";\n\n    return [BG.toString('rgb'),GR.toString('rgb'),TX.toString('rgb'),shape,liv];\n}\n\nconst fontGenerate = (dan, ene, val, aco, tem) => {\n    var fontName, backupFont, r;\n    if(aco > 0.8){\n        if(Math.random() < 0.2 && ene >= 0.35 && val < 0.3) fontName = \"ORADANO明朝\";\n        else fontName = \"源云明体\";\n    }\n    else if(aco>0.55){\n        if(Math.random() < 0.5 && ene * 0.6+dan * 0.4 >= 0.85) fontName = \"源界明朝\";\n        else if(Math.random() < 0.7  &&  ene * 0.6+dan * 0.4 >= 0.7) fontName = \"装甲明朝\";\n        else fontName = \"思源宋体\";\n    }\n    else if(aco > 0.4){\n        if(ene * 0.6 + dan * 0.4 >= 0.85){\n            r = Math.random();\n            if(r < 0.5) fontName = \"源界明朝\";\n            else if(r < 0.75) fontName = \"思源宋体\";\n            else fontName = \"源石黑体\";\n        }\n        else if(ene * 0.6 + dan * 0.4 >= 0.7){\n            r = Math.random();\n            if(r < 0.7) fontName = \"装甲明朝\";\n            else if(r < 0.85) fontName = \"思源宋体\";\n            else fontName = \"源石黑体\";\n        }\n        else fontName = \"源石黑体\";\n    }\n    else if(aco > 0.02){\n        if(tem < 86 && val > 0.45){\n            r = Math.random();\n            if(r < 0.4) fontName = \"思源黑体\";\n            else if(r < 0.6) fontName = \"清松手写体\";\n            else if(r < 0.8) fontName = \"粉圆\";\n            else fontName = \"资源黑体\";\n        }\n        else fontName = \"思源黑体\"; \n    }\n    else{\n        if(tem < 86 && val > 0.45){\n            r = Math.random();\n            if(r < 0.2) fontName = \"未来荧黑\";\n            else if(r < 0.4) fontName = \"思源黑体\";\n            else if(r < 0.6) fontName = \"清松手写体\";\n            else if(r < 0.8) fontName = \"粉圆\";\n            else fontName = \"资源黑体\";\n        }\n        else fontName = \"未来荧黑\";\n    }\n\n    if(fontName === \"ORADANO明朝\" || fontName === \"源云明体\" || fontName === \"源界明朝\" || fontName === \"装甲明朝\") backupFont = \"思源宋体\";\n    else if(fontName === \"源石黑体\") backupFont = \"思源黑体\";\n    else if(fontName === \"粉圆\") backupFont = \"资源黑体\";\n    else backupFont = \"未来荧黑\";\n\n    var letterSpacing = 0;\n    var fontWeight = 300;\n    var fontSize = 60;\n\n    letterSpacing = -0.7949 - 18.2496 * Math.log(ene);\n    fontSize = 40 * Math.pow(7,ene);\n    if(ene < 0.2) fontWeight = 100;\n    else if(ene >= 0.9) fontWeight = 900;\n    else fontWeight = Math.round(ene * 10) * 100;\n\n    return [letterSpacing, fontSize, fontWeight, fontName, backupFont];\n}\n\nconst drawTriangle = (ctx, loc_x, loc_y, r, canvaswidth, canvasheight) => {\n    ctx.beginPath();\n    ctx.moveTo(canvaswidth*loc_x+canvasheight*0.5*r, canvasheight*loc_y+canvasheight*0.433*r);\n    ctx.lineTo(canvaswidth*loc_x-canvasheight*0.5*r, canvasheight*loc_y+canvasheight*0.433*r);\n    ctx.lineTo(canvaswidth*loc_x, canvasheight*loc_y-canvasheight*0.433*r);\n    ctx.fill();\n}\n\nconst drawPentagon = (ctx, loc_x, loc_y, r, canvaswidth, canvasheight) => {\n    ctx.save();\n    ctx.translate(canvaswidth*loc_x, canvasheight*loc_y+canvasheight*r*0.25);\n    ctx.moveTo(0, -canvasheight*r);\n    ctx.beginPath();\n    var i, ang = Math.PI*2/5;\n    for(i = 0; i < 5; i++){\n        ctx.rotate(ang);\n        ctx.lineTo(0, -canvasheight*r);\n    }\n    ctx.closePath();\n    ctx.fill();\n    ctx.restore();\n}\n\nexport default initCanvas;\n","import React, { useCallback, useState, useEffect } from 'react';\nimport { makeStyles, withStyles, Button, Grid, Typography } from '@material-ui/core';\nimport initCanvas from './MoodboardCanvas';\n\nconst useStyles = makeStyles({\n    grid: {\n        height: '100%',\n    },\n    progress: {\n        width: 600,\n    },\n    text: {\n        marginTop: '1em',\n        marginBottom: '8em',\n    },\n    '@global': {\n        '*::-webkit-scrollbar': {\n            width: '0.4em'\n        },\n        '*::-webkit-scrollbar-track': {\n            '-webkit-box-shadow': 'inset 0 0 6px rgba(0,0,0,0.00)'\n        },\n        '*::-webkit-scrollbar-thumb': {\n            backgroundColor: 'rgba(80,80,80,.1)',\n            outline: '1px solid slategrey'\n        }\n    }\n});\n\nconst CanvasButton = withStyles({\n    root: {\n        boxShadow: 'none',\n        backgroundColor: '#121212',\n        padding: '0 0',\n        '&:hover': {\n            boxShadow: '0 0 0 0.06rem #BBBBBB',\n        },\n        '&:focus': {\n            boxShadow: '0 0 0 0.06rem #BB86FC',\n        },\n    },\n})(Button);\n\nconst [canvaswidth, canvasheight] = [320, 180];\n\nfunction Moodboard({\n    setStep, next,\n    setMoodboard,\n    data: {\n        song,\n        artist,\n        album: { al_name: album },\n        featuress: { tempo, energy, danceability, acousticness, valence }\n    },\n}) {\n    const classes = useStyles();\n    const [index, selectCanvas] = useState(-1);\n    const [mb, setMB] = useState([]);\n    const items = Array.from({length: 200});\n    useEffect(() => {\n        setMB(initCanvas(tempo, energy, danceability, acousticness, valence, song, canvaswidth, canvasheight));\n    }, [acousticness, danceability, energy, song, tempo, valence]);\n    const nextStep = useCallback(() => {\n        setStep(next);\n        setMoodboard(mb[index]);\n    }, [mb, index, setStep, setMoodboard, next]);\n    return (\n        <Grid\n            container\n            spacing={4}\n            className={classes.grid}\n        >\n            <Grid item xs />\n            <Grid item xs={8}>\n                <Typography\n                    align=\"center\"\n                    color=\"textSecondary\"\n                    classes={{ root: classes.text }}\n                >\n                    {song} / {artist} - {album}\n                </Typography>\n                <Grid container\n                    alignItems=\"center\"\n                    justify=\"space-evenly\"\n                    spacing={6}\n                >\n                    <Grid item container direction=\"column\" xs>\n                        <Grid item>\n                            <Typography\n                                color=\"textPrimary\"\n                                variant=\"h4\"\n                            >\n                                选择情绪板\n                            </Typography>\n                        </Grid>\n                        <Grid item>\n                            <Typography\n                                color=\"textSecondary\"\n                                variant=\"body2\"\n                            >\n                                为您的歌词动画选择外观风格\n                            </Typography>\n                        </Grid>\n                    </Grid>\n                    <Grid item>\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            disableElevation\n                            onClick={nextStep}\n                        >\n                            继续创建\n                        </Button>\n                    </Grid>\n                </Grid>\n                <div style={{height:'80vh', overflow:'hidden auto'}}>\n                    <Grid container \n                        alignItems=\"center\" \n                        justify=\"space-between\" \n                        spacing={6}\n                        className={classes.grid}\n                    >\n                        {items.map((i, index) => (\n                            <Grid item key = {index}>\n                                <CanvasButton>\n                                    <canvas\n                                        id={\"littleCanvas\"+(index+1)}\n                                        width={canvaswidth}\n                                        height={canvasheight}\n                                        onClick={()=>selectCanvas(index+1)}\n                                    >\n                                    </canvas>\n                                </CanvasButton>\n                            </Grid>\n                        ))}\n                    </Grid>\n                </div>\n            </Grid>\n            <Grid item xs />\n        </Grid>\n    )\n}\n\nexport default Moodboard;\n","import React, { useEffect, useMemo } from 'react';\nimport { makeStyles, LinearProgress, Grid } from '@material-ui/core';\nimport { Lrc } from 'lrc-kit';\nimport logo from '../assets/logo-colored.svg';\n\nfunction FetchData({ id, setData, ...params }) {\n    const action = useMemo(async () => {\n        const resp = await fetch(`https://dcdcapi.herokuapp.com/song/${id}`);\n        const data = await resp.json();\n        setData(data);\n    }, [id, setData]);\n    return (\n        <Loading {...params} action={action} />\n    );\n}\n\nfunction FetchFont({\n    data: { lrc },\n    moodboard: { fontName: family, fontWeight: weight },\n    ...params\n}) {\n    const action = useMemo(async () => {\n        const { lyrics } = Lrc.parse(lrc);\n        const chs = new Set();\n        for (const { content } of lyrics) {\n            for (const ch of content) {\n                chs.add(ch);\n            }\n        }\n        const resp = await fetch('https://dcdcapi.herokuapp.com/font', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                font: family,\n                weight: weight,\n                glyphs: Array.from(chs).join(''),\n            }),\n        });\n        const blob = await resp.arrayBuffer();\n        const font = new FontFace(family, blob, { weight });\n        await font.load();\n        document.fonts.add(font);\n    }, [family, lrc, weight]);\n    return (\n        <Loading {...params} action={action} />\n    );\n}\n\nconst useStyles = makeStyles({\n    grid: {\n        height: '100%',\n    },\n    progress: {\n        width: 600,\n    },\n});\n\nfunction Loading({ setStep, next, action }) {\n    const classes = useStyles();\n    useEffect(() => {\n        (async () => {\n            try {\n                loadFont();\n                await action;\n                setStep(next);\n            } catch (e) {\n                console.log(e);\n            }\n        })();\n    }, [setStep, action, next]);\n\n    return (\n        <Grid\n            container\n            justify=\"center\"\n            spacing={4}\n            className={classes.grid}\n            alignItems=\"center\"\n            direction=\"column\"\n        >\n            <Grid item>\n                <img src={logo} alt=\"\" height=\"51\" />\n            </Grid>\n            <Grid item classes={{ root: classes.progress }}>\n                <LinearProgress />\n            </Grid>\n        </Grid>\n    );\n}\n\nconst loadFont = async() => {\n    let font = new FontFace('未来荧黑subfont', 'url(未来荧黑subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('思源黑体subfont', 'url(思源黑体subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('源石黑体subfont', 'url(源石黑体subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('清松手写体subfont', 'url(清松手写体subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('粉圆subfont', 'url(粉圆subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('资源黑体subfont', 'url(资源黑体subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('思源宋体subfont', 'url(思源宋体subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('源云明体subfont', 'url(源云明体subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('装甲明朝subfont', 'url(装甲明朝subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('源界明朝subfont', 'url(源界明朝subfont.ttf)');\n    await font.load();\n    document.fonts.add(font);\n    font = new FontFace('ORADANO明朝subfont', 'url(ORADANO明朝subfont.ttf)');\n    await font.load();\n}\n\nexport { FetchData, FetchFont };\n","function Length({ time }) {\n    const secs = Math.round(time);\n    const s = secs % 60, m = ~~(secs / 60);\n    const ss = s < 10 ? `0${s}` : `${s}`, sm = m < 10 ? `0${m}` : `${m}`;\n    return `${sm}:${ss}`;\n}\n\nexport default Length;\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { makeStyles, Button, Grid, Typography, Slider } from '@material-ui/core';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport grey from '@material-ui/core/colors/grey';\nimport Draggable from 'react-draggable'; // The default\nimport useDimensions from \"react-use-dimensions\";\nimport * as _ from 'lodash';\nimport Length from './Length';\n\nconst useStyles = makeStyles({\n    grid: {\n        height: '100%',\n    },\n    progress: {\n        width: 600,\n    },\n    text: {\n        marginTop: '1em',\n        marginBottom: '8em',\n    },\n    content: {\n        marginTop: '26vh',\n    },\n    time: {\n        marginLeft: 40,\n    },\n    sections: {\n        marginTop: -16,\n        position: 'relative',\n        height: 16,\n    },\n    section: {\n        position: 'absolute',\n        top: 0,\n        bottom: 0,\n        border: '1px solid #121212',\n        cursor: 'pointer',\n        '&:hover': {\n            outline: '1px solid #BB86FC',\n            border: '1px solid #BB86FC',\n        },\n    },\n    edge: {\n        position: 'absolute',\n        top: 0,\n        bottom: 0,\n        zIndex: 2,\n        width: 6,\n        marginLeft: -3,\n        '&:hover': {\n            backgroundColor: '#BB86FC',\n        },\n        cursor: 'ew-resize',\n    },\n});\n\nfunction Segmentation({\n    setStep, next, prev,\n    setData,\n    data: { sections },\n    data,\n}) {\n    const [localData, setLocalData] = useState(data);\n    const {\n        song,\n        artist,\n        album: { al_name: album },\n        sections: localSections,\n        featuress: { duration_s: length },\n        url,\n    } = localData;\n\n    const classes = useStyles();\n    const nextStep = useCallback(() => {\n        setStep(next);\n    }, [setStep, next]);\n    const prevStep = useCallback(() => {\n        setStep(prev);\n    }, [setStep, prev]);\n    const audio = useMemo(() => {\n        return new Audio(url);\n    }, [url]);\n    useEffect(() => {\n        if (!audio) return;\n        return () => audio.pause();\n    }, [audio]);\n    const [currentTime, setCurrentTime] = useState(0);\n    const [playing, setPlaying] = useState(false);\n    useEffect(() => {\n        if (!audio) return;\n        const onUpdate = () => setCurrentTime(audio.currentTime);\n        const onPlay = () => setPlaying(true);\n        const onPause = () => setPlaying(false);\n        audio.addEventListener('timeupdate', onUpdate);\n        audio.addEventListener('play', onPlay);\n        audio.addEventListener('pause', onPause);\n        return () => {\n            audio.removeEventListener('timeupdate', onUpdate);\n            audio.removeEventListener('play', onPlay);\n            audio.removeEventListener('pause', onPause);\n        };\n    }, [audio]);\n    const onSeek = useCallback((_, newVal) => {\n        audio.currentTime = newVal;\n    }, [audio]);\n    const play = useCallback(() => audio.play(), [audio]);\n    const pause = useCallback(() => audio.pause(), [audio]);\n\n    const [ref, { width }] = useDimensions();\n\n    return (\n        <Grid\n            container\n            spacing={4}\n            className={classes.grid}\n        >\n            <Grid item xs />\n            <Grid item xs={8}>\n                <Typography\n                    align=\"center\"\n                    color=\"textSecondary\"\n                    classes={{ root: classes.text }}\n                >\n                    {song} / {artist} - {album}\n                </Typography>\n                <Grid container alignItems=\"center\" justify=\"space-between\" spacing={2}>\n                    <Grid item container direction=\"column\" xs>\n                        <Grid item>\n                            <Typography\n                                color=\"textPrimary\"\n                                variant=\"h4\"\n                            >\n                                调整歌曲分段\n                            </Typography>\n                        </Grid>\n                        <Grid item>\n                            <Typography\n                                color=\"textSecondary\"\n                                variant=\"body2\"\n                            >\n                                拖动段落以调整起止时间\n                            </Typography>\n                        </Grid>\n                    </Grid>\n                    <Grid item>\n                        <Button\n                            variant=\"outlined\"\n                            color=\"primary\"\n                            disableElevation\n                            onClick={prevStep}\n                        >\n                            上一步\n                        </Button>\n                    </Grid>\n                    <Grid item>\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            disableElevation\n                            onClick={nextStep}\n                        >\n                            继续创建\n                        </Button>\n                    </Grid>\n                </Grid>\n                <div className={classes.content}>\n                    <Typography className={classes.time} color=\"textPrimary\" variant=\"body2\">\n                        <Length time={currentTime} />\n                        &nbsp;/&nbsp;\n                        <Length time={length} />\n                    </Typography>\n                    <Grid container spacing={2} alignItems=\"center\">\n                        <Grid item>\n                            {playing ? (\n                                <PauseIcon\n                                    style={{\n                                        color: grey[100],\n                                        cursor: 'pointer',\n                                    }}\n                                    onClick={pause}\n                                />\n                            ) : (\n                                <PlayArrowIcon\n                                    style={{\n                                        color: grey[100],\n                                        cursor: 'pointer',\n                                    }}\n                                    onClick={play}\n                                />\n                            )}\n                        </Grid>\n                        <Grid item xs>\n                            <Slider value={currentTime} onChange={onSeek} max={length} />\n                        </Grid>\n                    </Grid>\n                    <Grid container spacing={2} alignItems=\"center\">\n                        <Grid item>\n                            <PlayArrowIcon style={{ color: \"#121212\" }} />\n                        </Grid>\n                        <Grid item xs>\n                            <div className={classes.sections} ref={ref}>\n                                {localSections.map(({ start, climax }, i) => (\n                                    <div\n                                        key={`section-${i}`}\n                                        className={classes.section}\n                                        style={{\n                                            left: `${start / length * 100}%`,\n                                            right: `${100 - (i === localSections.length - 1 ? length : localSections[i + 1].start) / length * 100}%`,\n                                            backgroundColor: climax === 0 ? '#03DAC5' : '#F2994A',\n                                        }}\n                                        onClick={() => {\n                                            const newData = _.cloneDeep(localData);\n                                            newData.sections[i].climax = 1 - climax;\n                                            setLocalData(newData);\n                                            setData(newData);\n                                        }}\n                                    />\n                                ))}\n                                {new Array(sections.length - 1).fill(0).map((_, i) => i + 1).map(i => (\n                                    <Draggable\n                                        key={`handle=${i}-${sections[i].start}`}\n                                        axis=\"x\"\n                                        bounds={{\n                                            left: -(sections[i].start - sections[i - 1].start) / length * width,\n                                            right: (i === sections.length - 1 ? length : sections[i + 1].start - sections[i].start) / length * width,\n                                        }}\n                                        onDrag={(__, { x }) => {\n                                            const newData = _.cloneDeep(data);\n                                            newData.sections[i].start += x / width * length;\n                                            const end = i === newData.sections.length - 1 ? length : newData.sections[i + 1].start;\n                                            newData.sections[i].duration = end - newData.sections[i].start;\n                                            if (i > 0) newData.sections[i - 1].duration = newData.sections[i].start - newData.sections[i - 1].start;\n                                            setLocalData(newData);\n                                        }}\n                                        onStop={() => {\n                                            setData(localData);\n                                        }}\n                                    >\n                                        <div\n                                            className={classes.edge}\n                                            style={{\n                                                left: sections[i].start / length * width, // unchanged while dragging\n                                            }}\n                                        />\n                                    </Draggable>\n                                ))}\n                            </div>\n                        </Grid>\n                    </Grid>\n                    <Grid container spacing={2} alignItems=\"center\">\n                        <Grid item>\n                            <PlayArrowIcon style={{ color: \"#121212\" }} />\n                        </Grid>\n                        <Grid item xs>\n                            <Typography color=\"textSecondary\" variant=\"body2\" style={{ marginTop: -16 }}>\n                                蓝绿色为普通段，橙色为高潮段，鼠标左击色块可在普通/高潮段状态间切换\n                            </Typography>\n                        </Grid>\n                    </Grid>\n                </div>\n            </Grid>\n            <Grid item xs />\n        </Grid>\n    )\n}\n\nexport default Segmentation;\n","import React from 'react';\nimport { Node, Socket, Control } from 'rete-react-render-plugin';\nimport * as _ from 'lodash';\nimport DatGui, {\n    DatBoolean, DatColor, DatNumber, DatString, DatSelect,\n} from 'react-dat-gui';\nimport typeName from 'type-name';\nimport 'react-dat-gui/dist/index.css';\nimport './styles.css';\n\nfunction Label({ name, align = 'left' }) {\n    return (\n        <li className=\"cr text\">\n            <label style={{ justifyContent: {\n                    left: 'flex-start',\n                    middle: 'center',\n                    right: 'flex-end',\n                }[align] }}>\n                <span style={{ lineHeight: '25px' }}>\n                    {name}\n                </span>\n            </label>\n        </li>\n    );\n}\n\nfunction DefaultInput({ name, inputDef: { type, defaultVal, options, controlType }, inputDef, io, ...props }) {\n    if (io.connections.length !== 0) return <Label name={name} />\n\n    if (!type) type = typeName(defaultVal);\n    if (!controlType) controlType = type;\n\n    if (controlType === 'string') return <DatString path={name} label={name} {...props} />\n    if (controlType === 'boolean') return <DatBoolean path={name} label={name} {...props} />\n    if (controlType === 'number') {\n        const { min, max, step = 0.01 } = inputDef;\n        return <DatNumber path={name} label={name} min={min} max={max} step={step} {...props} />\n    }\n    if (controlType === 'color') return <DatColor path={name} label={name} {...props} />\n    if (controlType === 'select') return <DatSelect path={name} label={name} options={options} {...props} />\n    return <Label name={name} />\n}\n\nfunction Wrapper({ children, className, onPointerMove, ...props }) {\n    return (\n        <div className={className} onPointerMove={onPointerMove}>\n            {children(props)}\n        </div>\n    );\n}\n\nclass MyNode extends Node {\n    componentDidMount() {\n        const { node } = this.props;\n        const initialState = _.fromPairs(_\n            .toPairs(node.inputDefs)\n            .map(([name, { defaultVal }]) => [name, defaultVal]));\n        this.setState({ data: initialState });\n    }\n\n    render() {\n        const { node, editor, bindSocket, bindControl } = this.props;\n        const { data, outputs, controls, inputs /*, selected */ } = this.state;\n\n        return (\n            <DatGui\n                data={data}\n                onUpdate={(newData) => {\n                    newData = { ...data, ...newData };\n                    for (const key in newData) {\n                        const { convert } = node.inputDefs[key];\n                        if (convert) newData[key] = convert(newData[key]);\n                    }\n                    node.data = newData;\n                    this.setState({ data: newData });\n                    editor.trigger('process');\n                }}\n                style={{\n                    position: 'relative',\n                    backgroundColor: '#1A1A1A',\n                }}\n            >\n                <Wrapper>\n                    {() => <>\n                        <Label name={node.name} align=\"middle\" />\n                    </>}\n                </Wrapper>\n                {outputs.map((output) => (\n                    <Wrapper className=\"retex-port retex-output\" key={output.key}>\n                        {() => <>\n                            <Label name={output.name} align=\"right\" />\n                            <Socket type=\"output\" socket={output.socket} io={output} innerRef={bindSocket} />\n                        </>}\n                    </Wrapper>\n                ))}\n                {controls.map(control => (\n                    <Control className=\"control\" key={control.key} control={control} innerRef={bindControl} />\n                ))}\n                {inputs.map(input => (\n                    <Wrapper className=\"retex-port retex-input\" key={input.key} onPointerMove={(e) => { e.stopPropagation(); }}>\n                        {props => <>\n                            <Socket type=\"input\" socket={input.socket} io={input} innerRef={bindSocket} />\n                            {!input.showControl() && <DefaultInput name={input.name} inputDef={node.inputDefs[input.name]} io={input} {...props} />}\n                            {input.showControl() && <Control className=\"input-control\" control={input.control} innerRef={bindControl} />}\n                        </>}\n                    </Wrapper>\n                ))}\n            </DatGui>\n        )\n    }\n}\n\nexport default MyNode;\n","import Rete from 'rete';\n\nconst sockets = new Proxy({\n    any: new Rete.Socket('any'),\n}, {\n    get(obj, prop) {\n        if (!(prop in obj)) {\n            obj[prop] = new Rete.Socket(prop);\n            obj[prop].combineWith(obj.any);\n        }\n        return obj[prop];\n    }\n});\n\nexport default sockets;\n","import Rete from 'rete';\nimport typeName from 'type-name';\nimport * as _ from 'lodash';\n\nimport sockets from '../retex/sockets';\n\nclass BeanComponent extends Rete.Component {\n    constructor(name, inputDefs, outputDefs) {\n        super(name);\n        this.inputDefs = inputDefs;\n        this.outputDefs = outputDefs;\n    }\n    \n    builder(node) {\n        node.inputDefs = _.cloneDeep(this.inputDefs);\n        for (const key of Object.keys(node.inputDefs)) {\n            if (key in node.data) node.inputDefs[key].defaultVal = node.data[key];\n        }\n        node.outputDefs = this.outputDefs;\n        \n        for (let [name, { type, defaultVal, displayName = name }] of _.toPairs(this.inputDefs)) {\n            if (!type) type = typeName(defaultVal);\n            if (name in node.data) defaultVal = node.data[name];\n            const input = new Rete.Input(name, displayName, sockets.any);\n            if (!(name in node.data)) {\n                node.data[name] = defaultVal;\n            }\n            node.addInput(input);\n        }\n        for (const [name, { /* type, */ displayName = name }] of _.toPairs(this.outputDefs)) {\n            const output = new Rete.Output(name, displayName, sockets.any);\n            node.addOutput(output);\n        }\n        return node;\n    }\n}\n\nexport { BeanComponent };\n","import { BeanComponent } from './BeanComponent';\n\nclass InitiatorComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Initiator',\n            {},\n            {},\n        );\n    }\n\n    async worker() {}\n}\n\nexport default InitiatorComponent;\n","import { BeanComponent } from './BeanComponent';\nimport * as _ from 'lodash';\n\nclass InputComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Input',\n            {\n                key: { type: 'string' },\n                type: { defaultVal: 'number', type: 'string', controlType: 'select', options: ['number', 'string'] },\n            },\n            {\n                val: { type: 'any', controlType: 'string', },\n            },\n        );\n    }\n\n    convert(value, type) {\n        if (type === 'number' && typeof value === 'string') return parseFloat(value);\n        if (type === 'string' && typeof value === 'number') return `${value}`;\n        return value;\n    }\n\n    * worker({ key, type }, __, { inputs }) {\n        const values = _.get(inputs, key);\n        if (values instanceof Array) {\n            for (const value of values) {\n                yield {\n                    val: this.convert(value, type),\n                };\n            }\n        } else {\n            yield {\n                val: this.convert(values, type),\n            };\n        }\n    }\n}\n\nclass OutputComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Output',\n            {\n                key: { type: 'string' },\n                val: { type: 'any', controlType: 'string' },\n            },\n            {},\n        );\n    }\n\n    * worker({ val, key }, __, { outputs }) {\n        // if (!_.has(outputs, key)) _.set(outputs, key, []);\n        // _.get(outputs, key).push(val);\n        _.set(outputs, key, val);\n        yield;\n    }\n}\n\nexport default [\n    InputComponent,\n    OutputComponent,\n];\n","import { BeanComponent } from './BeanComponent';\nimport { Parser } from 'expr-eval';\n\nclass ArithmeticComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Eval',\n            {\n                expr: { defaultVal: 'x' },\n                x: { defaultVal: '0', type: 'number' },\n            },\n            {\n                y: { type: 'number' },\n            },\n        );\n        this.parser = new Parser();\n    }\n\n    * worker({ expr, x }) {\n        const parsed = this.parser.parse(expr);\n        yield {\n            y: parsed.evaluate({ x }),\n        };\n    }\n}\n\nclass Arithmetic2Component extends BeanComponent {\n    constructor() {\n        super(\n            'Eval2',\n            {\n                expr: { defaultVal: 'x + y' },\n                x: { defaultVal: '0', type: 'number' },\n                y: { defaultVal: '0', type: 'number' },\n            },\n            {\n                z: { type: 'number' },\n            },\n        );\n        this.parser = new Parser();\n    }\n\n    * worker({ expr, x, y }) {\n        const parsed = this.parser.parse(expr);\n        yield {\n            z: parsed.evaluate({ x, y }),\n        };\n    }\n}\n\nclass ConstComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Const',\n            {\n                val: { type: 'any', controlType: 'string' },\n                type: { defaultVal: 'number', type: 'string', controlType: 'select', options: ['number', 'string'] },\n            },\n            {\n                val: { type: 'string' },\n            },\n        );\n    }\n\n    * worker({ val, type }) {\n        if (type === 'number') val = parseFloat(val);\n        yield { val };\n    }\n}\n\nexport default [\n    ArithmeticComponent,\n    Arithmetic2Component,\n    ConstComponent,\n];\n","/* eslint-disable default-case */\nimport { BeanComponent } from '../BeanComponent';\n\nconst textWidth = (text, sizes, spacing) => {\n    // VERY SIMPLE\n    // return size * text.length + spacing * size * (text.length - 1);\n    let width = 0;\n    for (let i = 0; i < text.length; ++i) {\n        width += sizes[i] * (1 + spacing);\n    }\n    width -= sizes[0] * spacing / 2;\n    width -= sizes[text.length - 1] * spacing / 2;\n    return width;\n}\n\nclass FontComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Font',\n            {\n                text: { defaultVal: '被害妄想携帯女子' },\n                x0: { defaultVal: 960, min: -1000, max: 3000 },\n                y0: { defaultVal: 540, min: -1000, max: 3000 },\n                size: { defaultVal: 90, min: 10, max: 400 },\n                dir: { defaultVal: 'horizontal', type: 'string', controlType: 'select', options: ['horizontal', 'vertical'] },\n                align: { defaultVal: 'begin', type: 'string', controlType: 'select', options: ['begin', 'middle', 'end'] },\n                spacing: { defaultVal: 0, min: -2, max: 2 },\n                ignoreWhitespaces: { defaultVal: true },\n                alignBaseline: { defaultVal: true },\n            },\n            {\n                i: { type: 'number' },\n                ch: { type: 'string' },\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                size: { type: 'number' },\n            },\n        );\n    }\n\n    async * worker({\n        text, x0, y0,\n        size, dir, align,\n        spacing, ignoreWhitespaces,\n        alignBaseline,\n    }) {\n        if (ignoreWhitespaces) text = text.split(/\\s+/).join('');\n        let x = x0, y = y0;\n        const sizes = new Array(text.length).fill(size);\n        const width = textWidth(text, sizes, spacing);\n        if (align === 'middle') {\n            switch (dir) {\n                case 'horizontal':\n                    x -= width / 2;\n                    break;\n                case 'vertical':\n                    y -= width / 2;\n                    break;\n            }\n        }\n        if (align === 'end') {\n            switch (dir) {\n                case 'horizontal':\n                    x -= width;\n                    break;\n                case 'vertical':\n                    y -= width;\n                    break;\n            }\n        }\n        switch (dir) {\n            case 'horizontal':\n                x += sizes[0] / 2;\n                break;\n            case 'vertical':\n                y += sizes[0] / 2;\n                break;\n        }\n        for (let i = 0; i < text.length; ++i) {\n            const ch = text[i];\n            const bx = x;\n            const by = alignBaseline && dir === 'horizontal' ? y - (sizes[i] - size) / 2 : y;\n            yield {\n                i,\n                ch,\n                x0: bx,\n                y0: by,\n                size: sizes[i],\n            };\n            switch (dir) {\n                case 'horizontal':\n                    x += (sizes[i] + sizes[i + 1]) * (1 + spacing) / 2;\n                    break;\n                case 'vertical':\n                    y += (sizes[i] + sizes[i + 1]) * (1 + spacing) / 2;\n                    break;\n            }\n        }\n        this.closed = ['cc'];\n    }\n}\n\nexport default FontComponent;\n","import CanvasComponent from './CanvasComponent';\nimport FontComponent from './FontComponent';\nimport CharComponent from './CharComponent';\n\nexport default [\n    CanvasComponent,\n    FontComponent,\n    CharComponent,\n];\n","import { BeanComponent } from '../BeanComponent';\n\nclass CanvasComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Canvas',\n            {\n                width: { defaultVal: 1920, min: 360, max: 2160 },\n                height: { defaultVal: 1080, min: 240, max: 1920 },\n                background: { type: 'color', defaultVal: '#F2F2F2' },\n            },\n            {\n                ctx: { type: 'canvas' },\n            },\n        );\n    }\n\n    async * worker({ width, height, background }, __, { inputs: { canvas } }) {\n        canvas.width = width;\n        canvas.height = height;\n        const scale = Math.min(canvas.parentNode.clientWidth / canvas.width, canvas.parentNode.clientHeight / canvas.height);\n        canvas.style.transform = `scale(${scale})`;\n        canvas.style.marginLeft = `${-width / 2}px`;\n        canvas.style.marginTop = `${-height / 2}px`;\n        const ctx = canvas.getContext('2d');\n        ctx.fillStyle = background;\n        ctx.fillRect(0, 0, width, height);\n        yield { ctx };\n    }\n}\n\nexport default CanvasComponent;\n","import { BeanComponent } from '../BeanComponent';\n\nclass CharComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Char',\n            {\n                ctx: { type: 'canvas', required: true },\n                ch: { defaultVal: '' },\n                x0: { defaultVal: 960, min: -1000, max: 3000 },\n                y0: { defaultVal: 540, min: -1000, max: 3000 },\n                size: { defaultVal: 90, min: 10, max: 400 },\n                rotate: { defaultVal: 0, min: -1, max: 1 },\n                color: { defaultVal: '#000000', type: 'color' },\n                fontFamily: { defaultVal: 'Hiragino Mincho Pro' },\n                fontWeight: { defaultVal: 900, min: 100, max: 900, step: 100 },\n            },\n            {},\n        );\n    }\n\n    * worker({\n        ctx, ch, x0, y0,\n        size, rotate, color,\n        fontFamily, fontWeight,\n    }) {\n        ctx.textBaseline = 'middle';\n        ctx.textAlign = 'center';\n        ctx.fillStyle = color;\n        ctx.font = `${fontWeight} ${size}px '${fontFamily}'`;\n        ctx.save();\n        ctx.translate(x0, y0);\n        ctx.rotate(rotate * Math.PI);\n        ctx.fillText(ch, 0, 0);\n        ctx.restore();\n        yield;\n    }\n}\n\nexport default CharComponent;\n","import { BeanComponent } from '../BeanComponent';\n\nclass SplitComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Split',\n            {\n                text: { defaultVal: '被害妄想携帯女子' },\n                parts: { defaultVal: 2, min: 1, max: 5, step: 1 },\n                randomness: { defaultVal: 2, min: 0, max: 4, },\n            },\n            {\n                parts: { type: 'number' },\n                i: { type: 'number' },\n                text: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ text, parts, randomness }) {\n        const step = text.length / parts;\n        const deltas = [0, ...new Array(parts - 1).fill(0).map(() => (Math.random() - 0.5) * 2 * randomness), 0];\n        for (let i = 0; i < parts; ++i) {\n            const begin = Math.round(i * step + deltas[i]);\n            const end = Math.round((i + 1) * step + deltas[i + 1]);\n            yield {\n                parts,\n                i,\n                text: text.substring(begin, end),\n            };\n        }\n    }\n}\n\nexport default SplitComponent;\n","const interp = (width, height, a, b, dir = 'horizontal') => {\n    switch (dir) {\n        case 'horizontal': return {\n            x: a * width, y: b * height,\n        }\n        case 'vertical': return {\n            x: b * width, y: a * height,\n        }\n        default: return { x: 0, y: 0 };\n    }\n}\n\nconst divide = (parts, i) => {\n    return 1 / (parts + 1) * (i + 1);\n}\n\nconst uniform = (min, max) => {\n    return Math.random() * (max - min) + min;\n}\n\nconst translate = ({ x: x1, y: y1 }, { x: x2, y: y2 }) => {\n    return { x: x1 + x2, y: y1 + y2 };\n}\n\nconst scatter = (val, dir, opposite = false, mirrored = false) => {\n    if (opposite) dir = { vertical: 'horizontal', horizontal: 'vertical' }[dir];\n    switch (dir) {\n        case 'horizontal': return {\n            x: mirrored ? -val : val, y: 0,\n        }\n        case 'vertical': return {\n            x: 0, y: val,\n        }\n        default: return { x: 0, y: 0 };\n    }\n}\n\nconst opposite = (n, f) => {\n    return f ? 1 - n : n;\n}\n\nconst choose = (...choices) => {\n    choices = choices.map(v => typeof v === 'object' ? v : { value: v });\n    const sum = choices.map(({ weight = 1 }) => weight).reduce((a, b) => a + b);\n    let n = Math.random() * sum;\n    for (const { value, weight = 1 } of choices) {\n        if (weight >= n) return value;\n        else n -= weight;\n    }\n    return choices[choices.length - 1].value;\n}\n\nexport { interp, divide, uniform, scatter, translate, opposite, choose };\n","import { BeanComponent } from '../BeanComponent';\nimport { interp, divide } from '../utils';\n\nclass BalancedAComponent extends BeanComponent {\n    constructor() {\n        super(\n            'BalancedA',\n            {\n                width: { type: 'number' },\n                height: { type: 'number' },\n                i: { type: 'number' },\n                parts: { type: 'number' },\n                dist: { defaultVal: 0.7, min: 0, max: 1, },\n                dir: { defaultVal: 'horizontal', type: 'string', controlType: 'select', options: ['horizontal', 'vertical'] },\n            },\n            {\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                dir: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ width, height, i, parts, dist, dir }) {\n        const { x, y } = interp(width, height, 0.5, (divide(parts, i) - 0.5) * dist + 0.5, dir);\n        yield {\n            x0: x,\n            y0: y,\n            dir,\n            align: 'middle',\n        };\n    }\n}\n\nexport default BalancedAComponent;\n","import { BeanComponent } from '../BeanComponent';\nimport pickRandom from 'pick-random';\n\nclass BalancedBComponent extends BeanComponent {\n    constructor() {\n        super(\n            'BalancedB',\n            {\n                text: { type: 'string' },\n                rows: { defaultVal: 3, min: 2, max: 4, step: 1 },\n                cols: { defaultVal: 4, min: 2, max: 4, step: 1 },\n                dist: { defaultVal: 2, min: 0.5, max: 10 },\n                width: { type: 'number' },\n                height: { type: 'number' },\n                size: { type: 'number' },\n            },\n            {\n                text: { type: 'string' },\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                align: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker ({ text, rows, cols, dist, width, height, size }) {\n        const indices = pickRandom(\n            new Array(cols).fill(0).map(\n                (_, u) => new Array(rows).fill(0).map((_, v) => ({ u, v }))\n            ).reduce((a, b) => [...a, ...b], []),\n            { count: Math.min(rows * cols, text.length) },\n        ).sort(({ u: u1, v: v1 }, { u: u2, v: v2 }) => v2 === v1 ? (u1 - u2) : (v1 - v2));\n\n        for (let i = 0; i < indices.length; ++i) {\n            const { u, v } = indices[i];\n            const x = width / 2 + (u - (cols - 1) / 2) * dist * size;\n            const y = height / 2 + (v - (rows - 1) / 2) * dist * size;\n            yield {\n                text: text[i],\n                x0: x,\n                y0: y,\n                align: 'middle',\n            };\n        }\n    }\n}\n\nexport default BalancedBComponent;\n","import { BeanComponent } from '../BeanComponent';\nimport { interp, opposite, scatter, translate } from '../utils';\n\nclass NeutralComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Neutral',\n            {\n                width: { type: 'number' },\n                height: { type: 'number' },\n                i: { type: 'number' },\n                size: { type: 'number' },\n                lineSpacing: { defaultVal: 1.5, min: 0.5, max: 5, },\n                dir: { defaultVal: 'horizontal', type: 'string', controlType: 'select', options: ['horizontal', 'vertical'] },\n                align: { defaultVal: 'begin', type: 'string', controlType: 'select', options: ['begin', 'end'] },\n                position: { defaultVal: 'left', type: 'string', controlType: 'select', options: ['left', 'right'] },\n                x0: { defaultVal: 0.15, min: 0.1, max: 0.25 },\n                y0: { defaultVal: 0.3, min: 0.1, max: 0.5 },\n            },\n            {\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                dir: { type: 'string' },\n                align: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ width, height, size, lineSpacing, i, dir, align, position, x0, y0 }) {\n        const x = opposite(x0, align === 'end');\n        const y = opposite(y0, position === 'right');\n        let point = interp(width, height, x, y, dir);\n        const delta = scatter(size * lineSpacing * (position === 'left' ? 1 : -1), dir, true);\n        for (; i > 0; --i) point = translate(point, delta);\n        yield {\n            x0: point.x,\n            y0: point.y,\n            dir,\n            align,\n        };\n    }\n}\n\nexport default NeutralComponent;\n","import { BeanComponent } from '../BeanComponent';\nimport { interp, opposite } from '../utils';\n\nclass ActiveAComponent extends BeanComponent {\n    constructor() {\n        super(\n            'ActiveA',\n            {\n                width: { type: 'number' },\n                height: { type: 'number' },\n                i: { type: 'number' },\n                angle: { defaultVal: -0.2, min: -1, max: 1 },\n                dir: { defaultVal: 'horizontal', type: 'string', controlType: 'select', options: ['horizontal', 'vertical'] },\n                x0: { defaultVal: 0.35, min: 0.25, max: 0.5 },\n                y0: { defaultVal: 0.25, min: 0.15, max: 0.4 },\n            },\n            {\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                dir: { type: 'string' },\n                rotate: { type: 'number' },\n                align: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ width, height, i, angle, dir, x0: a, y0: b }) {\n        const rx = opposite(a, i === 1);\n        const ry = opposite(b, i === 1);\n        const { x, y } = interp(width, height, rx, ry, dir);\n        yield {\n            x0: x,\n            y0: y,\n            dir,\n            rotate: angle * Math.PI / 2,\n            align: 'middle',\n        };\n    }\n}\n\nexport default ActiveAComponent;\n","import { BeanComponent } from '../BeanComponent';\nimport inside from 'point-in-polygon';\nimport pickRandom from 'pick-random';\nimport { uniform } from '../utils';\n\nconst distToShape = ({ x: x1, y: y1, r: r1 }, { x: x2, y: y2 }) => {\n    // Chebyshev distance\n    const dist = Math.max(Math.abs(x2 - x1), Math.abs(y2 - y1));\n    return dist - r1;\n}\n\nconst distToLine = ({ x: x1, y: y1 }, { x: x2, y: y2 }, { x, y }) => {\n    // euclidian distance to line\n    const dist = Math.abs((y2 - y1) * x - (x2 - x1) * y + x2 * y1 - y2 * x1)\n        / Math.sqrt(Math.pow(y2 - y1, 2) + Math.pow(x2 - x1, 2));\n    const angle = Math.atan2(y2 - y1, x2 - x1);\n    return Math.abs(dist / Math.sin(angle + Math.PI / 4)) / Math.sqrt(2);\n}\n\nconst dist = (bounds, shapes, point) => {\n    let dist = shapes\n        .map(shape => distToShape(shape, point))\n        .reduce((a, b) => Math.min(a, b), 100000);\n    for (let i = 0; i < bounds.length; ++i) {\n        const p1 = bounds[i], p2 = bounds[(i + 1) % bounds.length];\n        const newDist = distToLine(p1, p2, point);\n        if (newDist < dist) dist = newDist;\n    }\n    return dist;\n}\n\nconst bestCandidate = (bounds, { tries, width, height, maxR, minR = 0 }) => {\n    const shapes = [];\n    const polygon = bounds.map(({ x, y }) => [x, y]);\n    for (let i = 0; i < tries; ++i) {\n        const x = uniform(0, width);\n        const y = uniform(0, height);\n        if (!inside([x, y], polygon)) continue;\n        const d = Math.min(maxR, dist(bounds, shapes, { x, y }));\n        if (d <= minR) continue;\n        shapes.push({ x, y, r: d });\n    }\n    return shapes;\n}\n\nconst sort = (chosen, { debug, angle, scale }) => {\n    const chains = [];\n    chosen = chosen.sort(({ x: x1, y: y1 }, { x: x2, y: y2 }) => (x1 + y1) - (x2 + y2));\n    while (chosen.length > 0) {\n        // characters that is on the leftmost must be beginning of chain\n        const chain = [];\n        chain.push(chosen.splice(0, 1)[0]);\n        while (true) {\n            const { x: x1, y: y1, r: r1 } = chain[chain.length - 1];\n            const candidates = [...chosen]\n                .map((shape, i) => ({ ...shape, i }))\n                .map(({ x: x2, y: y2, r: r2, i }) => ({\n                    x: x2, y: y2, r: r2, i,\n                    s: Math.abs(Math.atan2(-(y2 - y1), x2 - x1)) / angle,\n                    d: (x2 - x1) / r1 / scale,\n                }))\n                .filter(({ s }) => s < 1)\n                .map(({ d, s, ...rest }) => ({\n                    ...rest,\n                    k: s + d,\n                }))\n                .sort(({ k: k1 }, { k: k2 }) => k1 - k2);\n            if (candidates.length === 0) break;\n            chain.push(chosen.splice(candidates[0].i, 1)[0]);\n        }\n        chains.push(chain);\n    }\n    return chains\n        .sort(([{ y: y1 }], [{ y: y2 }]) => y1 - y2)\n        .reduce((a, b) => [...a, ...b], []);\n}\n\n\nclass ActiveBComponent extends BeanComponent {\n    constructor() {\n        super(\n            'ActiveB',\n            {\n                width: { type: 'number' },\n                height: { type: 'number' },\n                text: { type: 'string' },\n                size: { type: 'number' },\n                dimension: { type: 'dimension' },\n                tries: { defaultVal: 10000, min: 100, max: 50000, step: 100 },\n                minR: { defaultVal: 0.78, min: 0, max: 1 },\n                sort: { defaultVal: true },\n                sortAngle: { defaultVal: 0.2, min: 0, max: 0.5 },\n                sortScale: { defaultVal: 3.0, min: 0, max: 10 },\n            },\n            {\n                i: { type: 'number' },\n                text: { type: 'string' },\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                size: { type: 'number' },\n                align: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ width, height, text, tries, size, minR, sort: shouldSort, sortAngle, sortScale, dimension }) {\n        text = text.split(/\\s+/).join('');\n        const bounds = [\n            { x: width * dimension.x0, y: height * dimension.y0 },\n            { x: width * dimension.x1, y: height * dimension.y0 },\n            { x: width * dimension.x1, y: height * dimension.y1 },\n            { x: width * dimension.x0, y: height * dimension.y1 },\n        ];\n        const shapes = bestCandidate(bounds, {\n            tries,\n            width,\n            height,\n            maxR: size,\n            minR: size * minR,\n        });\n\n        // applySeed();\n        const chosen = pickRandom(shapes, { count: Math.min(shapes.length, text.length) });\n        const sorted = shouldSort\n            ? sort(chosen, { angle: sortAngle * Math.PI, scale: sortScale })\n            : chosen;\n        for (let i = 0; i < sorted.length; ++i) {\n            const { x, y, r } = sorted[i];\n            yield {\n                i,\n                text: text[i],\n                x0: x,\n                y0: y,\n                size: r * 2,\n                align: 'middle',\n            };\n        }\n    }\n}\n\nexport default ActiveBComponent;\n","import SplitComponent from './SplitComponent';\nimport BalancedAComponent from './BalancedAComponent';\nimport BalancedBComponent from './BalancedBComponent';\nimport NeutralComponent from './NeutralComponent';\nimport ActiveAComponent from './ActiveAComponent';\nimport ActiveBComponent from './ActiveBComponent';\n\nexport default [\n    SplitComponent,\n    BalancedAComponent,\n    BalancedBComponent,\n    NeutralComponent,\n    ActiveAComponent,\n    ActiveBComponent,\n];\n","import { BeanComponent } from '../BeanComponent';\n\nclass UniformComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Uniform',\n            {\n                min: { defaultVal: -0.5, min: -1, max: 1 },\n                max: { defaultVal: 0.5, min: -1, max: 1 },\n            },\n            {\n                val: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ min, max }) {\n        yield {\n            val: min + Math.random() * (max - min),\n        };\n    }\n}\n\nexport default UniformComponent;\n","import { BeanComponent } from '../BeanComponent';\n\nclass StepComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Step',\n            {\n                i: { defaultVal: 0 },\n                start: { defaultVal: 0, min: -1, max: 1 },\n                step: { defaultVal: 0.1, min: -1, max: 1 },\n            },\n            {\n                val: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ i, start, step }) {\n        yield {\n            val: start + i * step,\n        };\n    }\n}\n\nexport default StepComponent;\n","import { BeanComponent } from '../BeanComponent';\n\nclass ScatterComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Scatter',\n            {\n                cond: { type: 'number' },\n                thres: { type: 'number' },\n                val: { type: 'number' },\n            },\n            {\n                lt: { type: 'number' },\n                gt: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ cond, thres, val }) {\n        if (cond <= thres) {\n            yield { lt: val };\n        } else {\n            yield { gt: val };\n        }\n    }\n}\n\nclass GatherComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Gather',\n            {\n                cond: { type: 'number' },\n                thres: { type: 'number' },\n                lt: { defaultVal: 0 },\n                gt: { defaultVal: 0 },\n            },\n            {\n                val: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ cond, thres, lt, gt }) {\n        if (cond <= thres) {\n            yield { val: lt };\n        } else {\n            yield { val: gt };\n        }\n    }\n}\n\nclass Gather10Component extends BeanComponent {\n    constructor() {\n        super(\n            'Gather10',\n            {\n                ind: { defaultVal: 0, min: 0, max: 9 },\n                n0: { defaultVal: 0 },\n                n1: { defaultVal: 0 },\n                n2: { defaultVal: 0 },\n                n3: { defaultVal: 0 },\n                n4: { defaultVal: 0 },\n                n5: { defaultVal: 0 },\n                n6: { defaultVal: 0 },\n                n7: { defaultVal: 0 },\n                n8: { defaultVal: 0 },\n                n9: { defaultVal: 0 },\n            },\n            {\n                val: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ ind, n0, n1, n2, n3, n4, n5, n6, n7, n8, n9 }) {\n        const vals = [n0, n1, n2, n3, n4, n5, n6, n7, n8, n9];\n        yield { val: vals[ind] };\n    }\n}\n\nexport default [\n    ScatterComponent,\n    GatherComponent,\n    Gather10Component,\n];\n","import UniformComponent from './UniformComponent';\nimport StepComponent from './StepComponent';\nimport conditional from './conditional';\n\nexport default [\n    UniformComponent,\n    StepComponent,\n    ...conditional,\n];\n","// lifecycle\nimport InitiatorComponent from './InitiatorComponent';\n\nimport io from './io';\nimport common from './common';\nimport render from './render';\nimport generation from './generation';\nimport calculation from './calculation';\n\nexport default [\n    InitiatorComponent,\n    ...io,\n    ...common,\n    ...render,\n    ...generation,\n    ...calculation,\n];\n","import React, { useCallback, useEffect, useState, useMemo, useRef } from 'react';\nimport { makeStyles, Button, Grid } from '@material-ui/core';\nimport Rete from 'rete';\nimport ConnectionPlugin from 'rete-connection-plugin';\nimport ReactRenderPlugin from 'rete-react-render-plugin';\nimport ContextMenuPlugin from 'rete-context-menu-plugin';\nimport { saveAs } from 'file-saver';\nimport ReactFileReader from 'react-file-reader';\nimport { readAsText } from 'promise-file-reader';\nimport MyNode from './MyNode';\nimport components from \"../components\";\n\nconst useStyles = makeStyles({\n    buttons: {\n        position: 'absolute',\n        right: 16,\n        bottom: 16,\n    },\n});\n\nfunction NodeMap({ setStep, defaults, onUpdate, name, next, prev }) {\n    const classes = useStyles();\n    const nextStep = useCallback(() => {\n        setStep(next);\n    }, [setStep, next]);\n    const prevStep = useCallback(() => {\n        setStep(prev);\n    }, [setStep, prev]);\n    const [root, setRoot] = useState(null);\n    const editor = useMemo(() => {\n        if (!root) return null;\n        return new Rete.NodeEditor('dcdc@0.1.0', root);\n    }, [root]);\n    const onUpdateRef = useRef(onUpdate);\n    useEffect(() => {\n        onUpdateRef.current = onUpdate;\n    }, [onUpdate]);\n    useEffect(() => {\n        if (!editor) return;\n        (async () => {\n            editor.use(ConnectionPlugin);\n            editor.use(ReactRenderPlugin, { component: MyNode });\n            editor.use(ContextMenuPlugin);\n            components.forEach(component => editor.register(new component()));\n\n            if (defaults) await editor.fromJSON(defaults);\n\n            editor.on('process nodecreated noderemoved connectioncreated connectionremoved', async () => {\n                (onUpdateRef.current)(await editor.toJSON());\n            });\n        })();\n    }, [editor, defaults]);\n    const download = useCallback(async () => {\n        if (!editor) return;\n        const data = await editor.toJSON();\n        const text = JSON.stringify(data);\n        const blob = new Blob([text], { type: 'application/json' });\n        saveAs(blob, `${name}.json`);\n    }, [editor, name]);\n    const upload = useCallback(async (files) => {\n        if (!editor) return;\n        const file = files[0];\n        const text = await readAsText(file);\n        const data = JSON.parse(text);\n        await editor.fromJSON(data);\n    }, [editor]);\n\n    return <>\n        <div ref={setRoot} style={{\n            position: 'absolute',\n            left: 0,\n            top: 0,\n            width: '100vw',\n            height: '100vh',\n        }} />\n        <Grid container spacing={2} classes={{ root: classes.buttons }} justify=\"flex-end\">\n            <Grid item>\n                <ReactFileReader\n                    fileTypes={[\".json\"]}\n                    handleFiles={upload}>\n                    <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        disableElevation\n                        component=\"span\"\n                    >\n                        上传\n                    </Button>\n                </ReactFileReader>\n            </Grid>\n            <Grid item>\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disableElevation\n                    onClick={download}\n                >\n                    下载\n                </Button>\n            </Grid>\n            <Grid item>\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disableElevation\n                    onClick={prevStep}\n                >\n                    上一步\n                </Button>\n            </Grid>\n            <Grid item>\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disableElevation\n                    onClick={nextStep}\n                >\n                    下一步\n                </Button>\n            </Grid>\n        </Grid>\n    </>\n}\n\nexport default NodeMap;\n","const config = [\n    {\n        name: 'Color set',\n        type: 'folder',\n        children: [\n            { name: 'Text color', type: 'color', path: 'textColor' },\n            { name: 'Background color', type: 'color', path: 'backgroundColor' },\n        ],\n    },\n    {\n        name: 'Type',\n        type: 'folder',\n        children: [\n            { name: 'Font family', type: 'string', path: 'fontFamily' },\n            { name: 'Font weight', type: 'number', path: 'fontWeight', min: 100, max: 900, step: 100 },\n            { name: 'Font size', type: 'number', path: 'size' },\n            { name: 'Letter spacing', type: 'number', path: 'letterSpacing' },\n            { name: 'Maximum split', type: 'number', path: 'splitMax' },\n            { name: 'Size randomness', type: 'number', path: 'sizeRandom' },\n            { name: 'Rotate randomness', type: 'number', path: 'rotateRandom' },\n        ],\n    },\n    {\n        name: 'Layout',\n        type: 'folder',\n        children: [\n            {\n                name: 'Type A',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.a.enabled' },\n                    { name: 'Minimum distance', type: 'number', path: 'modes.a.minDist', step: 0.01 },\n                    { name: 'Maximum distance', type: 'number', path: 'modes.a.maxDist', step: 0.01 },\n                ],\n            },\n            {\n                name: 'Type B',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.b.enabled' },\n                    { name: 'Line spacing', type: 'number', path: 'modes.b.lineSpacing', step: 0.01 },\n                ],\n            },\n            {\n                name: 'Type C',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.c.enabled' },\n                    { name: 'Minimum angle', type: 'number', path: 'modes.c.minAngle', step: 0.01 },\n                    { name: 'Maximum angle', type: 'number', path: 'modes.c.maxAngle', step: 0.01 },\n                ],\n            },\n            {\n                name: 'Type D',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.d.enabled' },\n                    { name: 'Minimum distance', type: 'number', path: 'modes.d.minDist', step: 0.01 },\n                    { name: 'Maximum distance', type: 'number', path: 'modes.d.maxDist', step: 0.01 },\n                ],\n            },\n            {\n                name: 'Type E',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.e.enabled' },\n                    { name: 'Minimum radius', type: 'number', path: 'modes.e.minR', min: 0, max: 1, step: 0.01 },\n                    { name: 'Scale', type: 'number', path: 'modes.e.scale', step: 0.01 },\n                ],\n            },\n        ],\n    },\n    {\n        name: 'Pattern',\n        type: 'folder',\n        children: [\n            { name: 'Shape', type: 'string', path: 'pattern.shape' },\n            { name: 'Graphic color', type: 'color', path: 'pattern.color' },\n            { name: 'Center', type: 'boolean', path: 'pattern.center.enabled' },\n            { name: 'Follow', type: 'boolean', path: 'pattern.follow.enabled' },\n            { name: 'Random', type: 'boolean', path: 'pattern.random.enabled' },\n        ],\n    }\n];\n\nexport default config;\n","import * as _ from 'lodash';\n\nclass Engine {\n    constructor(id) {\n        this.id = id;\n        this.components = {};\n    }\n\n    register(component) {\n        this.components[component.name] = component;\n    }\n\n    async abort() {\n        // TODO: implement this\n    }\n\n    async process({ nodes }, data) {\n        const graph = { inputNodes: {}, inputs: {} };\n        for (const [, { id, inputs: nodeInputs }] of _.toPairs(nodes)) {\n            graph.inputNodes[id] = [];\n            graph.inputs[id] = {};\n            const { inputNodes: { [id]: inputNodes }, inputs: { [id]: inputs } } = graph;\n            for (const [dkey, { connections }] of _.toPairs(nodeInputs)) {\n                if (connections.length === 0) continue;\n                const [{ node: nid, output: skey }] = connections;\n                if (!inputNodes.includes(nid)) inputNodes.push(nid);\n                inputs[dkey] = { id: nid, key: skey };\n            }\n        }\n        try {\n            const queue = [];\n            queue.push({\n                values: {},\n                processed: [],\n                unprocessed: _.toPairs(nodes).map(([_, { id }]) => id),\n            });\n            while (queue.length !== 0) {\n                const [ctx] = queue.splice(0, 1);\n                const it = this.run(nodes, graph, ctx, data);\n                for await (const newCtx of it) queue.push(newCtx);\n            }\n        } catch (e) {\n            // circular dependency\n            console.log(e);\n        }\n    }\n\n    findNode(nodes, id) {\n        return _\n            .toPairs(nodes)\n            .map(([_, node]) => node)\n            .find(({ id: nodeId }) => nodeId === id);\n    }\n\n    async * run(nodes, graph, { processed, unprocessed, values }, data) {\n        const { inputNodes, inputs } = graph;\n        // find reachable node\n        const nid = unprocessed.find(id => inputNodes[id].every(iid => iid in values));\n        if (nid === undefined) throw new Error('no reachable node');\n        // collect inputs\n        const node = this.findNode(nodes, nid);\n        if (!node) throw new Error('unable to find node');\n        const { name, data: nodeData } = node;\n        const inputVals = _.clone(nodeData);\n        for (const [dkey, { id: sid, key: skey }] of _.toPairs(inputs[nid])) {\n            inputVals[dkey] = values[sid][skey];\n        }\n        // get outputs\n        const component = this.components[name];\n        const it = component.worker.call(component, inputVals, node, data);\n        for await (const outputVals of it) {\n            yield {\n                processed: [...processed, nid],\n                unprocessed: unprocessed.filter(id => id !== nid),\n                values: { ...values, [nid]: outputVals },\n            };\n        }\n    }\n}\n\nexport default Engine;\n","import Engine from './engine';\nimport components from \"../components\";\n\nexport default async (graph, inputs) => {\n    const engine = new Engine('dcdc@0.1.0');\n    for (const Component of components) {\n        engine.register(new Component());\n    }\n    const ctx = {\n        inputs,\n        outputs: {},\n    };\n    await engine.process(graph, ctx);\n    return ctx.outputs;\n};\n","/* eslint-disable default-case, no-fallthrough */\n\nimport * as _ from 'lodash';\nimport pickRandom from 'pick-random';\nimport random from 'random';\nimport seedrandom from 'seedrandom';\nimport Color from 'color';\nimport inside from 'point-in-polygon';\nimport BezierEasing from 'bezier-easing';\n\nimport { interp, divide, opposite, scatter, translate } from '../components/utils';\n\nconst textWidth = (text, sizes, spacing) => {\n    // VERY SIMPLE\n    // return size * text.length + spacing * size * (text.length - 1);\n    let width = 0;\n    for (let i = 0; i < text.length; ++i) {\n        width += sizes[i] * (1 + spacing);\n    }\n    width -= sizes[0] * spacing / 2;\n    width -= sizes[text.length - 1] * spacing / 2;\n    return width;\n}\n\nfunction* font({\n    text, x0, y0,\n    size, dir, align,\n    spacing, ignoreWhitespaces,\n    alignBaseline,\n    // pattern\n    patternType, ctx, currentTime, start, end, params,\n}) {\n    if (ignoreWhitespaces) text = text.split(/\\s+/).join('');\n    let x = x0, y = y0;\n    const sizes = new Array(text.length).fill(size);\n    const width = textWidth(text, sizes, spacing);\n    if (align === 'middle') {\n        switch (dir) {\n            case 'horizontal':\n                x -= width / 2;\n                break;\n            case 'vertical':\n                y -= width / 2;\n                break;\n        }\n    }\n    if (align === 'end') {\n        switch (dir) {\n            case 'horizontal':\n                x -= width;\n                break;\n            case 'vertical':\n                y -= width;\n                break;\n        }\n    }\n    switch (dir) {\n        case 'horizontal':\n            x += sizes[0] / 2;\n            break;\n        case 'vertical':\n            y += sizes[0] / 2;\n            break;\n    }\n\n    if (patternType === 'follow') {\n        const x0 = x, y0 = y;\n        const x1 = x + (dir === 'horizontal' ? width : 0);\n        const y1 = y + (dir === 'vertical' ? width : 0);\n        const t = random.float(0, 1);\n        pattern({\n            ctx, currentTime, start, end, params,\n            x0: x0 * (1 - t) + x1 * t,\n            y0: y0 * (1 - t) + y1 * t,\n            size: params.size * 1.5,\n        });\n    }\n\n    for (let i = 0; i < text.length; ++i) {\n        const ch = text[i];\n        const bx = x;\n        const by = alignBaseline && dir === 'horizontal' ? y - (sizes[i] - size) / 2 : y;\n        yield {\n            i,\n            ch,\n            x0: bx,\n            y0: by,\n            size: sizes[i],\n        };\n        switch (dir) {\n            case 'horizontal':\n                x += (sizes[i] + sizes[i + 1]) * (1 + spacing) / 2;\n                break;\n            case 'vertical':\n                y += (sizes[i] + sizes[i + 1]) * (1 + spacing) / 2;\n                break;\n        }\n    }\n}\n\nfunction char({\n    ctx, ch, x0, y0,\n    size, rotate, color,\n    fontFamily, fontWeight,\n}) {\n    ctx.textBaseline = 'middle';\n    ctx.textAlign = 'center';\n    ctx.fillStyle = color;\n    ctx.font = `${fontWeight} ${size}px '${fontFamily}'`;\n    ctx.save();\n    ctx.translate(x0, y0);\n    ctx.rotate(rotate * Math.PI);\n    ctx.fillText(ch, 0, 0);\n    ctx.restore();\n}\n\nfunction* split({ text, parts, randomness }) {\n    const step = text.length / parts;\n    const deltas = [0, ...new Array(parts - 1).fill(0).map(() => (Math.random() - 0.5) * 2 * randomness), 0];\n    for (let i = 0; i < parts; ++i) {\n        const begin = Math.round(i * step + deltas[i]);\n        const end = Math.round((i + 1) * step + deltas[i + 1]);\n        yield {\n            parts,\n            i,\n            text: text.substring(begin, end),\n        };\n    }\n}\n\nfunction* balancedA({ width, height, i, parts, dist, dir }) {\n    const { x, y } = interp(width, height, 0.5, (divide(parts, i) - 0.5) * dist + 0.5, dir);\n    yield {\n        x0: x,\n        y0: y,\n        dir,\n        align: 'middle',\n    };\n}\n\nfunction* balancedB({ text, rows, cols, dist, width, height, size }) {\n    const indices = pickRandom(\n        new Array(cols).fill(0).map(\n            (_, u) => new Array(rows).fill(0).map((_, v) => ({ u, v }))\n        ).reduce((a, b) => [...a, ...b], []),\n        { count: Math.min(rows * cols, text.length) },\n    ).sort(({ u: u1, v: v1 }, { u: u2, v: v2 }) => v2 === v1 ? (u1 - u2) : (v1 - v2));\n\n    for (let i = 0; i < indices.length; ++i) {\n        const { u, v } = indices[i];\n        const x = width / 2 + (u - (cols - 1) / 2) * dist * size;\n        const y = height / 2 + (v - (rows - 1) / 2) * dist * size;\n        yield {\n            text: text[i],\n            x0: x,\n            y0: y,\n            align: 'middle',\n        };\n    }\n}\n\nfunction* neutral({ width, height, size, lineSpacing, i, dir, align, position, x0, y0 }) {\n    const x = opposite(x0, align === 'end');\n    const y = opposite(y0, position === 'right');\n    let point = interp(width, height, x, y, dir);\n    const delta = scatter(size * lineSpacing * (position === 'left' ? 1 : -1), dir, true);\n    for (; i > 0; --i) point = translate(point, delta);\n    yield {\n        x0: point.x,\n        y0: point.y,\n        dir,\n        align,\n    };\n}\n\nfunction* activeA({ width, height, i, angle, dir, x0: a, y0: b }) {\n    const rx = opposite(a, i === 1);\n    const ry = opposite(b, i === 1);\n    const { x, y } = interp(width, height, rx, ry, dir);\n    yield {\n        x0: x,\n        y0: y,\n        dir,\n        rotate: angle * Math.PI / 2,\n        align: 'middle',\n    };\n}\n\nconst distToShape = ({ x: x1, y: y1, r: r1 }, { x: x2, y: y2 }) => {\n    // Chebyshev distance\n    const dist = Math.max(Math.abs(x2 - x1), Math.abs(y2 - y1));\n    return dist - r1;\n}\n\nconst distToLine = ({ x: x1, y: y1 }, { x: x2, y: y2 }, { x, y }) => {\n    // euclidian distance to line\n    const dist = Math.abs((y2 - y1) * x - (x2 - x1) * y + x2 * y1 - y2 * x1)\n        / Math.sqrt(Math.pow(y2 - y1, 2) + Math.pow(x2 - x1, 2));\n    const angle = Math.atan2(y2 - y1, x2 - x1);\n    return Math.abs(dist / Math.sin(angle + Math.PI / 4)) / Math.sqrt(2);\n}\n\nconst dist = (bounds, shapes, point) => {\n    let dist = shapes\n        .map(shape => distToShape(shape, point))\n        .reduce((a, b) => Math.min(a, b), 100000);\n    for (let i = 0; i < bounds.length; ++i) {\n        const p1 = bounds[i], p2 = bounds[(i + 1) % bounds.length];\n        const newDist = distToLine(p1, p2, point);\n        if (newDist < dist) dist = newDist;\n    }\n    return dist;\n}\n\nconst bestCandidate = (bounds, { tries, width, height, maxR, minR = 0 }) => {\n    const shapes = [];\n    const polygon = bounds.map(({ x, y }) => [x, y]);\n    for (let i = 0; i < tries; ++i) {\n        const x = random.float(0, width);\n        const y = random.float(0, height);\n        if (!inside([x, y], polygon)) continue;\n        const d = Math.min(maxR, dist(bounds, shapes, { x, y }));\n        if (d <= minR) continue;\n        shapes.push({ x, y, r: d });\n    }\n    return shapes;\n}\n\nconst sort = (chosen, { debug, angle, scale }) => {\n    const chains = [];\n    chosen = chosen.sort(({ x: x1, y: y1 }, { x: x2, y: y2 }) => (x1 + y1) - (x2 + y2));\n    while (chosen.length > 0) {\n        // characters that is on the leftmost must be beginning of chain\n        const chain = [];\n        chain.push(chosen.splice(0, 1)[0]);\n        while (true) {\n            const { x: x1, y: y1, r: r1 } = chain[chain.length - 1];\n            const candidates = [...chosen]\n                .map((shape, i) => ({ ...shape, i }))\n                .map(({ x: x2, y: y2, r: r2, i }) => ({\n                    x: x2, y: y2, r: r2, i,\n                    s: Math.abs(Math.atan2(-(y2 - y1), x2 - x1)) / angle,\n                    d: (x2 - x1) / r1 / scale,\n                }))\n                .filter(({ s }) => s < 1)\n                .map(({ d, s, ...rest }) => ({\n                    ...rest,\n                    k: s + d,\n                }))\n                .sort(({ k: k1 }, { k: k2 }) => k1 - k2);\n            if (candidates.length === 0) break;\n            chain.push(chosen.splice(candidates[0].i, 1)[0]);\n        }\n        chains.push(chain);\n    }\n    return chains\n        .sort(([{ y: y1 }], [{ y: y2 }]) => y1 - y2)\n        .reduce((a, b) => [...a, ...b], []);\n}\n\nfunction* activeB({ width, height, text, tries, size, minR, sort: shouldSort, sortAngle, sortScale, dimension }) {\n    text = text.split(/\\s+/).join('');\n    const bounds = [\n        { x: width * dimension.x0, y: height * dimension.y0 },\n        { x: width * dimension.x1, y: height * dimension.y0 },\n        { x: width * dimension.x1, y: height * dimension.y1 },\n        { x: width * dimension.x0, y: height * dimension.y1 },\n    ];\n    const shapes = bestCandidate(bounds, {\n        tries,\n        width,\n        height,\n        maxR: size,\n        minR: size * minR,\n    });\n\n    // applySeed();\n    const chosen = pickRandom(shapes, { count: Math.min(shapes.length, text.length) });\n    const sorted = shouldSort\n        ? sort(chosen, { angle: sortAngle * Math.PI, scale: sortScale })\n        : chosen;\n    for (let i = 0; i < sorted.length; ++i) {\n        const { x, y, r } = sorted[i];\n        yield {\n            i,\n            text: text[i],\n            x0: x,\n            y0: y,\n            size: r * 2,\n            align: 'middle',\n        };\n    }\n}\n\nfunction pattern({\n    ctx, x0, y0, currentTime, start, end, duration = 0.5, params, size,\n}) {\n    const rotation = currentTime * 1;\n    const easing1 = BezierEasing(0.22, 1, 0.36, 1);\n    const easing2 = BezierEasing(0.64, 0, 0.78, 0);\n    let t = 0;\n    if (currentTime < start) t = 0;\n    else if (currentTime < start + duration) t = easing1((currentTime - start) / duration);\n    else if (currentTime < end - duration) t = 1;\n    else if (currentTime < end) t = 1 - easing2(1 - (end - currentTime) / duration);\n    else t = 0;\n    ctx.save();\n    ctx.fillStyle = params.pattern.color;\n    ctx.translate(x0, y0);\n    const scale = t * size / 2;\n    ctx.scale(scale, scale);\n    const shape = params.pattern.shape;\n    if (shape !== 'line') ctx.rotate(rotation);\n    switch (params.pattern.shape) {\n        case 'square': case 'triangle': case 'pentagon': {\n            const sides = { square: 4, triangle: 3, pentagon: 5 }[params.pattern.shape];\n            ctx.beginPath();\n            ctx.moveTo(1, 0);\n            for (let i = 0; i < sides; ++i) {\n                const angle = Math.PI * 2 / sides * (i + 1);\n                ctx.lineTo(Math.cos(angle), Math.sin(angle));\n            }\n            ctx.fill();\n            break;\n        }\n        case 'circle': {\n            ctx.beginPath();\n            ctx.arc(0, 0, 1, 0, Math.PI * 2);\n            ctx.fill();\n            break;\n        }\n        case 'line': {\n            ctx.beginPath();\n            ctx.moveTo(+1.5, -0.2);\n            ctx.lineTo(+1.5, +0.2);\n            ctx.lineTo(-1.5, +0.2);\n            ctx.lineTo(-1.5, -0.2);\n            ctx.fill();\n            break;\n        }\n    }\n    ctx.restore();\n}\n\nfunction char2({\n    start, end, lyric, currentTime, duration = 0.5,\n    chi, ctx, ch, x0, y0, rotate, size, params, outEffect, inEffect,\n}) {\n    const inEndTime = chi * (end - duration - start) / lyric.length + start;\n    const inStartTime = inEndTime - duration;\n    const outStartTime = end - duration;\n    const outEndTime = outStartTime + duration;\n    if (currentTime < inStartTime) { }\n    else if (currentTime < inEndTime) {\n        const t = (currentTime - inStartTime) / (inEndTime - inStartTime);\n        switch (inEffect) {\n            case 'fade': {\n                const opacity = t;\n                char({\n                    ctx, ch, x0, y0,\n                    size,\n                    rotate,\n                    color: Color(params.textColor).alpha(opacity).string(),\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'blink': {\n                const thres = 0.2;\n                const opacity = t < thres ? 1 : (t - thres) / (1 - thres);\n                char({\n                    ctx, ch, x0, y0,\n                    size,\n                    rotate,\n                    color: Color(params.textColor).alpha(opacity).string(),\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'zoom': {\n                const easing = BezierEasing(0.22, 1, 0.36, 1);\n                char({\n                    ctx, ch, x0, y0,\n                    size: size * easing(t),\n                    rotate,\n                    color: params.textColor,\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'slide': {\n                const easing = BezierEasing(0.22, 1, 0.36, 1);\n                const k = 1 - easing(t);\n                const dx = 0, dy = -1;\n                char({\n                    ctx, ch, x0: x0 + dx * size * k, y0: y0 + dy * size * k,\n                    size,\n                    rotate,\n                    color: params.textColor,\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n        }\n    } else if (currentTime < outStartTime) {\n        char({\n            ctx, ch, x0, y0,\n            size,\n            rotate,\n            color: params.textColor,\n            fontFamily: params.fontFamily,\n            fontWeight: params.fontWeight,\n        });\n    } else if (currentTime < outEndTime) {\n        const t = (currentTime - outStartTime) / (outEndTime - outStartTime);\n        switch (outEffect) {\n            case 'fade': {\n                const opacity = 1 - t;\n                char({\n                    ctx, ch, x0, y0,\n                    size,\n                    rotate,\n                    color: Color(params.textColor).alpha(opacity).string(),\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'blink': {\n                const thres = 0.2;\n                const opacity = 1 - (t < thres ? 1 : (t - thres) / (1 - thres));\n                char({\n                    ctx, ch, x0, y0,\n                    size,\n                    rotate,\n                    color: Color(params.textColor).alpha(opacity).string(),\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'zoom': {\n                const easing = BezierEasing(0.64, 0, 0.78, 0);\n                char({\n                    ctx, ch, x0, y0,\n                    size: size * (1 - easing(t)),\n                    rotate,\n                    color: params.textColor,\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n        }\n    } else { }\n}\n\nrandom.patch();\n\nconst render = ({ width, height, seed, ctx, params, lyric, start, end, currentTime }) => {\n    if (lyric.length === 0) return;\n\n    const rng = seedrandom(`${seed}`);\n    random.use(rng);\n\n    const modes = _\n        .keys(params.modes)\n        .filter(key => params.modes[key].enabled);\n    if (modes.length === 0) return;\n    const mode = pickRandom(modes)[0];\n\n    const inEffect = pickRandom(['fade', 'blink', 'zoom', 'slide'])[0];\n    const outEffect = pickRandom(['fade', 'blink', 'zoom'])[0];\n\n    const patternType = pickRandom(['center', 'follow', 'random'].filter(type => params.pattern[type].enabled))[0];\n    switch (patternType) {\n        case 'center': {\n            pattern({\n                ctx, currentTime, start, end, params,\n                x0: width / 2, y0: height / 2,\n                size: params.size * 2,\n            });\n            break;\n        }\n        case 'follow': {\n            if (['a', 'b', 'c'].indexOf(mode) !== -1) break;\n            // intended fall through\n        }\n        case 'random': {\n            const num = random.int(7, 16);\n            for (let i = 0; i < num; ++i) {\n                const x0 = random.float(0, 1) * width;\n                const y0 = random.float(0, 1) * height;\n                const size = random.float(0.4, 1.0) * params.size;\n                pattern({\n                    ctx, x0, y0, currentTime, start, end, params, size,\n                });\n            }\n            break;\n        }\n    }\n\n    switch (mode) {\n        case 'a': {\n            const parts = Math.max(random.int(1, params.splitMax), Math.ceil(lyric.length / 12));\n            const dir = pickRandom(['horizontal', 'vertical'])[0];\n            const it = split({\n                text: lyric,\n                parts,\n                randomness: 0,\n            });\n            let chi = 0;\n            for (const { i, text } of it) {\n                const it = balancedA({\n                    width, height, i, parts,\n                    dist: random.float(params.modes.a.minDist, params.modes.a.maxDist),\n                    dir,\n                });\n                for (const { x0, y0, dir, align } of it) {\n                    const it = font({\n                        text, x0, y0,\n                        size: params.size,\n                        dir, align,\n                        spacing: params.letterSpacing,\n                        ignoreWhitespaces: true,\n                        alignBaseline: false,\n\n                        ctx, patternType, currentTime, start, end, params,\n                    });\n                    for (const { ch, x0, y0, size } of it) {\n                        char2({\n                            start, end, lyric, currentTime, chi, ctx, ch, x0, y0,\n                            rotate: 0, size, params, inEffect, outEffect,\n                        });\n                        ++chi;\n                    }\n                }\n            }\n            break;\n        }\n        case 'b': {\n            const parts = Math.max(random.int(1, params.splitMax), Math.ceil(lyric.length / 12));\n            const dir = pickRandom(['horizontal', 'vertical'])[0];\n            const align = pickRandom(['begin', 'end'])[0];\n            const position = pickRandom(['left', 'right'])[0];\n            const it = split({\n                text: lyric,\n                parts,\n                randomness: 0,\n            });\n            let chi = 0;\n            for (const { i, text } of it) {\n                const it = neutral({\n                    width, height,\n                    size: params.size,\n                    lineSpacing: params.modes.b.lineSpacing,\n                    i, dir, align, position,\n                    x0: 0.2, y0: 0.25,\n                });\n                for (const { x0, y0, dir, align } of it) {\n                    const it = font({\n                        text, x0, y0,\n                        size: params.size,\n                        dir, align,\n                        spacing: params.letterSpacing,\n                        ignoreWhitespaces: true,\n                        alignBaseline: false,\n\n                        ctx, patternType, currentTime, start, end, params,\n                    });\n                    for (const { ch, x0, y0, size } of it) {\n                        char2({\n                            start, end, lyric, currentTime, chi, ctx, ch, x0, y0,\n                            rotate: 0, size, params, inEffect, outEffect,\n                        });\n                        ++chi;\n                    }\n                }\n            }\n            break;\n        }\n        case 'c': {\n            const parts = 2;\n            const dir = pickRandom(['horizontal', 'vertical'])[0];\n            const angle = random.float(params.modes.c.minAngle, params.modes.c.maxAngle);\n            const it = split({\n                text: lyric,\n                parts,\n                randomness: 0,\n            });\n            let chi = 0;\n            for (const { i, text } of it) {\n                const it = activeA({\n                    width, height, i, dir, angle,\n                    x0: 0.2, y0: 0.25,\n                });\n                for (const { x0, y0, dir, align, rotate } of it) {\n                    const it = font({\n                        text, x0, y0,\n                        size: params.size,\n                        dir, align,\n                        spacing: params.letterSpacing,\n                        ignoreWhitespaces: true,\n                        alignBaseline: false,\n\n                        ctx, patternType, currentTime, start, end, params,\n                    });\n                    for (const { ch, x0, y0, size } of it) {\n                        char2({\n                            start, end, lyric, currentTime, chi, ctx, ch, x0, y0,\n                            rotate, size, params, inEffect, outEffect,\n                        });\n                        ++chi;\n                    }\n                }\n            }\n            break;\n        }\n        case 'd': {\n            let chi = 0;\n            let rows, cols;\n            do {\n                if (lyric.length > 20) {\n                    rows = 4;\n                    cols = 5;\n                } else {\n                    rows = random.int(2, 4);\n                    cols = random.int(2, 5);\n                }\n            } while (!(lyric.length > 20 || rows * cols >= lyric.length));\n            const it = balancedB({\n                text: lyric, rows, cols,\n                dist: random.float(params.modes.d.minDist, params.modes.d.maxDist),\n                width, height, size: params.size,\n            });\n            for (const { text, x0, y0, align } of it) {\n                const it = font({\n                    text, x0, y0,\n                    size: params.size,\n                    dir: 'horizontal', align,\n                    spacing: 0,\n                    ignoreWhitespaces: true,\n                    alignBaseline: false,\n                });\n                for (const { ch, x0, y0, size } of it) {\n                    char2({\n                        start, end, lyric, currentTime, chi, ctx, ch, x0, y0,\n                        rotate: 0, size, params, inEffect, outEffect,\n                    });\n                    ++chi;\n                }\n            }\n            break;\n        }\n        case 'e': {\n            const it = activeB({\n                text: lyric, width, height,\n                tries: 5000, size: params.size,\n                minR: params.modes.e.minR,\n                sort: true, sortAngle: 0.2, sortScale: 3.0,\n                dimension: { x0: 0.2, x1: 0.8, y0: 0.15, y1: 0.85 },\n            });\n            for (const { i, text, x0, y0, size, align } of it) {\n                const it = font({\n                    text, x0, y0, size: size * params.modes.e.scale,\n                    dir: 'horizontal', align,\n                    spacing: 0,\n                    ignoreWhitespaces: true,\n                    alignBaseline: false,\n                });\n                for (const { ch, x0, y0, size } of it) {\n                    char2({\n                        start, end, lyric, currentTime, chi: i, ctx, ch, x0, y0,\n                        rotate: 0, size, params, inEffect, outEffect,\n                    });\n                }\n            }\n            break;\n        }\n    }\n}\n\nexport default render;","import { makeStyles, Grid, Typography, Button, Slider } from '@material-ui/core';\nimport React, { useEffect, useMemo, useState, useCallback } from 'react';\nimport DatGui, { DatFolder, DatString, DatNumber, DatBoolean, DatColor } from 'react-dat-gui';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport grey from '@material-ui/core/colors/grey';\nimport { Lrc } from 'lrc-kit';\nimport * as _ from 'lodash';\n\nimport config from './params';\nimport Length from './Length';\nimport exec from '../retex/exec';\nimport render from './render';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n    },\n    side: {\n        position: 'absolute',\n        top: 0,\n        right: 0,\n        padding: 4,\n        width: 345,\n        height: '100%',\n        overflow: 'auto',\n        boxSizing: 'border-box',\n    },\n    canvasContainer: {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: 'calc(100vw - 345px)',\n        height: 'calc(100vh - 195px)',\n        backgroundColor: '#222',\n        overflow: 'hidden',\n    },\n    canvas: {\n        position: 'absolute',\n        top: '50%',\n        left: '50%',\n    },\n    bottom: {\n        position: 'absolute',\n        left: 0,\n        bottom: 0,\n        height: 195,\n        width: 'calc(100vw - 345px)',\n        padding: '20px 30px 40px 30px',\n        boxSizing: 'border-box',\n    },\n    sections: {\n        position: 'relative',\n        height: 16,\n    },\n    section: {\n        position: 'absolute',\n        top: 0,\n        bottom: 0,\n        border: '1px solid #121212',\n    },\n    bottomInner: {\n        height: '100%',\n    },\n    title: {\n        lineHeight: 2.5,\n        fontWeight: 300,\n        paddingLeft: 16,\n    },\n});\n\nconst useFrame = (fn) => {\n    useEffect(() => {\n        let valid = true;\n        const onFrameWrapped = () => {\n            if (fn) fn();\n            if (valid) requestAnimationFrame(onFrameWrapped);\n        };\n        requestAnimationFrame(onFrameWrapped);\n        return () => { valid = false; };\n    }, [fn]);\n}\n\nfunction Generation({\n    moodboard,\n    data,\n    data: {\n        song,\n        artist,\n        album: { al_name: album },\n        sections,\n        featuress: { duration_s: length },\n        url,\n        lrc,\n    },\n    initialRef: { current: initialGraph },\n    setStep, prev,\n}) {\n    const classes = useStyles();\n\n    const lyrics = useMemo(() => {\n        let { lyrics } = Lrc.parse(lrc);\n        lyrics.sort(({ timestamp: t1 }, { timestamp: t2 }) => t1 - t2);\n        lyrics = lyrics.map(({ timestamp, ...rest }, i) => ({\n            start: timestamp,\n            end: i === lyrics.length - 1 ? length : lyrics[i + 1].timestamp,\n            ...rest,\n        }));\n        for (const l of lyrics) {\n            const { start: ls, end: le } = l;\n            l.section = sections.map(({ start: ss, duration: sd }, i) => ({\n                idx: i,\n                len: Math.max(0, Math.min(le, ss + sd) - Math.max(ls, ss)),\n            })).sort(({ len: l1 }, { len: l2 }) => -l1 + l2)[0].idx;\n        }\n        return lyrics;\n    }, [lrc, length, sections]);\n\n    const [params, setParams] = useState(null);\n    useEffect(() => {\n        Promise.all(sections.map((section, i) => exec(initialGraph, {\n            moodboard,\n            data,\n            idx: i,\n            section,\n        }))).then(setParams);\n    }, [data, moodboard, initialGraph, sections]);\n\n    const [canvas, setCanvas] = useState(null);\n\n    const convert = useMemo(() => {\n        const convert = ({ name, path, type, children, ...rest }, i) => {\n            switch (type) {\n                case 'folder': return (\n                    <DatFolder key={i} title={name} closed={false} {...rest}>\n                        {children.map(convert)}\n                    </DatFolder>\n                );\n                case 'string': return (\n                    <DatString key={i} path={path} label={name} {...rest} />\n                );\n                case 'color': return (\n                    <DatColor key={i} path={path} label={name} {...rest} />\n                );\n                case 'number': return (\n                    <DatNumber key={i} path={path} label={name} {...rest} />\n                );\n                case 'boolean': return (\n                    <DatBoolean key={i} path={path} label={name} {...rest} />\n                );\n                default: return null;\n            }\n        };\n        return convert;\n    }, []);\n\n    const audio = useMemo(() => {\n        return new Audio(url);\n    }, [url]);\n    const [currentTime, setCurrentTime] = useState(0);\n    const [playing, setPlaying] = useState(false);\n    useEffect(() => {\n        if (!audio) return;\n        const onUpdate = () => setCurrentTime(audio.currentTime);\n        const onPlay = () => setPlaying(true);\n        const onPause = () => setPlaying(false);\n        audio.addEventListener('timeupdate', onUpdate);\n        audio.addEventListener('play', onPlay);\n        audio.addEventListener('pause', onPause);\n        return () => {\n            audio.removeEventListener('timeupdate', onUpdate);\n            audio.removeEventListener('play', onPlay);\n            audio.removeEventListener('pause', onPause);\n        };\n    }, [audio]);\n    const onSeek = useCallback((_, newVal) => {\n        audio.currentTime = newVal;\n    }, [audio]);\n    const play = useCallback(() => audio.play(), [audio]);\n    const pause = useCallback(() => audio.pause(), [audio]);\n\n    const currentSegment = useMemo(() => {\n        for (let i = 0; i < sections.length; ++i) {\n            const { start, duration } = sections[i];\n            if (currentTime < start + duration) return i;\n        }\n        return sections.length - 1;\n    }, [currentTime, sections]);\n\n    const [initTime, setInitTime] = useState(new Date().getTime());\n    const renewTime = useCallback(() => {\n        setInitTime(() => new Date().getTime());\n    }, []);\n    const renderFrame = useCallback(() => {\n        if (!params || !canvas) return;\n\n        const currentTime = audio.currentTime;\n\n        const width = 1920, height = 1080;\n        // canvas\n        canvas.width = width;\n        canvas.height = height;\n        const scale = Math.min(canvas.parentNode.clientWidth / canvas.width, canvas.parentNode.clientHeight / canvas.height);\n        canvas.style.transform = `scale(${scale})`;\n        canvas.style.marginLeft = `${-width / 2}px`;\n        canvas.style.marginTop = `${-height / 2}px`;\n        const ctx = canvas.getContext('2d');\n        ctx.fillStyle = params[currentSegment].backgroundColor;\n        ctx.fillRect(0, 0, width, height);\n\n        lyrics\n            // .filter(({ section }) => section === currentSegment)\n            .forEach(({ start, end, content: lyric }, lyricIdx) => {\n                if (!(start - 1 <= currentTime && end + 1 >= currentTime)) return;\n                render({\n                    width, height, ctx, lyric, currentTime, start, end,\n                    seed: initTime /* + currentSegment * 1000 */ + lyricIdx,\n                    params: params[currentSegment],\n                });\n            });\n    }, [canvas, params, currentSegment, lyrics, audio, initTime]);\n    useFrame(renderFrame);\n\n    return (\n        <div className={classes.root}>\n            <div className={classes.canvasContainer}>\n                <canvas className={classes.canvas} ref={setCanvas} />\n            </div>\n            <div className={classes.side}>\n                <Typography color=\"textPrimary\" variant=\"h6\" classes={{ root: classes.title }}>\n                    段落 {currentSegment + 1}\n                </Typography>\n                {params && <DatGui\n                    data={params[currentSegment]}\n                    onUpdate={(newData) => {\n                        newData = { ...data, ...newData };\n                        setParams(params => {\n                            const newParams = _.cloneDeep(params);\n                            newParams[currentSegment] = newData;\n                            return newParams;\n                        });\n                    }}\n                    style={{\n                        position: 'relative',\n                        backgroundColor: '#1A1A1A',\n                        right: 0,\n                        left: 0,\n                        width: '100%',\n                    }}\n                >\n                    {config.map(convert)}\n                </DatGui>}\n            </div>\n            <div className={classes.bottom}>\n                <Grid container direction=\"column\" justify=\"space-between\" classes={{ root: classes.bottomInner }}>\n                    <Grid item container>\n                        <Grid item xs={5}>\n                            <Typography color=\"textSecondary\">\n                                {song} / {artist} - {album.substring(0, 10)}\n                            </Typography>\n                        </Grid>\n                        <Grid item xs container justify=\"center\" spacing={4}>\n                            <Grid item>\n                                {playing ? (\n                                    <PauseIcon\n                                        style={{\n                                            color: grey[100],\n                                            cursor: 'pointer',\n                                        }}\n                                        onClick={pause}\n                                    />\n                                ) : (\n                                        <PlayArrowIcon\n                                            style={{\n                                                color: grey[100],\n                                                cursor: 'pointer',\n                                            }}\n                                            onClick={play}\n                                        />\n                                    )}\n                            </Grid>\n                            <Grid item>\n                                <FullscreenIcon\n                                    style={{\n                                        color: grey[100],\n                                        cursor: 'pointer',\n                                    }}\n                                />\n                            </Grid>\n                        </Grid>\n                        <Grid item xs={5} container justify=\"flex-end\" spacing={2}>\n                            <Grid item>\n                                <Button variant=\"outlined\" color=\"primary\" onClick={() => setStep(prev)}>\n                                    上一步\n                                </Button>\n                            </Grid>\n                            <Grid item>\n                                <Button variant=\"outlined\" color=\"primary\" onClick={renewTime}>\n                                    换个效果\n                                </Button>\n                            </Grid>\n                            <Grid item>\n                                <Button variant=\"outlined\" color=\"primary\">\n                                    下载视频\n                                </Button>\n                            </Grid>\n                        </Grid>\n                    </Grid>\n                    <Grid item container direction=\"column\" spacing={0}>\n                        <Grid item>\n                            <Typography color=\"textPrimary\" variant=\"body2\">\n                                <Length time={currentTime} />\n                                &nbsp;/&nbsp;\n                                <Length time={length} />\n                            </Typography>\n                        </Grid>\n                        <Grid item>\n                            <Slider value={currentTime} onChange={onSeek} max={length} step={0.01} />\n                        </Grid>\n                        <Grid item>\n                            <div className={classes.sections}>\n                                {sections.map(({ start, climax }, i) => {\n                                    const end = (i === sections.length - 1 ? length : sections[i + 1].start);\n                                    return (\n                                        <div\n                                            key={`section-${i}`}\n                                            className={classes.section}\n                                            style={{\n                                                left: `${start / length * 100}%`,\n                                                right: `${(1 - end / length) * 100}%`,\n                                                backgroundColor: climax === 0 ? '#03DAC5' : '#F2994A',\n                                                opacity: i === currentSegment ? 1.0 : 0.2,\n                                            }}\n                                        />\n                                    );\n                                })}\n                            </div>\n                        </Grid>\n                    </Grid>\n                </Grid>\n            </div>\n        </div>\n    );\n}\n\nexport default Generation;\n","import SongSelection from './SongSelection';\nimport Moodboard from './Moodboard';\nimport { FetchData, FetchFont } from './Loading';\nimport Segmentation from './Segmentation';\nimport { InitialValues } from './Rules';\nimport Generation from './Generation';\n\nconst steps = {\n    SongSelection, FetchData, FetchFont, Moodboard, Segmentation,\n    InitialValues, Generation, \n};\n\nconst nextSteps = {\n    SongSelection: 'FetchData',\n    FetchData: 'Moodboard',\n    Moodboard: 'FetchFont',\n    FetchFont: 'Segmentation',\n    Segmentation: 'InitialValues',\n    InitialValues: 'Generation',\n};\n\nconst prevSteps = {\n    Segmentation: 'Moodboard',\n    InitialValues: 'Segmentation',\n    Generation: 'InitialValues',\n};\n\nconst initialStep = 'SongSelection';\n\nexport { steps, nextSteps, initialStep, prevSteps };\n","import React from 'react';\nimport NodeMap from '../retex/NodeMap';\n\nfunction InitialValues({ initial, setInitial, setStep, next, prev }) {\n    return (\n        <NodeMap setStep={setStep} defaults={initial} onUpdate={setInitial} name=\"initial\" next={next} prev={prev}/>\n    );\n}\n\nfunction GenerationRules({ generation, setGeneration, setStep, next, prev }) {\n    return (\n        <NodeMap setStep={setStep} defaults={generation} onUpdate={setGeneration} name=\"generation\" next={next} prev={prev}/>\n    );\n}\n\nexport { InitialValues, GenerationRules };\n","import React, { useState, useMemo, useCallback, useRef } from 'react';\nimport { MuiThemeProvider, makeStyles } from '@material-ui/core';\nimport { createMuiTheme } from '@material-ui/core/styles';\n\nimport './index.css';\nimport { steps, initialStep, nextSteps, prevSteps } from './steps';\nimport defaultInitial from './assets/initial.json';\nimport defaultGeneration from './assets/generation.json';\n\nconst theme = createMuiTheme({\n    palette: {\n        primary: { main: '#BB86FC' },\n        secondary: { main: '#A0A0A0' },\n        type: 'dark',\n    },\n});\n\nconst useStyles = makeStyles({\n    root: {\n        backgroundColor: '#121212',\n        overflow: 'hidden',\n        height: '100vh',\n    },\n});\n\nconst useAutoSave = (initial, saveKey, timeout = 3000) => {\n    const actualInitial = useMemo(() => {\n        if (localStorage[saveKey]) {\n            return JSON.parse(localStorage[saveKey]);\n        } else return initial;\n    }, [initial, saveKey]);\n    const valueRef = useRef(actualInitial);\n    const setValue = useCallback((value) => {\n        valueRef.current = value;\n        setTimeout(() => {\n            if (value !== valueRef.current) return;\n            localStorage[saveKey] = JSON.stringify(value);\n            console.log('Data saved!');\n        }, timeout);\n    }, [saveKey, timeout]);\n    return [actualInitial, setValue, valueRef];\n}\n\nfunction App() {\n    const classes = useStyles();\n    const [step, setStep] = useState(initialStep);\n    const Component = steps[step];\n\n    const [id, setId] = useState('');\n    const [data, setData] = useState({});\n    const [error, setError] = useState(null);\n    const [moodboard, setMoodboard] = useState({});\n    const [initial, setInitial, initialRef] = useAutoSave(defaultInitial, 'initial');\n    const [generation, setGeneration, generationRef] = useAutoSave(defaultGeneration, 'generation');\n\n    const params = {\n        next: nextSteps[step],\n        prev: prevSteps[step],\n        step, setStep,\n        id, setId,\n        error, setError,\n        data, setData,\n        moodboard, setMoodboard,\n        initial, setInitial, initialRef, generation, setGeneration, generationRef,\n    };\n\n    return (\n        <MuiThemeProvider theme={theme}>\n            <div className={classes.root}>\n                <Component {...params}/>\n            </div>\n        </MuiThemeProvider>\n    )\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(<App/>, document.querySelector('#root'));\n","module.exports = __webpack_public_path__ + \"static/media/logo-colored.9176ce0d.svg\";"],"sourceRoot":""}