{"version":3,"sources":["steps/SongSelection.jsx","steps/Loading.jsx","steps/MoodboardCanvas.jsx","steps/Moodboard.jsx","steps/Length.jsx","steps/Segmentation.jsx","retex/MyNode.js","retex/sockets.js","components/BeanComponent.js","components/InitiatorComponent.js","components/io.js","components/common.js","components/render/FontComponent.js","components/render/index.js","components/render/CanvasComponent.js","components/render/CharComponent.js","components/generation/SplitComponent.js","components/utils.js","components/generation/BalancedAComponent.js","components/generation/BalancedBComponent.js","components/generation/NeutralComponent.js","components/generation/ActiveAComponent.js","components/generation/ActiveBComponent.js","components/generation/index.js","components/calculation/UniformComponent.js","components/calculation/StepComponent.js","components/calculation/conditional.js","components/calculation/index.js","components/index.js","retex/NodeMap.jsx","steps/params.js","retex/engine.js","retex/exec.js","steps/render.js","steps/Generation.jsx","steps/index.js","steps/Rules.jsx","App.jsx","index.js","assets/logo-colored.svg"],"names":["useStyles","makeStyles","form","height","grid","input","width","SongSelection","setId","setStep","classes","useForm","register","handleSubmit","onSubmit","useCallback","id","className","Grid","container","justify","spacing","alignItems","direction","item","src","logo","alt","TextField","name","label","variant","size","root","inputRef","required","Button","color","disableElevation","type","Container","maxWidth","Link","href","progress","Loading","setData","useEffect","a","fetch","resp","json","data","console","log","LinearProgress","fillRoundRect","ctx","x","y","radius","save","translate","beginPath","arc","Math","PI","lineTo","closePath","fill","restore","drawShape","shape","canvaswidth","canvasheight","loc1_x","loc1_y","loc2_x","loc2_y","loc3_x","loc3_y","r1","r2","r3","loc_flag","random","fillRect","drawTriangle","drawPentagon","colorGenerate","dan","ene","val","aco","tem","liv","liv_flag","tinycolor","require","hue","sat","bri","hue_arg","sat_arg","bri_arg","bw","text_flag","graph_flag","rand_flag","hue_flag","sat2","bri2","BG","TX","GR","complement","greyscale","shape_flag","toString","fontGenerate","fontName","backupFont","r","pow","round","loc_x","loc_y","moveTo","i","ang","rotate","initCanvas","tempo","energy","danceability","acousticness","valence","song","mb","liveness","letterSpacing","fontSize","fontWeight","c","document","getElementById","getContext","fillStyle","style","font","textAlign","fillText","text","marginTop","marginBottom","backgroundColor","outline","CanvasButton","withStyles","boxShadow","padding","Moodboard","setMoodboard","artist","album","al_name","featuress","useState","index","selectCanvas","setMB","Array","from","length","items","nextStep","xs","Typography","align","onClick","overflow","map","key","Length","time","secs","s","m","ss","sm","content","marginLeft","sections","position","section","top","bottom","border","cursor","edge","zIndex","Segmentation","localData","setLocalData","localSections","duration_s","url","audio","useMemo","Audio","currentTime","setCurrentTime","playing","setPlaying","onUpdate","onPlay","onPause","addEventListener","removeEventListener","onSeek","_","newVal","play","pause","useDimensions","ref","grey","Slider","value","onChange","max","start","climax","left","right","newData","axis","bounds","onDrag","__","onStop","Label","justifyContent","middle","lineHeight","DefaultInput","inputDef","defaultVal","options","controlType","io","props","connections","typeName","path","min","step","Wrapper","children","onPointerMove","MyNode","node","this","initialState","inputDefs","setState","editor","bindSocket","bindControl","state","outputs","controls","inputs","convert","trigger","output","socket","innerRef","control","e","stopPropagation","showControl","Node","sockets","Proxy","any","Rete","Socket","get","obj","prop","combineWith","BeanComponent","outputDefs","Object","keys","displayName","Input","addInput","Output","addOutput","Component","InitiatorComponent","parseFloat","values","expr","parser","Parser","parsed","parse","evaluate","z","textWidth","sizes","background","canvas","scale","parentNode","clientWidth","clientHeight","transform","x0","y0","dir","ignoreWhitespaces","alignBaseline","ch","split","join","bx","by","closed","fontFamily","textBaseline","SplitComponent","parts","randomness","deltas","begin","end","substring","interp","b","divide","uniform","x1","y1","scatter","opposite","mirrored","vertical","horizontal","n","f","BalancedAComponent","dist","BalancedBComponent","rows","cols","indices","pickRandom","u","v","reduce","count","sort","u1","v1","u2","v2","NeutralComponent","lineSpacing","point","delta","ActiveAComponent","angle","rx","ry","distToLine","x2","y2","abs","sqrt","atan2","sin","shapes","distToShape","p1","p2","newDist","bestCandidate","tries","maxR","minR","polygon","inside","d","push","chosen","debug","chains","chain","splice","candidates","filter","rest","k","dimension","sortAngle","sortScale","shouldSort","sorted","UniformComponent","StepComponent","cond","thres","lt","gt","ind","n0","n1","n2","n3","n4","n5","n6","n7","n8","n9","vals","conditional","common","render","generation","calculation","buttons","NodeMap","defaults","next","setRoot","NodeEditor","onUpdateRef","useRef","current","use","ConnectionPlugin","ReactRenderPlugin","component","ContextMenuPlugin","components","forEach","fromJSON","on","toJSON","download","JSON","stringify","blob","Blob","saveAs","upload","files","file","readAsText","fileTypes","handleFiles","config","Engine","nodes","graph","inputNodes","nodeInputs","dkey","nid","skey","includes","queue","processed","unprocessed","it","run","newCtx","find","undefined","every","iid","Error","findNode","nodeData","inputVals","sid","worker","call","outputVals","engine","process","balancedA","balancedB","neutral","activeA","activeB","patternType","params","t","float","pattern","char","duration","rotation","easing1","BezierEasing","easing2","sides","square","triangle","pentagon","cos","char2","lyric","chi","outEffect","inEffect","inEndTime","inStartTime","outStartTime","outEndTime","opacity","Color","textColor","alpha","string","easing","patch","seed","rng","seedrandom","modes","enabled","mode","indexOf","num","int","splitMax","ceil","minDist","maxDist","minAngle","maxAngle","side","canvasContainer","boxSizing","bottomInner","title","paddingLeft","Generation","steps","InitialValues","initial","setInitial","GenerationRules","setGeneration","moodboard","lrc","initialGraph","initialRef","lyrics","Lrc","timestamp","l","ls","le","sd","idx","len","setParams","Promise","all","exec","then","setCanvas","fn","currentSegment","Date","getTime","initTime","setInitTime","renewTime","renderFrame","lyricIdx","valid","requestAnimationFrame","onFrameWrapped","newParams","theme","createMuiTheme","palette","primary","main","secondary","useAutoSave","saveKey","timeout","actualInitial","localStorage","valueRef","setValue","setTimeout","App","error","setError","defaultInitial","defaultGeneration","generationRef","ReactDOM","querySelector","module","exports"],"mappings":"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","file":"static/js/main.9c113254.chunk.js","sourcesContent":["import React, { useCallback } from 'react';\nimport { makeStyles, Button, TextField, Grid, Link, Container } from '@material-ui/core';\nimport { useForm } from 'react-hook-form';\nimport logo from '../assets/logo-colored.svg';\n\nconst useStyles = makeStyles({\n    form: {\n        height: '100%',\n    },\n    grid: {\n        height: '100%',\n    },\n    input: {\n        width: 500,\n    },\n});\n\nfunction SongSelection({ setId, setStep }) {\n    const classes = useStyles();\n    const { register, handleSubmit } = useForm();\n    const onSubmit = useCallback(({ id }) => {\n        setId(id);\n        setStep('Loading');\n    }, [setStep, setId]);\n    return (\n        <form onSubmit={handleSubmit(onSubmit)} className={classes.form}>\n            <Grid\n                container\n                justify=\"center\"\n                spacing={4}\n                className={classes.grid}\n                alignItems=\"center\"\n                direction=\"column\"\n            >\n                <Grid item>\n                    <img src={logo} alt=\"\" height=\"51\" />\n                </Grid>\n                <Grid item container\n                    spacing={1}\n                    justify=\"center\"\n                    alignItems=\"center\"\n                >\n                    <Grid item>\n                        <TextField\n                            name=\"id\"\n                            label=\"网易云音乐ID\"\n                            variant=\"outlined\"\n                            size=\"small\"\n                            classes={{ root: classes.input }}\n                            inputRef={register({ required: true })}\n                        />\n                    </Grid>\n                    <Grid item>\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            disableElevation\n                            type=\"submit\"\n                        >\n                            开始创建\n                        </Button>\n                    </Grid>\n                </Grid>\n                <Container maxWidth = 'sm'>\n                    <Link\n                        variant = \"caption\"\n                        href=\"#\"\n                        color=\"secondary\"\n                    >\n                        如何获取?\n                    </Link>\n                </Container>\n            </Grid>\n        </form>\n    )\n}\n\nexport default SongSelection;\n","import React, { useEffect } from 'react';\nimport { makeStyles, LinearProgress, Grid } from '@material-ui/core';\nimport logo from '../assets/logo-colored.svg';\n// import sample from '../assets/sample3.json';\n\nconst useStyles = makeStyles({\n    grid: {\n        height: '100%',\n    },\n    progress: {\n        width: 600,\n    },\n});\n\n// const delay = (time) => new Promise((resolve) => {\n//     setTimeout(resolve, time);\n// });\n\nfunction Loading({ id, setStep, setData }) {\n    const classes = useStyles();\n    useEffect(() => {\n        (async () => {\n            try {\n                // TODO: switch to actual api when server is ready\n                const resp = await fetch(`https://dcdcapi.herokuapp.com/song/${id}`);\n                const data = await resp.json();\n                setData(data);\n                // await delay(1000);\n                // setData(sample);\n                setStep('Moodboard');\n            } catch (e) {\n                console.log(e);\n            }\n        })();\n    }, [setStep, setData, id]);\n    return (\n        <Grid\n            container\n            justify=\"center\"\n            spacing={4}\n            className={classes.grid}\n            alignItems=\"center\"\n            direction=\"column\"\n        >\n            <Grid item>\n                <img src={logo} alt=\"\" height=\"51\" />\n            </Grid>\n            <Grid item classes={{ root: classes.progress }}>\n                <LinearProgress />\n            </Grid>\n        </Grid>\n    )\n}\n\nexport default Loading;\n","const initCanvas = (tempo, energy, danceability, acousticness, valence, song, canvaswidth, canvasheight) => {\n    var mb = [];\n    for( var i = 1; i <= 200; i++ ){\n        var [BG,GR,TX,shape,liveness] = colorGenerate(danceability,energy,valence,acousticness,tempo);\n        var [letterSpacing,fontSize,fontWeight,fontName,backupFont] = fontGenerate(danceability,energy,valence,acousticness,tempo);\n        letterSpacing /= 3;\n        fontSize /= 3;\n        let c = document.getElementById(\"littleCanvas\"+i);\n        let ctx = c.getContext(\"2d\");\n        ctx.fillStyle = BG;\n        fillRoundRect(ctx, 0, 0, canvaswidth, canvasheight, 4);\n        ctx.fillStyle = GR;\n        drawShape(ctx, shape, canvaswidth, canvasheight);\n        c.style.letterSpacing = letterSpacing+'px';\n        ctx.font = fontWeight+' '+fontSize+'px '+fontName+','+backupFont;\n        ctx.fillStyle = TX;\n        ctx.textAlign = \"center\";\n        ctx.fillText(song,(canvaswidth+letterSpacing)*0.5,canvasheight*0.5+fontSize/3);\n        ctx.font = fontWeight+' '+(fontSize*0.5)+'px '+fontName+','+backupFont;\n        ctx.fillStyle = TX;\n        ctx.textAlign = \"center\";\n        ctx.fillText(fontName,(canvaswidth+letterSpacing)*0.5,canvasheight*0.8);\n        mb[i] = { BG, GR, TX, letterSpacing, fontSize, fontWeight, fontName, backupFont, liveness, shape };\n    }\n    return mb;\n};\n\nconst fillRoundRect = (ctx, x, y, width, height, radius) => {     \n    if (2 * radius > width || 2 * radius > height) { return false; }\n    ctx.save();\n    ctx.translate(x, y); \n    ctx.beginPath(0);\n    ctx.arc(width - radius, height - radius, radius, 0, Math.PI / 2);\n    ctx.lineTo(radius, height);\n    ctx.arc(radius, height - radius, radius, Math.PI / 2, Math.PI);\n    ctx.lineTo(0, radius);\n    ctx.arc(radius, radius, radius, Math.PI, Math.PI * 3 / 2);\n    ctx.lineTo(width - radius, 0);  \n    ctx.arc(width - radius, radius, radius, Math.PI * 3 / 2, Math.PI * 2);  \n    ctx.lineTo(width, height - radius);\n    ctx.closePath();\n    ctx.fill();\n    ctx.restore();\n};\n\nconst drawShape = (ctx, shape, canvaswidth, canvasheight) => {\n    var loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y;\n    var r1, r2, r3;\n    var loc_flag = Math.random();\n    if(loc_flag <= 0.2) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.75, 0.5, 0.5, 0.2, 0.2, 0.8];\n    else if(loc_flag <= 0.4) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.22, 0.3, 0.75, 0.5, 0.5, 0.8];\n    else if(loc_flag <= 0.6) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.43, 0.23, 0.8, 0.6, 0.2, 0.85];\n    else if(loc_flag <= 0.8) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.67, 0.7, 0.25, 0.5, 0.85, 0.2];\n    else if(loc_flag <= 1) [loc1_x, loc1_y, loc2_x, loc2_y, loc3_x, loc3_y] = [0.2, 0.72, 0.53, 0.2, 0.8, 0.7];\n    loc_flag = Math.random()*0.1-0.05;\n    loc1_x += loc_flag;\n    loc1_y += loc_flag;\n    loc2_x += loc_flag;\n    loc2_y += loc_flag;\n    loc3_x += loc_flag;\n    loc3_y += loc_flag;\n\n    if(shape === \"circle\"){\n        [r1,r2,r3] = [0.2,0.15,0.12];\n        ctx.beginPath();\n        ctx.arc(canvaswidth*loc1_x,canvasheight*loc1_y,canvasheight*r1,0,2*Math.PI);\n        ctx.fill();\n        ctx.beginPath();\n        ctx.arc(canvaswidth*loc2_x,canvasheight*loc2_y,canvasheight*r2,0,2*Math.PI);\n        ctx.fill();\n        ctx.beginPath();\n        ctx.arc(canvaswidth*loc3_x,canvasheight*loc3_y,canvasheight*r3,0,2*Math.PI);\n        ctx.fill();\n    }\n    else if(shape === \"square\"){\n        [r1,r2,r3] = [0.2,0.15,0.12];\n        ctx.fillRect(canvaswidth*loc1_x-canvasheight*r1,canvasheight*loc1_y-canvasheight*r1,canvasheight*r1*2,canvasheight*r1*2);\n        ctx.fillRect(canvaswidth*loc2_x-canvasheight*r2,canvasheight*loc2_y-canvasheight*r2,canvasheight*r2*2,canvasheight*r2*2);\n        ctx.fillRect(canvaswidth*loc3_x-canvasheight*r3,canvasheight*loc3_y-canvasheight*r3,canvasheight*r3*2,canvasheight*r3*2);\n    }\n    else if(shape === \"line\"){\n        [r1,r2,r3] = [0.3,0.2,0.15];\n        ctx.fillRect(canvaswidth*loc1_x-canvasheight*r1,canvasheight*loc1_y-canvasheight*0.025,canvasheight*r1*2,canvasheight*0.05);\n        ctx.fillRect(canvaswidth*loc2_x-canvasheight*r2,canvasheight*loc2_y-canvasheight*0.025,canvasheight*r2*2,canvasheight*0.05);\n        ctx.fillRect(canvaswidth*loc3_x-canvasheight*r3,canvasheight*loc3_y-canvasheight*0.025,canvasheight*r3*2,canvasheight*0.05);\n    }\n    else if(shape === \"triangle\"){\n        [r1,r2,r3] = [0.4,0.25,0.2];\n        drawTriangle(ctx,loc1_x,loc1_y,r1,canvaswidth,canvasheight);\n        drawTriangle(ctx,loc2_x,loc2_y,r2,canvaswidth,canvasheight);\n        drawTriangle(ctx,loc3_x,loc3_y,r3,canvaswidth,canvasheight);\n    }\n    else if(shape === \"pentagon\"){\n        [r1,r2,r3] = [0.25,0.16,0.12];\n        drawPentagon(ctx,loc1_x,loc1_y,r1,canvaswidth,canvasheight);\n        drawPentagon(ctx,loc2_x,loc2_y,r2,canvaswidth,canvasheight);\n        drawPentagon(ctx,loc3_x,loc3_y,r3,canvaswidth,canvasheight);\n    }\n}\n\nconst colorGenerate = (dan, ene, val, aco, tem) => {\n    //get liveness\n    var tinycolor = require(\"tinycolor2\");\n    var liv, liv_flag;\n    if(val < 0.4) liv_flag = 0.2 * dan + 0.8 * val;\n    else liv_flag = 0.7 * dan + 0.3 * val;\n    if(aco < 0.2) liv_flag += 0.2;\n\n    if(liv_flag > 0.6) liv = 1;\n    else if(liv_flag > 0.35) liv = 0.5;\n    else liv = 0;\n\n    //color generate\n    var bw = 1;\n    if(Math.random() < 0.3) bw = 0;\n\n    var hue, sat, bri;\n    var hue_arg, sat_arg, bri_arg;\n    var text_flag = 1, graph_flag = 1, rand_flag = 1;\n    var hue_flag = 1.0 - val * 0.5 - dan * 0.25 - ene * 0.25;\n\n    if(Math.random() * 10 < 5) rand_flag = -1;\n\n    if(hue_flag < 0.4) hue_arg = 0;\n    else if(hue_flag < 0.6) hue_arg = 0.5;\n    else hue_arg = 1;\n    \n    if(hue_arg === 0.5) hue = (Math.random() * 150 + 120 + 360) % 360;\n    else if(hue_arg === 0) hue = (20 - rand_flag * hue_flag / 0.4 * 35 + rand_flag * Math.random() * 15 + 360) % 360;\n    else if(hue_arg === 1) hue = (185 - rand_flag * (1 - hue_flag) / 0.4 * 110 + rand_flag * Math.random() * 100 + 360) % 360;\n\n    if(aco > 0.5) sat_arg = (((dan * 1.2 + ene * 1.2 - aco * 2.4) * 100) * 0.5) + 50;\n    else if(dan > 0.6) sat_arg = (((dan * 0.4 + ene * 0.6) * 100) * 0.5) + 50;\n    else sat_arg = (((dan * 0.5 + ene * 0.5 - aco * 0.1) * 100) * 0.5) + 50;\n\n    sat = (Math.random() * 10 - 5 + sat_arg) / 100;\n    if(hue_arg === 0.5) sat *= 0.8;\n\n    bri_arg = (((ene * 0.6 + aco * 0.4) * 100) * 0.3) + val * 120;\n    bri = (Math.random() * 20 - 10 + bri_arg) / 100;\n    if(bri > 0.95) bri = 0.95;\n\n    if(sat > 0.7) sat = 0.7;\n    if(sat < 0.2) sat = 0.2;\n\n    if(sat*0.3 + 0.7 - bri < 0){\n        text_flag = 0;\n        graph_flag = 0;\n    }\n\n    var BG = tinycolor(\"hsv(\" + hue + \",\" + sat + \",\" + bri + \")\");\n    var TX = (text_flag === 0) ? tinycolor(\"hsv(\" + (hue + rand_flag * 10 + 360) % 360 + \",\" + 0.9 + \",\" + 0.2 + \")\") : tinycolor(\"hsv(\" + (hue + rand_flag * 10 + 360) % 360 + \",\" + 0.05 + \",\" + 0.95 + \")\");\n    var sat2, bri2;\n    if(graph_flag === 0){\n        sat2 = sat - 0.05;\n        if(sat2 < 0) sat2 = 0;\n        bri2 = bri + 0.1;\n        if(bri2 > 1) bri2 = 1;\n    }\n    else{\n        sat2 = sat + 0.05;\n        if(sat2 > 1) sat2 = 1;\n        bri2 = bri - 0.1;\n        if(bri2 < 0) bri2 = 0;\n    }\n    var GR = tinycolor(\"hsv(\" + (hue + rand_flag * 20 + Math.random() * 10 + 360) % 360 + \",\" + sat2 + \",\" + bri2 + \")\");\n    if(Math.random() > 0 && liv === 1) GR = GR.complement();\n    \n    if(bw === 0){\n        if(Math.random() > 0.5){\n            BG = tinycolor(\"black\");\n            TX = tinycolor(\"white\");\n        }\n        else{\n            TX = tinycolor(\"black\");\n            BG = tinycolor(\"white\");\n        } \n        if(Math.random() > 0.5) GR = GR.greyscale();\n    }\n    \n    var shape = \"circle\", shape_flag = Math.random();\n    if(shape_flag <= 0.2) shape = \"circle\";\n    else if(shape_flag <= 0.4) shape = \"square\";\n    else if(shape_flag <= 0.6) shape = \"line\";\n    else if(shape_flag <= 0.8) shape = \"triangle\";\n    else if(shape_flag <= 1) shape = \"pentagon\";\n\n    return [BG.toString('rgb'),GR.toString('rgb'),TX.toString('rgb'),shape,liv];\n}\n\nconst fontGenerate = (dan, ene, val, aco, tem) => {\n    var fontName, backupFont, r;\n    if(aco > 0.8){\n        if(Math.random() < 0.2 && ene >= 0.35 && val < 0.3) fontName = \"ORADANO明朝\";\n        else fontName = \"源云明体\";\n    }\n    else if(aco>0.55){\n        if(Math.random() < 0.5 && ene * 0.6+dan * 0.4 >= 0.85) fontName = \"源界明朝\";\n        else if(Math.random() < 0.7  &&  ene * 0.6+dan * 0.4 >= 0.7) fontName = \"装甲明朝\";\n        else fontName = \"思源宋体\";\n    }\n    else if(aco > 0.4){\n        if(ene * 0.6 + dan * 0.4 >= 0.85){\n            r = Math.random();\n            if(r < 0.5) fontName = \"源界明朝\";\n            else if(r < 0.75) fontName = \"思源宋体\";\n            else fontName = \"源石黑体\";\n        }\n        else if(ene * 0.6 + dan * 0.4 >= 0.7){\n            r = Math.random();\n            if(r < 0.7) fontName = \"装甲明朝\";\n            else if(r < 0.85) fontName = \"思源宋体\";\n            else fontName = \"源石黑体\";\n        }\n        else fontName = \"源石黑体\";\n    }\n    else if(aco > 0.02){\n        if(tem < 86 && val > 0.45){\n            r = Math.random();\n            if(r < 0.4) fontName = \"思源黑体\";\n            else if(r < 0.6) fontName = \"清松手写体\";\n            else if(r < 0.8) fontName = \"粉圆\";\n            else fontName = \"资源黑体\";\n        }\n        else fontName = \"思源黑体\"; \n    }\n    else{\n        if(tem < 86 && val > 0.45){\n            r = Math.random();\n            if(r < 0.2) fontName = \"未来莹黑\";\n            else if(r < 0.4) fontName = \"思源黑体\";\n            else if(r < 0.6) fontName = \"清松手写体\";\n            else if(r < 0.8) fontName = \"粉圆\";\n            else fontName = \"资源黑体\";\n        }\n        else fontName = \"未来莹黑\";\n    }\n\n    if(fontName === \"ORADANO明朝\" || fontName === \"源云明体\" || fontName === \"源界明朝\" || fontName === \"装甲明朝\") backupFont = \"思源宋体\";\n    else if(fontName === \"源石黑体\") backupFont = \"思源黑体\";\n    else if(fontName === \"粉圆\") backupFont = \"资源黑体\";\n    else backupFont = \"未来莹黑\";\n\n    var letterSpacing = 0; //letter spacing\n    var fontWeight = 300;   //font weight\n    var fontSize = 60;    //font size\n\n    letterSpacing = -0.7949 - 18.2496 * Math.log(ene);\n    fontSize = 40 * Math.pow(7,ene);\n    if(ene < 0.2) fontWeight = 100;\n    else if(ene >= 0.9) fontWeight = 900;\n    else fontWeight = Math.round(ene * 10) * 100;\n\n    return [letterSpacing, fontSize, fontWeight, fontName, backupFont];\n}\n\nconst drawTriangle = (ctx, loc_x, loc_y, r, canvaswidth, canvasheight) => {\n    ctx.beginPath();\n    ctx.moveTo(canvaswidth*loc_x+canvasheight*0.5*r, canvasheight*loc_y+canvasheight*0.433*r);\n    ctx.lineTo(canvaswidth*loc_x-canvasheight*0.5*r, canvasheight*loc_y+canvasheight*0.433*r);\n    ctx.lineTo(canvaswidth*loc_x, canvasheight*loc_y-canvasheight*0.433*r);\n    ctx.fill();\n}\n\nconst drawPentagon = (ctx, loc_x, loc_y, r, canvaswidth, canvasheight) => {\n    ctx.save();\n    ctx.translate(canvaswidth*loc_x, canvasheight*loc_y+canvasheight*r*0.25);\n    ctx.moveTo(0, -canvasheight*r);\n    ctx.beginPath();\n    var i, ang = Math.PI*2/5;\n    for(i = 0; i < 5; i++){\n        ctx.rotate(ang);\n        ctx.lineTo(0, -canvasheight*r);\n    }\n    ctx.closePath();\n    ctx.fill();\n    ctx.restore();\n}\n\nexport default initCanvas;","import React, { useCallback, useState, useEffect } from 'react';\nimport { makeStyles, withStyles, Button, Grid, Typography } from '@material-ui/core';\nimport initCanvas from './MoodboardCanvas';\n\nconst useStyles = makeStyles({\n    grid: {\n        height: '100%',\n    },\n    progress: {\n        width: 600,\n    },\n    text: {\n        marginTop: '1em',\n        marginBottom: '8em',\n    },\n    '@global': {\n        '*::-webkit-scrollbar': {\n            width: '0.4em'\n        },\n        '*::-webkit-scrollbar-track': {\n            '-webkit-box-shadow': 'inset 0 0 6px rgba(0,0,0,0.00)'\n        },\n        '*::-webkit-scrollbar-thumb': {\n            backgroundColor: 'rgba(80,80,80,.1)',\n            outline: '1px solid slategrey'\n        }\n    }\n});\n\nconst CanvasButton = withStyles({\n    root: {\n        boxShadow: 'none',\n        backgroundColor: '#121212',\n        padding: '0 0',\n        '&:hover': {\n            boxShadow: '0 0 0 0.06rem #BBBBBB',\n        },\n        '&:focus': {\n            boxShadow: '0 0 0 0.06rem #BB86FC',\n        },\n    },\n})(Button);\n\nconst [canvaswidth, canvasheight] = [320, 180];\n\nfunction Moodboard({\n    setStep,\n    setMoodboard,\n    data: {\n        song,\n        artist,\n        album: { al_name: album },\n        featuress: { tempo, energy, danceability, acousticness, valence }\n    },\n}) {\n    const classes = useStyles();\n    const [index, selectCanvas] = useState(-1);\n    const [mb, setMB] = useState([]);\n    const [items, /* setItems */] = useState(Array.from({length: 200}));;\n    useEffect(() => {\n        setMB(initCanvas(tempo, energy, danceability, acousticness, valence, song, canvaswidth, canvasheight));\n    }, [acousticness, danceability, energy, song, tempo, valence]);\n    const nextStep = useCallback(() => {\n        setStep('Segmentation');\n        setMoodboard(mb[index]);\n    }, [mb, index, setStep, setMoodboard]);\n\n    return (\n        <Grid\n            container\n            spacing={4}\n            className={classes.grid}\n        >\n            <Grid item xs />\n            <Grid item xs={8}>\n                <Typography\n                    align=\"center\"\n                    color=\"textSecondary\"\n                    classes={{ root: classes.text }}\n                >\n                    {song} / {artist} - {album}\n                </Typography>\n                <Grid container\n                    alignItems=\"center\"\n                    justify=\"space-evenly\"\n                    spacing={6}\n                >\n                    <Grid item container direction=\"column\" xs>\n                        <Grid item>\n                            <Typography\n                                color=\"textPrimary\"\n                                variant=\"h4\"\n                            >\n                                选择情绪板\n                            </Typography>\n                        </Grid>\n                        <Grid item>\n                            <Typography\n                                color=\"textSecondary\"\n                                variant=\"body2\"\n                            >\n                                为您的歌词动画选择外观风格\n                            </Typography>\n                        </Grid>\n                    </Grid>\n                    <Grid item>\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            disableElevation\n                            onClick={nextStep}\n                        >\n                            继续创建\n                        </Button>\n                    </Grid>\n                </Grid>\n                <div style={{height:'80vh', overflow:'hidden auto'}}>\n                    <Grid container \n                        alignItems=\"center\" \n                        justify=\"space-between\" \n                        spacing={6}\n                        className={classes.grid}\n                    >\n                        {items.map((i, index) => (\n                            <Grid item key = {index}>\n                                <CanvasButton>\n                                    <canvas\n                                        id={\"littleCanvas\"+(index+1)}\n                                        width={canvaswidth}\n                                        height={canvasheight}\n                                        onClick={()=>selectCanvas(index+1)}\n                                    >\n                                    </canvas>\n                                </CanvasButton>\n                            </Grid>\n                        ))}\n                    </Grid>\n                </div>\n            </Grid>\n            <Grid item xs />\n        </Grid>\n    )\n}\n\nexport default Moodboard;\n","function Length({ time }) {\n    const secs = Math.round(time);\n    const s = secs % 60, m = ~~(secs / 60);\n    const ss = s < 10 ? `0${s}` : `${s}`, sm = m < 10 ? `0${m}` : `${m}`;\n    return `${sm}:${ss}`;\n}\n\nexport default Length;\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { makeStyles, Button, Grid, Typography, Slider } from '@material-ui/core';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport grey from '@material-ui/core/colors/grey';\nimport Draggable from 'react-draggable'; // The default\nimport useDimensions from \"react-use-dimensions\";\nimport * as _ from 'lodash';\nimport Length from './Length';\n\nconst useStyles = makeStyles({\n    grid: {\n        height: '100%',\n    },\n    progress: {\n        width: 600,\n    },\n    text: {\n        marginTop: '1em',\n        marginBottom: '8em',\n    },\n    content: {\n        marginTop: '26vh',\n    },\n    time: {\n        marginLeft: 40,\n    },\n    sections: {\n        marginTop: -16,\n        position: 'relative',\n        height: 16,\n    },\n    section: {\n        position: 'absolute',\n        top: 0,\n        bottom: 0,\n        border: '1px solid #121212',\n        cursor: 'pointer',\n        '&:hover': {\n            outline: '1px solid #BB86FC',\n            border: '1px solid #BB86FC',\n        },\n    },\n    edge: {\n        position: 'absolute',\n        top: 0,\n        bottom: 0,\n        zIndex: 2,\n        width: 6,\n        marginLeft: -3,\n        '&:hover': {\n            backgroundColor: '#BB86FC',\n        },\n        cursor: 'ew-resize',\n    },\n});\n\nfunction Segmentation({\n    setStep,\n    setData,\n    data: { sections },\n    data,\n}) {\n    const [localData, setLocalData] = useState(data);\n    const {\n        song,\n        artist,\n        album: { al_name: album },\n        sections: localSections,\n        featuress: { duration_s: length },\n        url,\n    } = localData;\n\n    const classes = useStyles();\n    const nextStep = useCallback(() => {\n        setStep('InitialValues');\n    }, [setStep]);\n    const audio = useMemo(() => {\n        return new Audio(url);\n    }, [url]);\n    const [currentTime, setCurrentTime] = useState(0);\n    const [playing, setPlaying] = useState(false);\n    useEffect(() => {\n        if (!audio) return;\n        const onUpdate = () => setCurrentTime(audio.currentTime);\n        const onPlay = () => setPlaying(true);\n        const onPause = () => setPlaying(false);\n        audio.addEventListener('timeupdate', onUpdate);\n        audio.addEventListener('play', onPlay);\n        audio.addEventListener('pause', onPause);\n        return () => {\n            audio.removeEventListener('timeupdate', onUpdate);\n            audio.removeEventListener('play', onPlay);\n            audio.removeEventListener('pause', onPause);\n        };\n    }, [audio]);\n    const onSeek = useCallback((_, newVal) => {\n        audio.currentTime = newVal;\n    }, [audio]);\n    const play = useCallback(() => audio.play(), [audio]);\n    const pause = useCallback(() => audio.pause(), [audio]);\n\n    const [ref, { width }] = useDimensions();\n\n    return (\n        <Grid\n            container\n            spacing={4}\n            className={classes.grid}\n        >\n            <Grid item xs />\n            <Grid item xs={8}>\n                <Typography\n                    align=\"center\"\n                    color=\"textSecondary\"\n                    classes={{ root: classes.text }}\n                >\n                    {song} / {artist} - {album}\n                </Typography>\n                <Grid container alignItems=\"center\" justify=\"space-between\">\n                    <Grid item container direction=\"column\" xs>\n                        <Grid item>\n                            <Typography\n                                color=\"textPrimary\"\n                                variant=\"h4\"\n                            >\n                                调整歌曲分段\n                            </Typography>\n                        </Grid>\n                        <Grid item>\n                            <Typography\n                                color=\"textSecondary\"\n                                variant=\"body2\"\n                            >\n                                拖动段落以调整起止时间\n                            </Typography>\n                        </Grid>\n                    </Grid>\n                    <Grid item>\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            disableElevation\n                            onClick={nextStep}\n                        >\n                            继续创建\n                        </Button>\n                    </Grid>\n                </Grid>\n                <div className={classes.content}>\n                    <Typography className={classes.time} color=\"textPrimary\" variant=\"body2\">\n                        <Length time={currentTime} />\n                        &nbsp;/&nbsp;\n                        <Length time={length} />\n                    </Typography>\n                    <Grid container spacing={2} alignItems=\"center\">\n                        <Grid item>\n                            {playing ? (\n                                <PauseIcon\n                                    style={{\n                                        color: grey[100],\n                                        cursor: 'pointer',\n                                    }}\n                                    onClick={pause}\n                                />\n                            ) : (\n                                <PlayArrowIcon\n                                    style={{\n                                        color: grey[100],\n                                        cursor: 'pointer',\n                                    }}\n                                    onClick={play}\n                                />\n                            )}\n                        </Grid>\n                        <Grid item xs>\n                            <Slider value={currentTime} onChange={onSeek} max={length} />\n                        </Grid>\n                    </Grid>\n                    <Grid container spacing={2} alignItems=\"center\">\n                        <Grid item>\n                            <PlayArrowIcon style={{ color: \"#121212\" }} />\n                        </Grid>\n                        <Grid item xs>\n                            <div className={classes.sections} ref={ref}>\n                                {localSections.map(({ start, climax }, i) => (\n                                    <div\n                                        key={`section-${i}`}\n                                        className={classes.section}\n                                        style={{\n                                            left: `${start / length * 100}%`,\n                                            right: `${100 - (i === localSections.length - 1 ? length : localSections[i + 1].start) / length * 100}%`,\n                                            backgroundColor: climax === 0 ? '#03DAC5' : '#F2994A',\n                                        }}\n                                        onClick={() => {\n                                            const newData = _.cloneDeep(localData);\n                                            newData.sections[i].climax = 1 - climax;\n                                            setLocalData(newData);\n                                            setData(newData);\n                                        }}\n                                    />\n                                ))}\n                                {new Array(sections.length - 1).fill(0).map((_, i) => i + 1).map(i => (\n                                    <Draggable\n                                        key={`handle=${i}-${sections[i].start}`}\n                                        axis=\"x\"\n                                        bounds={{\n                                            left: -(sections[i].start - sections[i - 1].start) / length * width,\n                                            right: (i === sections.length - 1 ? length : sections[i + 1].start - sections[i].start) / length * width,\n                                        }}\n                                        onDrag={(__, { x }) => {\n                                            const newData = _.cloneDeep(data);\n                                            newData.sections[i].start += x / width * length;\n                                            setLocalData(newData);\n                                        }}\n                                        onStop={() => {\n                                            setData(localData);\n                                        }}\n                                    >\n                                        <div\n                                            className={classes.edge}\n                                            style={{\n                                                left: sections[i].start / length * width, // unchanged while dragging\n                                            }}\n                                        />\n                                    </Draggable>\n                                ))}\n                            </div>\n                        </Grid>\n                    </Grid>\n                    <Grid container spacing={2} alignItems=\"center\">\n                        <Grid item>\n                            <PlayArrowIcon style={{ color: \"#121212\" }} />\n                        </Grid>\n                        <Grid item xs>\n                            <Typography color=\"textSecondary\" variant=\"body2\" style={{ marginTop: -16 }}>\n                                蓝绿色为普通段，橙色为高潮段，鼠标左击色块可在普通/高潮段状态间切换\n                            </Typography>\n                        </Grid>\n                    </Grid>\n                </div>\n            </Grid>\n            <Grid item xs />\n        </Grid>\n    )\n}\n\nexport default Segmentation;\n","import React from 'react';\nimport { Node, Socket, Control } from 'rete-react-render-plugin';\nimport * as _ from 'lodash';\nimport DatGui, {\n    DatBoolean, DatColor, DatNumber, DatString, DatSelect,\n} from 'react-dat-gui';\nimport typeName from 'type-name';\nimport 'react-dat-gui/dist/index.css';\nimport './styles.css';\n\nfunction Label({ name, align = 'left' }) {\n    return (\n        <li className=\"cr text\">\n            <label style={{ justifyContent: {\n                    left: 'flex-start',\n                    middle: 'center',\n                    right: 'flex-end',\n                }[align] }}>\n                <span style={{ lineHeight: '25px' }}>\n                    {name}\n                </span>\n            </label>\n        </li>\n    );\n}\n\nfunction DefaultInput({ name, inputDef: { type, defaultVal, options, controlType }, inputDef, io, ...props }) {\n    if (io.connections.length !== 0) return <Label name={name} />\n\n    if (!type) type = typeName(defaultVal);\n    if (!controlType) controlType = type;\n\n    if (controlType === 'string') return <DatString path={name} label={name} {...props} />\n    if (controlType === 'boolean') return <DatBoolean path={name} label={name} {...props} />\n    if (controlType === 'number') {\n        const { min, max, step = 0.01 } = inputDef;\n        return <DatNumber path={name} label={name} min={min} max={max} step={step} {...props} />\n    }\n    if (controlType === 'color') return <DatColor path={name} label={name} {...props} />\n    if (controlType === 'select') return <DatSelect path={name} label={name} options={options} {...props} />\n    return <Label name={name} />\n}\n\nfunction Wrapper({ children, className, onPointerMove, ...props }) {\n    return (\n        <div className={className} onPointerMove={onPointerMove}>\n            {children(props)}\n        </div>\n    );\n}\n\nclass MyNode extends Node {\n    componentDidMount() {\n        const { node } = this.props;\n        const initialState = _.fromPairs(_\n            .toPairs(node.inputDefs)\n            .map(([name, { defaultVal }]) => [name, defaultVal]));\n        this.setState({ data: initialState });\n    }\n\n    render() {\n        const { node, editor, bindSocket, bindControl } = this.props;\n        const { data, outputs, controls, inputs /*, selected */ } = this.state;\n\n        return (\n            <DatGui\n                data={data}\n                onUpdate={(newData) => {\n                    newData = { ...data, ...newData };\n                    for (const key in newData) {\n                        const { convert } = node.inputDefs[key];\n                        if (convert) newData[key] = convert(newData[key]);\n                    }\n                    node.data = newData;\n                    this.setState({ data: newData });\n                    editor.trigger('process');\n                }}\n                style={{\n                    position: 'relative',\n                    backgroundColor: '#1A1A1A',\n                }}\n            >\n                <Wrapper>\n                    {() => <>\n                        <Label name={node.name} align=\"middle\" />\n                    </>}\n                </Wrapper>\n                {outputs.map((output) => (\n                    <Wrapper className=\"retex-port retex-output\" key={output.key}>\n                        {() => <>\n                            <Label name={output.name} align=\"right\" />\n                            <Socket type=\"output\" socket={output.socket} io={output} innerRef={bindSocket} />\n                        </>}\n                    </Wrapper>\n                ))}\n                {controls.map(control => (\n                    <Control className=\"control\" key={control.key} control={control} innerRef={bindControl} />\n                ))}\n                {inputs.map(input => (\n                    <Wrapper className=\"retex-port retex-input\" key={input.key} onPointerMove={(e) => { e.stopPropagation(); }}>\n                        {props => <>\n                            <Socket type=\"input\" socket={input.socket} io={input} innerRef={bindSocket} />\n                            {!input.showControl() && <DefaultInput name={input.name} inputDef={node.inputDefs[input.name]} io={input} {...props} />}\n                            {input.showControl() && <Control className=\"input-control\" control={input.control} innerRef={bindControl} />}\n                        </>}\n                    </Wrapper>\n                ))}\n            </DatGui>\n        )\n    }\n}\n\nexport default MyNode;\n","import Rete from 'rete';\n\nconst sockets = new Proxy({\n    any: new Rete.Socket('any'),\n}, {\n    get(obj, prop) {\n        if (!(prop in obj)) {\n            obj[prop] = new Rete.Socket(prop);\n            obj[prop].combineWith(obj.any);\n        }\n        return obj[prop];\n    }\n});\n\nexport default sockets;\n","import Rete from 'rete';\nimport typeName from 'type-name';\nimport * as _ from 'lodash';\n\nimport sockets from '../retex/sockets';\n\nclass BeanComponent extends Rete.Component {\n    constructor(name, inputDefs, outputDefs) {\n        super(name);\n        this.inputDefs = inputDefs;\n        this.outputDefs = outputDefs;\n    }\n    \n    builder(node) {\n        node.inputDefs = _.cloneDeep(this.inputDefs);\n        for (const key of Object.keys(node.inputDefs)) {\n            if (key in node.data) node.inputDefs[key].defaultVal = node.data[key];\n        }\n        node.outputDefs = this.outputDefs;\n        \n        for (let [name, { type, defaultVal, displayName = name }] of _.toPairs(this.inputDefs)) {\n            if (!type) type = typeName(defaultVal);\n            if (name in node.data) defaultVal = node.data[name];\n            const input = new Rete.Input(name, displayName, sockets.any);\n            if (!(name in node.data)) {\n                node.data[name] = defaultVal;\n            }\n            node.addInput(input);\n        }\n        for (const [name, { /* type, */ displayName = name }] of _.toPairs(this.outputDefs)) {\n            const output = new Rete.Output(name, displayName, sockets.any);\n            node.addOutput(output);\n        }\n        return node;\n    }\n}\n\nexport { BeanComponent };\n","import { BeanComponent } from './BeanComponent';\n\nclass InitiatorComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Initiator',\n            {},\n            {},\n        );\n    }\n\n    async worker() {}\n}\n\nexport default InitiatorComponent;\n","import { BeanComponent } from './BeanComponent';\nimport * as _ from 'lodash';\n\nclass InputComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Input',\n            {\n                key: { type: 'string' },\n                type: { defaultVal: 'number', type: 'string', controlType: 'select', options: ['number', 'string'] },\n            },\n            {\n                val: { type: 'any', controlType: 'string', },\n            },\n        );\n    }\n\n    convert(value, type) {\n        if (type === 'number' && typeof value === 'string') return parseFloat(value);\n        if (type === 'string' && typeof value === 'number') return `${value}`;\n        return value;\n    }\n\n    * worker({ key, type }, __, { inputs }) {\n        const values = _.get(inputs, key);\n        if (values instanceof Array) {\n            for (const value of values) {\n                yield {\n                    val: this.convert(value, type),\n                };\n            }\n        } else {\n            yield {\n                val: this.convert(values, type),\n            };\n        }\n    }\n}\n\nclass OutputComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Output',\n            {\n                key: { type: 'string' },\n                val: { type: 'any', controlType: 'string' },\n            },\n            {},\n        );\n    }\n\n    * worker({ val, key }, __, { outputs }) {\n        // if (!_.has(outputs, key)) _.set(outputs, key, []);\n        // _.get(outputs, key).push(val);\n        _.set(outputs, key, val);\n        yield;\n    }\n}\n\nexport default [\n    InputComponent,\n    OutputComponent,\n];\n","import { BeanComponent } from './BeanComponent';\nimport { Parser } from 'expr-eval';\n\nclass ArithmeticComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Eval',\n            {\n                expr: { defaultVal: 'x' },\n                x: { defaultVal: '0', type: 'number' },\n            },\n            {\n                y: { type: 'number' },\n            },\n        );\n        this.parser = new Parser();\n    }\n\n    * worker({ expr, x }) {\n        const parsed = this.parser.parse(expr);\n        yield {\n            y: parsed.evaluate({ x }),\n        };\n    }\n}\n\nclass Arithmetic2Component extends BeanComponent {\n    constructor() {\n        super(\n            'Eval2',\n            {\n                expr: { defaultVal: 'x + y' },\n                x: { defaultVal: '0', type: 'number' },\n                y: { defaultVal: '0', type: 'number' },\n            },\n            {\n                z: { type: 'number' },\n            },\n        );\n        this.parser = new Parser();\n    }\n\n    * worker({ expr, x, y }) {\n        console.log(expr, x, y);\n        const parsed = this.parser.parse(expr);\n        yield {\n            z: parsed.evaluate({ x, y }),\n        };\n    }\n}\n\nclass ConstComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Const',\n            {\n                val: { type: 'any', controlType: 'string' },\n                type: { defaultVal: 'number', type: 'string', controlType: 'select', options: ['number', 'string'] },\n            },\n            {\n                val: { type: 'string' },\n            },\n        );\n    }\n\n    * worker({ val, type }) {\n        if (type === 'number') val = parseFloat(val);\n        yield { val };\n    }\n}\n\nexport default [\n    ArithmeticComponent,\n    Arithmetic2Component,\n    ConstComponent,\n];\n","/* eslint-disable default-case */\nimport { BeanComponent } from '../BeanComponent';\n\nconst textWidth = (text, sizes, spacing) => {\n    // VERY SIMPLE\n    // return size * text.length + spacing * size * (text.length - 1);\n    let width = 0;\n    for (let i = 0; i < text.length; ++i) {\n        width += sizes[i] * (1 + spacing);\n    }\n    width -= sizes[0] * spacing / 2;\n    width -= sizes[text.length - 1] * spacing / 2;\n    return width;\n}\n\nclass FontComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Font',\n            {\n                text: { defaultVal: '被害妄想携帯女子' },\n                x0: { defaultVal: 960, min: -1000, max: 3000 },\n                y0: { defaultVal: 540, min: -1000, max: 3000 },\n                size: { defaultVal: 90, min: 10, max: 400 },\n                dir: { defaultVal: 'horizontal', type: 'string', controlType: 'select', options: ['horizontal', 'vertical'] },\n                align: { defaultVal: 'begin', type: 'string', controlType: 'select', options: ['begin', 'middle', 'end'] },\n                spacing: { defaultVal: 0, min: -2, max: 2 },\n                ignoreWhitespaces: { defaultVal: true },\n                alignBaseline: { defaultVal: true },\n            },\n            {\n                i: { type: 'number' },\n                ch: { type: 'string' },\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                size: { type: 'number' },\n            },\n        );\n    }\n\n    async * worker({\n        text, x0, y0,\n        size, dir, align,\n        spacing, ignoreWhitespaces,\n        alignBaseline,\n    }) {\n        if (ignoreWhitespaces) text = text.split(/\\s+/).join('');\n        let x = x0, y = y0;\n        const sizes = new Array(text.length).fill(size);\n        const width = textWidth(text, sizes, spacing);\n        if (align === 'middle') {\n            switch (dir) {\n                case 'horizontal':\n                    x -= width / 2;\n                    break;\n                case 'vertical':\n                    y -= width / 2;\n                    break;\n            }\n        }\n        if (align === 'end') {\n            switch (dir) {\n                case 'horizontal':\n                    x -= width;\n                    break;\n                case 'vertical':\n                    y -= width;\n                    break;\n            }\n        }\n        switch (dir) {\n            case 'horizontal':\n                x += sizes[0] / 2;\n                break;\n            case 'vertical':\n                y += sizes[0] / 2;\n                break;\n        }\n        for (let i = 0; i < text.length; ++i) {\n            const ch = text[i];\n            const bx = x;\n            const by = alignBaseline && dir === 'horizontal' ? y - (sizes[i] - size) / 2 : y;\n            yield {\n                i,\n                ch,\n                x0: bx,\n                y0: by,\n                size: sizes[i],\n            };\n            switch (dir) {\n                case 'horizontal':\n                    x += (sizes[i] + sizes[i + 1]) * (1 + spacing) / 2;\n                    break;\n                case 'vertical':\n                    y += (sizes[i] + sizes[i + 1]) * (1 + spacing) / 2;\n                    break;\n            }\n        }\n        this.closed = ['cc'];\n    }\n}\n\nexport default FontComponent;\n","import CanvasComponent from './CanvasComponent';\nimport FontComponent from './FontComponent';\nimport CharComponent from './CharComponent';\n\nexport default [\n    CanvasComponent,\n    FontComponent,\n    CharComponent,\n];\n","import { BeanComponent } from '../BeanComponent';\n\nclass CanvasComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Canvas',\n            {\n                width: { defaultVal: 1920, min: 360, max: 2160 },\n                height: { defaultVal: 1080, min: 240, max: 1920 },\n                background: { type: 'color', defaultVal: '#F2F2F2' },\n            },\n            {\n                ctx: { type: 'canvas' },\n            },\n        );\n    }\n\n    async * worker({ width, height, background }, __, { inputs: { canvas } }) {\n        canvas.width = width;\n        canvas.height = height;\n        const scale = Math.min(canvas.parentNode.clientWidth / canvas.width, canvas.parentNode.clientHeight / canvas.height);\n        canvas.style.transform = `scale(${scale})`;\n        canvas.style.marginLeft = `${-width / 2}px`;\n        canvas.style.marginTop = `${-height / 2}px`;\n        const ctx = canvas.getContext('2d');\n        ctx.fillStyle = background;\n        ctx.fillRect(0, 0, width, height);\n        yield { ctx };\n    }\n}\n\nexport default CanvasComponent;\n","import { BeanComponent } from '../BeanComponent';\n\nclass CharComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Char',\n            {\n                ctx: { type: 'canvas', required: true },\n                ch: { defaultVal: '' },\n                x0: { defaultVal: 960, min: -1000, max: 3000 },\n                y0: { defaultVal: 540, min: -1000, max: 3000 },\n                size: { defaultVal: 90, min: 10, max: 400 },\n                rotate: { defaultVal: 0, min: -1, max: 1 },\n                color: { defaultVal: '#000000', type: 'color' },\n                fontFamily: { defaultVal: 'Hiragino Mincho Pro' },\n                fontWeight: { defaultVal: 900, min: 100, max: 900, step: 100 },\n            },\n            {},\n        );\n    }\n\n    * worker({\n        ctx, ch, x0, y0,\n        size, rotate, color,\n        fontFamily, fontWeight,\n    }) {\n        ctx.textBaseline = 'middle';\n        ctx.textAlign = 'center';\n        ctx.fillStyle = color;\n        ctx.font = `${fontWeight} ${size}px '${fontFamily}'`;\n        ctx.save();\n        ctx.translate(x0, y0);\n        ctx.rotate(rotate * Math.PI);\n        ctx.fillText(ch, 0, 0);\n        ctx.restore();\n        yield;\n    }\n}\n\nexport default CharComponent;\n","import { BeanComponent } from '../BeanComponent';\n\nclass SplitComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Split',\n            {\n                text: { defaultVal: '被害妄想携帯女子' },\n                parts: { defaultVal: 2, min: 1, max: 5, step: 1 },\n                randomness: { defaultVal: 2, min: 0, max: 4, },\n            },\n            {\n                parts: { type: 'number' },\n                i: { type: 'number' },\n                text: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ text, parts, randomness }) {\n        const step = text.length / parts;\n        const deltas = [0, ...new Array(parts - 1).fill(0).map(() => (Math.random() - 0.5) * 2 * randomness), 0];\n        for (let i = 0; i < parts; ++i) {\n            const begin = Math.round(i * step + deltas[i]);\n            const end = Math.round((i + 1) * step + deltas[i + 1]);\n            yield {\n                parts,\n                i,\n                text: text.substring(begin, end),\n            };\n        }\n    }\n}\n\nexport default SplitComponent;\n","const interp = (width, height, a, b, dir = 'horizontal') => {\n    switch (dir) {\n        case 'horizontal': return {\n            x: a * width, y: b * height,\n        }\n        case 'vertical': return {\n            x: b * width, y: a * height,\n        }\n        default: return { x: 0, y: 0 };\n    }\n}\n\nconst divide = (parts, i) => {\n    return 1 / (parts + 1) * (i + 1);\n}\n\nconst uniform = (min, max) => {\n    return Math.random() * (max - min) + min;\n}\n\nconst translate = ({ x: x1, y: y1 }, { x: x2, y: y2 }) => {\n    return { x: x1 + x2, y: y1 + y2 };\n}\n\nconst scatter = (val, dir, opposite = false, mirrored = false) => {\n    if (opposite) dir = { vertical: 'horizontal', horizontal: 'vertical' }[dir];\n    switch (dir) {\n        case 'horizontal': return {\n            x: mirrored ? -val : val, y: 0,\n        }\n        case 'vertical': return {\n            x: 0, y: val,\n        }\n        default: return { x: 0, y: 0 };\n    }\n}\n\nconst opposite = (n, f) => {\n    return f ? 1 - n : n;\n}\n\nconst choose = (...choices) => {\n    choices = choices.map(v => typeof v === 'object' ? v : { value: v });\n    const sum = choices.map(({ weight = 1 }) => weight).reduce((a, b) => a + b);\n    let n = Math.random() * sum;\n    for (const { value, weight = 1 } of choices) {\n        if (weight >= n) return value;\n        else n -= weight;\n    }\n    return choices[choices.length - 1].value;\n}\n\nexport { interp, divide, uniform, scatter, translate, opposite, choose };\n","import { BeanComponent } from '../BeanComponent';\nimport { interp, divide } from '../utils';\n\nclass BalancedAComponent extends BeanComponent {\n    constructor() {\n        super(\n            'BalancedA',\n            {\n                width: { type: 'number' },\n                height: { type: 'number' },\n                i: { type: 'number' },\n                parts: { type: 'number' },\n                dist: { defaultVal: 0.7, min: 0, max: 1, },\n                dir: { defaultVal: 'horizontal', type: 'string', controlType: 'select', options: ['horizontal', 'vertical'] },\n            },\n            {\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                dir: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ width, height, i, parts, dist, dir }) {\n        const { x, y } = interp(width, height, 0.5, (divide(parts, i) - 0.5) * dist + 0.5, dir);\n        yield {\n            x0: x,\n            y0: y,\n            dir,\n            align: 'middle',\n        };\n    }\n}\n\nexport default BalancedAComponent;\n","import { BeanComponent } from '../BeanComponent';\nimport pickRandom from 'pick-random';\n\nclass BalancedBComponent extends BeanComponent {\n    constructor() {\n        super(\n            'BalancedB',\n            {\n                text: { type: 'string' },\n                rows: { defaultVal: 3, min: 2, max: 4, step: 1 },\n                cols: { defaultVal: 4, min: 2, max: 4, step: 1 },\n                dist: { defaultVal: 2, min: 0.5, max: 10 },\n                width: { type: 'number' },\n                height: { type: 'number' },\n                size: { type: 'number' },\n            },\n            {\n                text: { type: 'string' },\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                align: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker ({ text, rows, cols, dist, width, height, size }) {\n        const indices = pickRandom(\n            new Array(cols).fill(0).map(\n                (_, u) => new Array(rows).fill(0).map((_, v) => ({ u, v }))\n            ).reduce((a, b) => [...a, ...b], []),\n            { count: Math.min(rows * cols, text.length) },\n        ).sort(({ u: u1, v: v1 }, { u: u2, v: v2 }) => v2 === v1 ? (u1 - u2) : (v1 - v2));\n\n        for (let i = 0; i < indices.length; ++i) {\n            const { u, v } = indices[i];\n            const x = width / 2 + (u - (cols - 1) / 2) * dist * size;\n            const y = height / 2 + (v - (rows - 1) / 2) * dist * size;\n            yield {\n                text: text[i],\n                x0: x,\n                y0: y,\n                align: 'middle',\n            };\n        }\n    }\n}\n\nexport default BalancedBComponent;\n","import { BeanComponent } from '../BeanComponent';\nimport { interp, opposite, scatter, translate } from '../utils';\n\nclass NeutralComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Neutral',\n            {\n                width: { type: 'number' },\n                height: { type: 'number' },\n                i: { type: 'number' },\n                size: { type: 'number' },\n                lineSpacing: { defaultVal: 1.5, min: 0.5, max: 5, },\n                dir: { defaultVal: 'horizontal', type: 'string', controlType: 'select', options: ['horizontal', 'vertical'] },\n                align: { defaultVal: 'begin', type: 'string', controlType: 'select', options: ['begin', 'end'] },\n                position: { defaultVal: 'left', type: 'string', controlType: 'select', options: ['left', 'right'] },\n                x0: { defaultVal: 0.15, min: 0.1, max: 0.25 },\n                y0: { defaultVal: 0.3, min: 0.1, max: 0.5 },\n            },\n            {\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                dir: { type: 'string' },\n                align: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ width, height, size, lineSpacing, i, dir, align, position, x0, y0 }) {\n        const x = opposite(x0, align === 'end');\n        const y = opposite(y0, position === 'right');\n        let point = interp(width, height, x, y, dir);\n        const delta = scatter(size * lineSpacing * (position === 'left' ? 1 : -1), dir, true);\n        for (; i > 0; --i) point = translate(point, delta);\n        yield {\n            x0: point.x,\n            y0: point.y,\n            dir,\n            align,\n        };\n    }\n}\n\nexport default NeutralComponent;\n","import { BeanComponent } from '../BeanComponent';\nimport { interp, opposite } from '../utils';\n\nclass ActiveAComponent extends BeanComponent {\n    constructor() {\n        super(\n            'ActiveA',\n            {\n                width: { type: 'number' },\n                height: { type: 'number' },\n                i: { type: 'number' },\n                angle: { defaultVal: -0.2, min: -1, max: 1 },\n                dir: { defaultVal: 'horizontal', type: 'string', controlType: 'select', options: ['horizontal', 'vertical'] },\n                x0: { defaultVal: 0.35, min: 0.25, max: 0.5 },\n                y0: { defaultVal: 0.25, min: 0.15, max: 0.4 },\n            },\n            {\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                dir: { type: 'string' },\n                rotate: { type: 'number' },\n                align: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ width, height, i, angle, dir, x0: a, y0: b }) {\n        const rx = opposite(a, i === 1);\n        const ry = opposite(b, i === 1);\n        const { x, y } = interp(width, height, rx, ry, dir);\n        yield {\n            x0: x,\n            y0: y,\n            dir,\n            rotate: angle * Math.PI / 2,\n            align: 'middle',\n        };\n    }\n}\n\nexport default ActiveAComponent;\n","import { BeanComponent } from '../BeanComponent';\nimport inside from 'point-in-polygon';\nimport pickRandom from 'pick-random';\nimport { uniform } from '../utils';\n\nconst distToShape = ({ x: x1, y: y1, r: r1 }, { x: x2, y: y2 }) => {\n    // Chebyshev distance\n    const dist = Math.max(Math.abs(x2 - x1), Math.abs(y2 - y1));\n    return dist - r1;\n}\n\nconst distToLine = ({ x: x1, y: y1 }, { x: x2, y: y2 }, { x, y }) => {\n    // euclidian distance to line\n    const dist = Math.abs((y2 - y1) * x - (x2 - x1) * y + x2 * y1 - y2 * x1)\n        / Math.sqrt(Math.pow(y2 - y1, 2) + Math.pow(x2 - x1, 2));\n    const angle = Math.atan2(y2 - y1, x2 - x1);\n    return Math.abs(dist / Math.sin(angle + Math.PI / 4)) / Math.sqrt(2);\n}\n\nconst dist = (bounds, shapes, point) => {\n    let dist = shapes\n        .map(shape => distToShape(shape, point))\n        .reduce((a, b) => Math.min(a, b), 100000);\n    for (let i = 0; i < bounds.length; ++i) {\n        const p1 = bounds[i], p2 = bounds[(i + 1) % bounds.length];\n        const newDist = distToLine(p1, p2, point);\n        if (newDist < dist) dist = newDist;\n    }\n    return dist;\n}\n\nconst bestCandidate = (bounds, { tries, width, height, maxR, minR = 0 }) => {\n    const shapes = [];\n    const polygon = bounds.map(({ x, y }) => [x, y]);\n    for (let i = 0; i < tries; ++i) {\n        const x = uniform(0, width);\n        const y = uniform(0, height);\n        if (!inside([x, y], polygon)) continue;\n        const d = Math.min(maxR, dist(bounds, shapes, { x, y }));\n        if (d <= minR) continue;\n        shapes.push({ x, y, r: d });\n    }\n    return shapes;\n}\n\nconst sort = (chosen, { debug, angle, scale }) => {\n    const chains = [];\n    chosen = chosen.sort(({ x: x1, y: y1 }, { x: x2, y: y2 }) => (x1 + y1) - (x2 + y2));\n    while (chosen.length > 0) {\n        // characters that is on the leftmost must be beginning of chain\n        const chain = [];\n        chain.push(chosen.splice(0, 1)[0]);\n        while (true) {\n            const { x: x1, y: y1, r: r1 } = chain[chain.length - 1];\n            const candidates = [...chosen]\n                .map((shape, i) => ({ ...shape, i }))\n                .map(({ x: x2, y: y2, r: r2, i }) => ({\n                    x: x2, y: y2, r: r2, i,\n                    s: Math.abs(Math.atan2(-(y2 - y1), x2 - x1)) / angle,\n                    d: (x2 - x1) / r1 / scale,\n                }))\n                .filter(({ s }) => s < 1)\n                .map(({ d, s, ...rest }) => ({\n                    ...rest,\n                    k: s + d,\n                }))\n                .sort(({ k: k1 }, { k: k2 }) => k1 - k2);\n            if (candidates.length === 0) break;\n            chain.push(chosen.splice(candidates[0].i, 1)[0]);\n        }\n        chains.push(chain);\n    }\n    return chains\n        .sort(([{ y: y1 }], [{ y: y2 }]) => y1 - y2)\n        .reduce((a, b) => [...a, ...b], []);\n}\n\n\nclass ActiveBComponent extends BeanComponent {\n    constructor() {\n        super(\n            'ActiveB',\n            {\n                width: { type: 'number' },\n                height: { type: 'number' },\n                text: { type: 'string' },\n                size: { type: 'number' },\n                dimension: { type: 'dimension' },\n                tries: { defaultVal: 10000, min: 100, max: 50000, step: 100 },\n                minR: { defaultVal: 0.78, min: 0, max: 1 },\n                sort: { defaultVal: true },\n                sortAngle: { defaultVal: 0.2, min: 0, max: 0.5 },\n                sortScale: { defaultVal: 3.0, min: 0, max: 10 },\n            },\n            {\n                i: { type: 'number' },\n                text: { type: 'string' },\n                x0: { type: 'number' },\n                y0: { type: 'number' },\n                size: { type: 'number' },\n                align: { type: 'string' },\n            },\n        );\n    }\n\n    async * worker({ width, height, text, tries, size, minR, sort: shouldSort, sortAngle, sortScale, dimension }) {\n        text = text.split(/\\s+/).join('');\n        const bounds = [\n            { x: width * dimension.x0, y: height * dimension.y0 },\n            { x: width * dimension.x1, y: height * dimension.y0 },\n            { x: width * dimension.x1, y: height * dimension.y1 },\n            { x: width * dimension.x0, y: height * dimension.y1 },\n        ];\n        const shapes = bestCandidate(bounds, {\n            tries,\n            width,\n            height,\n            maxR: size,\n            minR: size * minR,\n        });\n\n        // applySeed();\n        const chosen = pickRandom(shapes, { count: Math.min(shapes.length, text.length) });\n        const sorted = shouldSort\n            ? sort(chosen, { angle: sortAngle * Math.PI, scale: sortScale })\n            : chosen;\n        for (let i = 0; i < sorted.length; ++i) {\n            const { x, y, r } = sorted[i];\n            yield {\n                i,\n                text: text[i],\n                x0: x,\n                y0: y,\n                size: r * 2,\n                align: 'middle',\n            };\n        }\n    }\n}\n\nexport default ActiveBComponent;\n","import SplitComponent from './SplitComponent';\nimport BalancedAComponent from './BalancedAComponent';\nimport BalancedBComponent from './BalancedBComponent';\nimport NeutralComponent from './NeutralComponent';\nimport ActiveAComponent from './ActiveAComponent';\nimport ActiveBComponent from './ActiveBComponent';\n\nexport default [\n    SplitComponent,\n    BalancedAComponent,\n    BalancedBComponent,\n    NeutralComponent,\n    ActiveAComponent,\n    ActiveBComponent,\n];\n","import { BeanComponent } from '../BeanComponent';\n\nclass UniformComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Uniform',\n            {\n                min: { defaultVal: -0.5, min: -1, max: 1 },\n                max: { defaultVal: 0.5, min: -1, max: 1 },\n            },\n            {\n                val: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ min, max }) {\n        yield {\n            val: min + Math.random() * (max - min),\n        };\n    }\n}\n\nexport default UniformComponent;\n","import { BeanComponent } from '../BeanComponent';\n\nclass StepComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Step',\n            {\n                i: { defaultVal: 0 },\n                start: { defaultVal: 0, min: -1, max: 1 },\n                step: { defaultVal: 0.1, min: -1, max: 1 },\n            },\n            {\n                val: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ i, start, step }) {\n        yield {\n            val: start + i * step,\n        };\n    }\n}\n\nexport default StepComponent;\n","import { BeanComponent } from '../BeanComponent';\n\nclass ScatterComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Scatter',\n            {\n                cond: { type: 'number' },\n                thres: { type: 'number' },\n                val: { type: 'number' },\n            },\n            {\n                lt: { type: 'number' },\n                gt: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ cond, thres, val }) {\n        if (cond <= thres) {\n            yield { lt: val };\n        } else {\n            yield { gt: val };\n        }\n    }\n}\n\nclass GatherComponent extends BeanComponent {\n    constructor() {\n        super(\n            'Gather',\n            {\n                cond: { type: 'number' },\n                thres: { type: 'number' },\n                lt: { defaultVal: 0 },\n                gt: { defaultVal: 0 },\n            },\n            {\n                val: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ cond, thres, lt, gt }) {\n        if (cond <= thres) {\n            yield { val: lt };\n        } else {\n            yield { val: gt };\n        }\n    }\n}\n\nclass Gather10Component extends BeanComponent {\n    constructor() {\n        super(\n            'Gather10',\n            {\n                ind: { defaultVal: 0, min: 0, max: 9 },\n                n0: { defaultVal: 0 },\n                n1: { defaultVal: 0 },\n                n2: { defaultVal: 0 },\n                n3: { defaultVal: 0 },\n                n4: { defaultVal: 0 },\n                n5: { defaultVal: 0 },\n                n6: { defaultVal: 0 },\n                n7: { defaultVal: 0 },\n                n8: { defaultVal: 0 },\n                n9: { defaultVal: 0 },\n            },\n            {\n                val: { type: 'number' },\n            },\n        );\n    }\n\n    * worker({ ind, n0, n1, n2, n3, n4, n5, n6, n7, n8, n9 }) {\n        const vals = [n0, n1, n2, n3, n4, n5, n6, n7, n8, n9];\n        yield { val: vals[ind] };\n    }\n}\n\nexport default [\n    ScatterComponent,\n    GatherComponent,\n    Gather10Component,\n];\n","import UniformComponent from './UniformComponent';\nimport StepComponent from './StepComponent';\nimport conditional from './conditional';\n\nexport default [\n    UniformComponent,\n    StepComponent,\n    ...conditional,\n];\n","// lifecycle\nimport InitiatorComponent from './InitiatorComponent';\n\nimport io from './io';\nimport common from './common';\nimport render from './render';\nimport generation from './generation';\nimport calculation from './calculation';\n\nexport default [\n    InitiatorComponent,\n    ...io,\n    ...common,\n    ...render,\n    ...generation,\n    ...calculation,\n];\n","import React, { useCallback, useEffect, useState, useMemo, useRef } from 'react';\nimport { makeStyles, Button, Grid } from '@material-ui/core';\nimport Rete from 'rete';\nimport ConnectionPlugin from 'rete-connection-plugin';\nimport ReactRenderPlugin from 'rete-react-render-plugin';\nimport ContextMenuPlugin from 'rete-context-menu-plugin';\nimport { saveAs } from 'file-saver';\nimport ReactFileReader from 'react-file-reader';\nimport { readAsText } from 'promise-file-reader';\nimport MyNode from './MyNode';\nimport components from \"../components\";\n\nconst useStyles = makeStyles({\n    buttons: {\n        position: 'absolute',\n        right: 16,\n        bottom: 16,\n    },\n});\n\nfunction NodeMap({ setStep, defaults, onUpdate, name, next }) {\n    const classes = useStyles();\n    const nextStep = useCallback(() => {\n        setStep(next);\n    }, [setStep, next]);\n    const [root, setRoot] = useState(null);\n    const editor = useMemo(() => {\n        if (!root) return null;\n        return new Rete.NodeEditor('dcdc@0.1.0', root);\n    }, [root]);\n    const onUpdateRef = useRef(onUpdate);\n    useEffect(() => {\n        onUpdateRef.current = onUpdate;\n    }, [onUpdate]);\n    useEffect(() => {\n        if (!editor) return;\n        (async () => {\n            editor.use(ConnectionPlugin);\n            editor.use(ReactRenderPlugin, { component: MyNode });\n            editor.use(ContextMenuPlugin);\n            components.forEach(component => editor.register(new component()));\n\n            if (defaults) await editor.fromJSON(defaults);\n\n            editor.on('process nodecreated noderemoved connectioncreated connectionremoved', async () => {\n                (onUpdateRef.current)(await editor.toJSON());\n            });\n        })();\n    }, [editor, defaults]);\n    const download = useCallback(async () => {\n        if (!editor) return;\n        const data = await editor.toJSON();\n        const text = JSON.stringify(data);\n        const blob = new Blob([text], { type: 'application/json' });\n        saveAs(blob, `${name}.json`);\n    }, [editor, name]);\n    const upload = useCallback(async (files) => {\n        if (!editor) return;\n        const file = files[0];\n        const text = await readAsText(file);\n        const data = JSON.parse(text);\n        await editor.fromJSON(data);\n    }, [editor]);\n\n    return <>\n        <div ref={setRoot} style={{\n            position: 'absolute',\n            left: 0,\n            top: 0,\n            width: '100vw',\n            height: '100vh',\n        }} />\n        <Grid container spacing={2} classes={{ root: classes.buttons }} justify=\"flex-end\">\n            <Grid item>\n                <ReactFileReader\n                    fileTypes={[\".json\"]}\n                    handleFiles={upload}>\n                    <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        disableElevation\n                        component=\"span\"\n                    >\n                        上传\n                    </Button>\n                </ReactFileReader>\n            </Grid>\n            <Grid item>\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disableElevation\n                    onClick={download}\n                >\n                    下载\n                </Button>\n            </Grid>\n            <Grid item>\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    disableElevation\n                    onClick={nextStep}\n                >\n                    下一步\n                </Button>\n            </Grid>\n        </Grid>\n    </>\n}\n\nexport default NodeMap;\n","const config = [\n    {\n        name: 'Color set',\n        type: 'folder',\n        children: [\n            { name: 'Text color', type: 'color', path: 'textColor' },\n            { name: 'Background color', type: 'color', path: 'backgroundColor' },\n        ],\n    },\n    {\n        name: 'Type',\n        type: 'folder',\n        children: [\n            { name: 'Font family', type: 'string', path: 'fontFamily' },\n            { name: 'Font weight', type: 'number', path: 'fontWeight', min: 100, max: 900, step: 100 },\n            { name: 'Font size', type: 'number', path: 'size' },\n            { name: 'Letter spacing', type: 'number', path: 'letterSpacing' },\n            { name: 'Maximum split', type: 'number', path: 'splitMax' },\n            { name: 'Size randomness', type: 'number', path: 'sizeRandom' },\n            { name: 'Rotate randomness', type: 'number', path: 'rotateRandom' },\n        ],\n    },\n    {\n        name: 'Layout',\n        type: 'folder',\n        children: [\n            {\n                name: 'Type A',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.a.enabled' },\n                    { name: 'Minimum distance', type: 'number', path: 'modes.a.minDist', step: 0.01 },\n                    { name: 'Maximum distance', type: 'number', path: 'modes.a.maxDist', step: 0.01 },\n                ],\n            },\n            {\n                name: 'Type B',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.b.enabled' },\n                    { name: 'Line spacing', type: 'number', path: 'modes.b.lineSpacing', step: 0.01 },\n                ],\n            },\n            {\n                name: 'Type C',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.c.enabled' },\n                    { name: 'Minimum angle', type: 'number', path: 'modes.c.minAngle', step: 0.01 },\n                    { name: 'Maximum angle', type: 'number', path: 'modes.c.maxAngle', step: 0.01 },\n                ],\n            },\n            {\n                name: 'Type D',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.d.enabled' },\n                    { name: 'Minimum distance', type: 'number', path: 'modes.d.minDist', step: 0.01 },\n                    { name: 'Maximum distance', type: 'number', path: 'modes.d.maxDist', step: 0.01 },\n                ],\n            },\n            {\n                name: 'Type E',\n                type: 'folder',\n                children: [\n                    { name: 'Enabled', type: 'boolean', path: 'modes.e.enabled' },\n                    { name: 'Minimum radius', type: 'number', path: 'modes.e.minR', min: 0, max: 1, step: 0.01 },\n                    { name: 'Scale', type: 'number', path: 'modes.e.scale', step: 0.01 },\n                ],\n            },\n        ],\n    },\n    {\n        name: 'Pattern',\n        type: 'folder',\n        children: [\n            { name: 'Shape', type: 'string', path: 'pattern.shape' },\n            { name: 'Graphic color', type: 'color', path: 'pattern.color' },\n            { name: 'Center', type: 'boolean', path: 'pattern.center.enabled' },\n            { name: 'Follow', type: 'boolean', path: 'pattern.follow.enabled' },\n            { name: 'Random', type: 'boolean', path: 'pattern.random.enabled' },\n        ],\n    }\n];\n\nexport default config;\n","import * as _ from 'lodash';\n\nclass Engine {\n    constructor(id) {\n        this.id = id;\n        this.components = {};\n    }\n\n    register(component) {\n        this.components[component.name] = component;\n    }\n\n    async abort() {\n        // TODO: implement this\n    }\n\n    async process({ nodes }, data) {\n        const graph = { inputNodes: {}, inputs: {} };\n        for (const [, { id, inputs: nodeInputs }] of _.toPairs(nodes)) {\n            graph.inputNodes[id] = [];\n            graph.inputs[id] = {};\n            const { inputNodes: { [id]: inputNodes }, inputs: { [id]: inputs } } = graph;\n            for (const [dkey, { connections }] of _.toPairs(nodeInputs)) {\n                if (connections.length === 0) continue;\n                const [{ node: nid, output: skey }] = connections;\n                if (!inputNodes.includes(nid)) inputNodes.push(nid);\n                inputs[dkey] = { id: nid, key: skey };\n            }\n        }\n        try {\n            const queue = [];\n            queue.push({\n                values: {},\n                processed: [],\n                unprocessed: _.toPairs(nodes).map(([_, { id }]) => id),\n            });\n            while (queue.length !== 0) {\n                const [ctx] = queue.splice(0, 1);\n                const it = this.run(nodes, graph, ctx, data);\n                for await (const newCtx of it) queue.push(newCtx);\n            }\n        } catch (e) {\n            // circular dependency\n            console.log(e);\n        }\n    }\n\n    findNode(nodes, id) {\n        return _\n            .toPairs(nodes)\n            .map(([_, node]) => node)\n            .find(({ id: nodeId }) => nodeId === id);\n    }\n\n    async * run(nodes, graph, { processed, unprocessed, values }, data) {\n        const { inputNodes, inputs } = graph;\n        // find reachable node\n        const nid = unprocessed.find(id => inputNodes[id].every(iid => iid in values));\n        if (nid === undefined) throw new Error('no reachable node');\n        // collect inputs\n        const node = this.findNode(nodes, nid);\n        if (!node) throw new Error('unable to find node');\n        const { name, data: nodeData } = node;\n        const inputVals = _.clone(nodeData);\n        for (const [dkey, { id: sid, key: skey }] of _.toPairs(inputs[nid])) {\n            inputVals[dkey] = values[sid][skey];\n        }\n        // get outputs\n        const component = this.components[name];\n        const it = component.worker.call(component, inputVals, node, data);\n        for await (const outputVals of it) {\n            yield {\n                processed: [...processed, nid],\n                unprocessed: unprocessed.filter(id => id !== nid),\n                values: { ...values, [nid]: outputVals },\n            };\n        }\n    }\n}\n\nexport default Engine;\n","import Engine from './engine';\nimport components from \"../components\";\n\nexport default async (graph, inputs) => {\n    const engine = new Engine('dcdc@0.1.0');\n    for (const Component of components) {\n        engine.register(new Component());\n    }\n    const ctx = {\n        inputs,\n        outputs: {},\n    };\n    await engine.process(graph, ctx);\n    return ctx.outputs;\n};\n","/* eslint-disable default-case, no-fallthrough */\n\nimport * as _ from 'lodash';\nimport pickRandom from 'pick-random';\nimport random from 'random';\nimport seedrandom from 'seedrandom';\nimport Color from 'color';\nimport inside from 'point-in-polygon';\nimport BezierEasing from 'bezier-easing';\n\nimport { interp, divide, opposite, scatter, translate } from '../components/utils';\n\nconst textWidth = (text, sizes, spacing) => {\n    // VERY SIMPLE\n    // return size * text.length + spacing * size * (text.length - 1);\n    let width = 0;\n    for (let i = 0; i < text.length; ++i) {\n        width += sizes[i] * (1 + spacing);\n    }\n    width -= sizes[0] * spacing / 2;\n    width -= sizes[text.length - 1] * spacing / 2;\n    return width;\n}\n\nfunction* font({\n    text, x0, y0,\n    size, dir, align,\n    spacing, ignoreWhitespaces,\n    alignBaseline,\n    // pattern\n    patternType, ctx, currentTime, start, end, params,\n}) {\n    if (ignoreWhitespaces) text = text.split(/\\s+/).join('');\n    let x = x0, y = y0;\n    const sizes = new Array(text.length).fill(size);\n    const width = textWidth(text, sizes, spacing);\n    if (align === 'middle') {\n        switch (dir) {\n            case 'horizontal':\n                x -= width / 2;\n                break;\n            case 'vertical':\n                y -= width / 2;\n                break;\n        }\n    }\n    if (align === 'end') {\n        switch (dir) {\n            case 'horizontal':\n                x -= width;\n                break;\n            case 'vertical':\n                y -= width;\n                break;\n        }\n    }\n    switch (dir) {\n        case 'horizontal':\n            x += sizes[0] / 2;\n            break;\n        case 'vertical':\n            y += sizes[0] / 2;\n            break;\n    }\n\n    if (patternType === 'follow') {\n        const x0 = x, y0 = y;\n        const x1 = x + (dir === 'horizontal' ? width : 0);\n        const y1 = y + (dir === 'vertical' ? width : 0);\n        const t = random.float(0, 1);\n        pattern({\n            ctx, currentTime, start, end, params,\n            x0: x0 * (1 - t) + x1 * t,\n            y0: y0 * (1 - t) + y1 * t,\n            size: params.size * 1.5,\n        });\n    }\n\n    for (let i = 0; i < text.length; ++i) {\n        const ch = text[i];\n        const bx = x;\n        const by = alignBaseline && dir === 'horizontal' ? y - (sizes[i] - size) / 2 : y;\n        yield {\n            i,\n            ch,\n            x0: bx,\n            y0: by,\n            size: sizes[i],\n        };\n        switch (dir) {\n            case 'horizontal':\n                x += (sizes[i] + sizes[i + 1]) * (1 + spacing) / 2;\n                break;\n            case 'vertical':\n                y += (sizes[i] + sizes[i + 1]) * (1 + spacing) / 2;\n                break;\n        }\n    }\n}\n\nfunction char({\n    ctx, ch, x0, y0,\n    size, rotate, color,\n    fontFamily, fontWeight,\n}) {\n    ctx.textBaseline = 'middle';\n    ctx.textAlign = 'center';\n    ctx.fillStyle = color;\n    ctx.font = `${fontWeight} ${size}px '${fontFamily}'`;\n    ctx.save();\n    ctx.translate(x0, y0);\n    ctx.rotate(rotate * Math.PI);\n    ctx.fillText(ch, 0, 0);\n    ctx.restore();\n}\n\nfunction* split({ text, parts, randomness }) {\n    const step = text.length / parts;\n    const deltas = [0, ...new Array(parts - 1).fill(0).map(() => (Math.random() - 0.5) * 2 * randomness), 0];\n    for (let i = 0; i < parts; ++i) {\n        const begin = Math.round(i * step + deltas[i]);\n        const end = Math.round((i + 1) * step + deltas[i + 1]);\n        yield {\n            parts,\n            i,\n            text: text.substring(begin, end),\n        };\n    }\n}\n\nfunction* balancedA({ width, height, i, parts, dist, dir }) {\n    const { x, y } = interp(width, height, 0.5, (divide(parts, i) - 0.5) * dist + 0.5, dir);\n    yield {\n        x0: x,\n        y0: y,\n        dir,\n        align: 'middle',\n    };\n}\n\nfunction* balancedB({ text, rows, cols, dist, width, height, size }) {\n    const indices = pickRandom(\n        new Array(cols).fill(0).map(\n            (_, u) => new Array(rows).fill(0).map((_, v) => ({ u, v }))\n        ).reduce((a, b) => [...a, ...b], []),\n        { count: Math.min(rows * cols, text.length) },\n    ).sort(({ u: u1, v: v1 }, { u: u2, v: v2 }) => v2 === v1 ? (u1 - u2) : (v1 - v2));\n\n    for (let i = 0; i < indices.length; ++i) {\n        const { u, v } = indices[i];\n        const x = width / 2 + (u - (cols - 1) / 2) * dist * size;\n        const y = height / 2 + (v - (rows - 1) / 2) * dist * size;\n        yield {\n            text: text[i],\n            x0: x,\n            y0: y,\n            align: 'middle',\n        };\n    }\n}\n\nfunction* neutral({ width, height, size, lineSpacing, i, dir, align, position, x0, y0 }) {\n    const x = opposite(x0, align === 'end');\n    const y = opposite(y0, position === 'right');\n    let point = interp(width, height, x, y, dir);\n    const delta = scatter(size * lineSpacing * (position === 'left' ? 1 : -1), dir, true);\n    for (; i > 0; --i) point = translate(point, delta);\n    yield {\n        x0: point.x,\n        y0: point.y,\n        dir,\n        align,\n    };\n}\n\nfunction* activeA({ width, height, i, angle, dir, x0: a, y0: b }) {\n    const rx = opposite(a, i === 1);\n    const ry = opposite(b, i === 1);\n    const { x, y } = interp(width, height, rx, ry, dir);\n    yield {\n        x0: x,\n        y0: y,\n        dir,\n        rotate: angle * Math.PI / 2,\n        align: 'middle',\n    };\n}\n\nconst distToShape = ({ x: x1, y: y1, r: r1 }, { x: x2, y: y2 }) => {\n    // Chebyshev distance\n    const dist = Math.max(Math.abs(x2 - x1), Math.abs(y2 - y1));\n    return dist - r1;\n}\n\nconst distToLine = ({ x: x1, y: y1 }, { x: x2, y: y2 }, { x, y }) => {\n    // euclidian distance to line\n    const dist = Math.abs((y2 - y1) * x - (x2 - x1) * y + x2 * y1 - y2 * x1)\n        / Math.sqrt(Math.pow(y2 - y1, 2) + Math.pow(x2 - x1, 2));\n    const angle = Math.atan2(y2 - y1, x2 - x1);\n    return Math.abs(dist / Math.sin(angle + Math.PI / 4)) / Math.sqrt(2);\n}\n\nconst dist = (bounds, shapes, point) => {\n    let dist = shapes\n        .map(shape => distToShape(shape, point))\n        .reduce((a, b) => Math.min(a, b), 100000);\n    for (let i = 0; i < bounds.length; ++i) {\n        const p1 = bounds[i], p2 = bounds[(i + 1) % bounds.length];\n        const newDist = distToLine(p1, p2, point);\n        if (newDist < dist) dist = newDist;\n    }\n    return dist;\n}\n\nconst bestCandidate = (bounds, { tries, width, height, maxR, minR = 0 }) => {\n    const shapes = [];\n    const polygon = bounds.map(({ x, y }) => [x, y]);\n    for (let i = 0; i < tries; ++i) {\n        const x = random.float(0, width);\n        const y = random.float(0, height);\n        if (!inside([x, y], polygon)) continue;\n        const d = Math.min(maxR, dist(bounds, shapes, { x, y }));\n        if (d <= minR) continue;\n        shapes.push({ x, y, r: d });\n    }\n    return shapes;\n}\n\nconst sort = (chosen, { debug, angle, scale }) => {\n    const chains = [];\n    chosen = chosen.sort(({ x: x1, y: y1 }, { x: x2, y: y2 }) => (x1 + y1) - (x2 + y2));\n    while (chosen.length > 0) {\n        // characters that is on the leftmost must be beginning of chain\n        const chain = [];\n        chain.push(chosen.splice(0, 1)[0]);\n        while (true) {\n            const { x: x1, y: y1, r: r1 } = chain[chain.length - 1];\n            const candidates = [...chosen]\n                .map((shape, i) => ({ ...shape, i }))\n                .map(({ x: x2, y: y2, r: r2, i }) => ({\n                    x: x2, y: y2, r: r2, i,\n                    s: Math.abs(Math.atan2(-(y2 - y1), x2 - x1)) / angle,\n                    d: (x2 - x1) / r1 / scale,\n                }))\n                .filter(({ s }) => s < 1)\n                .map(({ d, s, ...rest }) => ({\n                    ...rest,\n                    k: s + d,\n                }))\n                .sort(({ k: k1 }, { k: k2 }) => k1 - k2);\n            if (candidates.length === 0) break;\n            chain.push(chosen.splice(candidates[0].i, 1)[0]);\n        }\n        chains.push(chain);\n    }\n    return chains\n        .sort(([{ y: y1 }], [{ y: y2 }]) => y1 - y2)\n        .reduce((a, b) => [...a, ...b], []);\n}\n\nfunction* activeB({ width, height, text, tries, size, minR, sort: shouldSort, sortAngle, sortScale, dimension }) {\n    text = text.split(/\\s+/).join('');\n    const bounds = [\n        { x: width * dimension.x0, y: height * dimension.y0 },\n        { x: width * dimension.x1, y: height * dimension.y0 },\n        { x: width * dimension.x1, y: height * dimension.y1 },\n        { x: width * dimension.x0, y: height * dimension.y1 },\n    ];\n    const shapes = bestCandidate(bounds, {\n        tries,\n        width,\n        height,\n        maxR: size,\n        minR: size * minR,\n    });\n\n    // applySeed();\n    const chosen = pickRandom(shapes, { count: Math.min(shapes.length, text.length) });\n    const sorted = shouldSort\n        ? sort(chosen, { angle: sortAngle * Math.PI, scale: sortScale })\n        : chosen;\n    for (let i = 0; i < sorted.length; ++i) {\n        const { x, y, r } = sorted[i];\n        yield {\n            i,\n            text: text[i],\n            x0: x,\n            y0: y,\n            size: r * 2,\n            align: 'middle',\n        };\n    }\n}\n\nfunction pattern({\n    ctx, x0, y0, currentTime, start, end, duration = 0.5, params, size,\n}) {\n    const rotation = currentTime * 1;\n    const easing1 = BezierEasing(0.22, 1, 0.36, 1);\n    const easing2 = BezierEasing(0.64, 0, 0.78, 0);\n    let t = 0;\n    if (currentTime < start) t = 0;\n    else if (currentTime < start + duration) t = easing1((currentTime - start) / duration);\n    else if (currentTime < end - duration) t = 1;\n    else if (currentTime < end) t = 1 - easing2(1 - (end - currentTime) / duration);\n    else t = 0;\n    ctx.save();\n    ctx.fillStyle = params.pattern.color;\n    ctx.translate(x0, y0);\n    const scale = t * size / 2;\n    ctx.scale(scale, scale);\n    const shape = params.pattern.shape;\n    if (shape !== 'line') ctx.rotate(rotation);\n    switch (params.pattern.shape) {\n        case 'square': case 'triangle': case 'pentagon': {\n            const sides = { square: 4, triangle: 3, pentagon: 5 }[params.pattern.shape];\n            ctx.beginPath();\n            ctx.moveTo(1, 0);\n            for (let i = 0; i < sides; ++i) {\n                const angle = Math.PI * 2 / sides * (i + 1);\n                ctx.lineTo(Math.cos(angle), Math.sin(angle));\n            }\n            ctx.fill();\n            break;\n        }\n        case 'circle': {\n            ctx.beginPath();\n            ctx.arc(0, 0, 1, 0, Math.PI * 2);\n            ctx.fill();\n            break;\n        }\n        case 'line': {\n            ctx.beginPath();\n            ctx.moveTo(+1.5, -0.2);\n            ctx.lineTo(+1.5, +0.2);\n            ctx.lineTo(-1.5, +0.2);\n            ctx.lineTo(-1.5, -0.2);\n            ctx.fill();\n            break;\n        }\n    }\n    ctx.restore();\n}\n\nfunction char2({\n    start, end, lyric, currentTime, duration = 0.5,\n    chi, ctx, ch, x0, y0, rotate, size, params, outEffect, inEffect,\n}) {\n    const inEndTime = chi * (end - duration - start) / lyric.length + start;\n    const inStartTime = inEndTime - duration;\n    const outStartTime = end - duration;\n    const outEndTime = outStartTime + duration;\n    if (currentTime < inStartTime) { }\n    else if (currentTime < inEndTime) {\n        const t = (currentTime - inStartTime) / (inEndTime - inStartTime);\n        switch (inEffect) {\n            case 'fade': {\n                const opacity = t;\n                char({\n                    ctx, ch, x0, y0,\n                    size,\n                    rotate,\n                    color: Color(params.textColor).alpha(opacity).string(),\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'blink': {\n                const thres = 0.2;\n                const opacity = t < thres ? 1 : (t - thres) / (1 - thres);\n                char({\n                    ctx, ch, x0, y0,\n                    size,\n                    rotate,\n                    color: Color(params.textColor).alpha(opacity).string(),\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'zoom': {\n                const easing = BezierEasing(0.22, 1, 0.36, 1);\n                char({\n                    ctx, ch, x0, y0,\n                    size: size * easing(t),\n                    rotate,\n                    color: params.textColor,\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'slide': {\n                const easing = BezierEasing(0.22, 1, 0.36, 1);\n                const k = 1 - easing(t);\n                const dx = 0, dy = -1;\n                char({\n                    ctx, ch, x0: x0 + dx * size * k, y0: y0 + dy * size * k,\n                    size,\n                    rotate,\n                    color: params.textColor,\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n        }\n    } else if (currentTime < outStartTime) {\n        char({\n            ctx, ch, x0, y0,\n            size,\n            rotate,\n            color: params.textColor,\n            fontFamily: params.fontFamily,\n            fontWeight: params.fontWeight,\n        });\n    } else if (currentTime < outEndTime) {\n        const t = (currentTime - outStartTime) / (outEndTime - outStartTime);\n        switch (outEffect) {\n            case 'fade': {\n                const opacity = 1 - t;\n                char({\n                    ctx, ch, x0, y0,\n                    size,\n                    rotate,\n                    color: Color(params.textColor).alpha(opacity).string(),\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'blink': {\n                const thres = 0.2;\n                const opacity = 1 - (t < thres ? 1 : (t - thres) / (1 - thres));\n                char({\n                    ctx, ch, x0, y0,\n                    size,\n                    rotate,\n                    color: Color(params.textColor).alpha(opacity).string(),\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n            case 'zoom': {\n                const easing = BezierEasing(0.64, 0, 0.78, 0);\n                char({\n                    ctx, ch, x0, y0,\n                    size: size * (1 - easing(t)),\n                    rotate,\n                    color: params.textColor,\n                    fontFamily: params.fontFamily,\n                    fontWeight: params.fontWeight,\n                });\n                break;\n            }\n        }\n    } else { }\n}\n\nrandom.patch();\n\nconst render = ({ width, height, seed, ctx, params, lyric, start, end, currentTime }) => {\n    if (lyric.length === 0) return;\n\n    const rng = seedrandom(`${seed}`);\n    random.use(rng);\n\n    const modes = _\n        .keys(params.modes)\n        .filter(key => params.modes[key].enabled);\n    if (modes.length === 0) return;\n    const mode = pickRandom(modes)[0];\n\n    const inEffect = pickRandom(['fade', 'blink', 'zoom', 'slide'])[0];\n    const outEffect = pickRandom(['fade', 'blink', 'zoom'])[0];\n\n    const patternType = pickRandom(['center', 'follow', 'random'].filter(type => params.pattern[type].enabled))[0];\n    switch (patternType) {\n        case 'center': {\n            pattern({\n                ctx, currentTime, start, end, params,\n                x0: width / 2, y0: height / 2,\n                size: params.size * 2,\n            });\n            break;\n        }\n        case 'follow': {\n            if (['a', 'b', 'c'].indexOf(mode) !== -1) break;\n            // intended fall through\n        }\n        case 'random': {\n            const num = random.int(7, 16);\n            for (let i = 0; i < num; ++i) {\n                const x0 = random.float(0, 1) * width;\n                const y0 = random.float(0, 1) * height;\n                const size = random.float(0.4, 1.0) * params.size;\n                pattern({\n                    ctx, x0, y0, currentTime, start, end, params, size,\n                });\n            }\n            break;\n        }\n    }\n\n    switch (mode) {\n        case 'a': {\n            const parts = Math.max(random.int(1, params.splitMax), Math.ceil(lyric.length / 12));\n            const dir = pickRandom(['horizontal', 'vertical'])[0];\n            const it = split({\n                text: lyric,\n                parts,\n                randomness: 0,\n            });\n            let chi = 0;\n            for (const { i, text } of it) {\n                const it = balancedA({\n                    width, height, i, parts,\n                    dist: random.float(params.modes.a.minDist, params.modes.a.maxDist),\n                    dir,\n                });\n                for (const { x0, y0, dir, align } of it) {\n                    const it = font({\n                        text, x0, y0,\n                        size: params.size,\n                        dir, align,\n                        spacing: params.letterSpacing,\n                        ignoreWhitespaces: true,\n                        alignBaseline: false,\n\n                        ctx, patternType, currentTime, start, end, params,\n                    });\n                    for (const { ch, x0, y0, size } of it) {\n                        char2({\n                            start, end, lyric, currentTime, chi, ctx, ch, x0, y0,\n                            rotate: 0, size, params, inEffect, outEffect,\n                        });\n                        ++chi;\n                    }\n                }\n            }\n            break;\n        }\n        case 'b': {\n            const parts = Math.max(random.int(1, params.splitMax), Math.ceil(lyric.length / 12));\n            const dir = pickRandom(['horizontal', 'vertical'])[0];\n            const align = pickRandom(['begin', 'end'])[0];\n            const position = pickRandom(['left', 'right'])[0];\n            const it = split({\n                text: lyric,\n                parts,\n                randomness: 0,\n            });\n            let chi = 0;\n            for (const { i, text } of it) {\n                const it = neutral({\n                    width, height,\n                    size: params.size,\n                    lineSpacing: params.modes.b.lineSpacing,\n                    i, dir, align, position,\n                    x0: 0.2, y0: 0.25,\n                });\n                for (const { x0, y0, dir, align } of it) {\n                    const it = font({\n                        text, x0, y0,\n                        size: params.size,\n                        dir, align,\n                        spacing: params.letterSpacing,\n                        ignoreWhitespaces: true,\n                        alignBaseline: false,\n\n                        ctx, patternType, currentTime, start, end, params,\n                    });\n                    for (const { ch, x0, y0, size } of it) {\n                        char2({\n                            start, end, lyric, currentTime, chi, ctx, ch, x0, y0,\n                            rotate: 0, size, params, inEffect, outEffect,\n                        });\n                        ++chi;\n                    }\n                }\n            }\n            break;\n        }\n        case 'c': {\n            const parts = 2;\n            const dir = pickRandom(['horizontal', 'vertical'])[0];\n            const angle = random.float(params.modes.c.minAngle, params.modes.c.maxAngle);\n            const it = split({\n                text: lyric,\n                parts,\n                randomness: 0,\n            });\n            let chi = 0;\n            for (const { i, text } of it) {\n                const it = activeA({\n                    width, height, i, dir, angle,\n                    x0: 0.2, y0: 0.25,\n                });\n                for (const { x0, y0, dir, align, rotate } of it) {\n                    const it = font({\n                        text, x0, y0,\n                        size: params.size,\n                        dir, align,\n                        spacing: params.letterSpacing,\n                        ignoreWhitespaces: true,\n                        alignBaseline: false,\n\n                        ctx, patternType, currentTime, start, end, params,\n                    });\n                    for (const { ch, x0, y0, size } of it) {\n                        char2({\n                            start, end, lyric, currentTime, chi, ctx, ch, x0, y0,\n                            rotate, size, params, inEffect, outEffect,\n                        });\n                        ++chi;\n                    }\n                }\n            }\n            break;\n        }\n        case 'd': {\n            let chi = 0;\n            let rows, cols;\n            do {\n                if (lyric.length > 20) {\n                    rows = 4;\n                    cols = 5;\n                } else {\n                    rows = random.int(2, 4);\n                    cols = random.int(2, 5);\n                }\n            } while (!(lyric.length > 20 || rows * cols >= lyric.length));\n            const it = balancedB({\n                text: lyric, rows, cols,\n                dist: random.float(params.modes.d.minDist, params.modes.d.maxDist),\n                width, height, size: params.size,\n            });\n            for (const { text, x0, y0, align } of it) {\n                const it = font({\n                    text, x0, y0,\n                    size: params.size,\n                    dir: 'horizontal', align,\n                    spacing: 0,\n                    ignoreWhitespaces: true,\n                    alignBaseline: false,\n                });\n                for (const { ch, x0, y0, size } of it) {\n                    char2({\n                        start, end, lyric, currentTime, chi, ctx, ch, x0, y0,\n                        rotate: 0, size, params, inEffect, outEffect,\n                    });\n                    ++chi;\n                }\n            }\n            break;\n        }\n        case 'e': {\n            const it = activeB({\n                text: lyric, width, height,\n                tries: 5000, size: params.size * 2,\n                minR: params.modes.e.minR,\n                sort: true, sortAngle: 0.2, sortScale: 3.0,\n                dimension: { x0: 0.25, x1: 0.75, y0: 0.2, y1: 0.8 },\n            });\n            for (const { i, text, x0, y0, size, align } of it) {\n                const it = font({\n                    text, x0, y0, size: size * params.modes.e.scale,\n                    dir: 'horizontal', align,\n                    spacing: 0,\n                    ignoreWhitespaces: true,\n                    alignBaseline: false,\n                });\n                for (const { ch, x0, y0, size } of it) {\n                    char2({\n                        start, end, lyric, currentTime, chi: i, ctx, ch, x0, y0,\n                        rotate: 0, size, params, inEffect, outEffect,\n                    });\n                }\n            }\n            break;\n        }\n    }\n}\n\nexport default render;","import { makeStyles, Grid, Typography, Button, Slider } from '@material-ui/core';\nimport React, { useEffect, useMemo, useState, useCallback } from 'react';\nimport DatGui, { DatFolder, DatString, DatNumber, DatBoolean, DatColor } from 'react-dat-gui';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport grey from '@material-ui/core/colors/grey';\nimport { Lrc } from 'lrc-kit';\nimport * as _ from 'lodash';\n\nimport config from './params';\nimport Length from './Length';\nimport exec from '../retex/exec';\nimport render from './render';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n    },\n    side: {\n        position: 'absolute',\n        top: 0,\n        right: 0,\n        padding: 4,\n        width: 345,\n    },\n    canvasContainer: {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: 'calc(100vw - 345px)',\n        height: 'calc(100vh - 195px)',\n        backgroundColor: '#222',\n        overflow: 'hidden',\n    },\n    canvas: {\n        position: 'absolute',\n        top: '50%',\n        left: '50%',\n    },\n    bottom: {\n        position: 'absolute',\n        left: 0,\n        bottom: 0,\n        height: 195,\n        width: 'calc(100vw - 345px)',\n        padding: '20px 30px 40px 30px',\n        boxSizing: 'border-box',\n    },\n    sections: {\n        position: 'relative',\n        height: 16,\n    },\n    section: {\n        position: 'absolute',\n        top: 0,\n        bottom: 0,\n        border: '1px solid #121212',\n    },\n    bottomInner: {\n        height: '100%',\n    },\n    title: {\n        lineHeight: 2.5,\n        fontWeight: 300,\n        paddingLeft: 16,\n    },\n});\n\nconst useFrame = (fn) => {\n    useEffect(() => {\n        let valid = true;\n        const onFrameWrapped = () => {\n            if (fn) fn();\n            if (valid) requestAnimationFrame(onFrameWrapped);\n        };\n        requestAnimationFrame(onFrameWrapped);\n        return () => { valid = false; };\n    }, [fn]);\n}\n\nfunction Generation({\n    moodboard,\n    data,\n    data: {\n        song,\n        artist,\n        album: { al_name: album },\n        sections,\n        featuress: { duration_s: length },\n        url,\n        lrc,\n    },\n    initialRef: { current: initialGraph },\n}) {\n    const classes = useStyles();\n\n    const lyrics = useMemo(() => {\n        let { lyrics } = Lrc.parse(lrc);\n        lyrics.sort(({ timestamp: t1 }, { timestamp: t2 }) => t1 - t2);\n        lyrics = lyrics.map(({ timestamp, ...rest }, i) => ({\n            start: timestamp,\n            end: i === lyrics.length - 1 ? length : lyrics[i + 1].timestamp,\n            ...rest,\n        }));\n        for (const l of lyrics) {\n            const { start: ls, end: le } = l;\n            l.section = sections.map(({ start: ss, duration: sd }, i) => ({\n                idx: i,\n                len: Math.max(0, Math.min(le, ss + sd) - Math.max(ls, ss)),\n            })).sort(({ len: l1 }, { len: l2 }) => -l1 + l2)[0].idx;\n        }\n        return lyrics;\n    }, [lrc, length, sections]);\n\n    const [params, setParams] = useState(null);\n    useEffect(() => {\n        Promise.all(sections.map((section, i) => exec(initialGraph, {\n            moodboard,\n            data,\n            idx: i,\n            section,\n        }))).then(setParams);\n    }, [data, moodboard, initialGraph, sections]);\n\n    const [canvas, setCanvas] = useState(null);\n\n    const convert = useMemo(() => {\n        const convert = ({ name, path, type, children, ...rest }) => {\n            switch (type) {\n                case 'folder': return (\n                    <DatFolder title={name} closed={false} {...rest}>\n                        {children.map(convert)}\n                    </DatFolder>\n                );\n                case 'string': return (\n                    <DatString path={path} label={name} {...rest} />\n                );\n                case 'color': return (\n                    <DatColor path={path} label={name} {...rest} />\n                );\n                case 'number': return (\n                    <DatNumber path={path} label={name} {...rest} />\n                );\n                case 'boolean': return (\n                    <DatBoolean path={path} label={name} {...rest} />\n                );\n                default: return null;\n            }\n        };\n        return convert;\n    }, []);\n\n    const audio = useMemo(() => {\n        return new Audio(url);\n    }, [url]);\n    const [currentTime, setCurrentTime] = useState(0);\n    const [playing, setPlaying] = useState(false);\n    useEffect(() => {\n        if (!audio) return;\n        const onUpdate = () => setCurrentTime(audio.currentTime);\n        const onPlay = () => setPlaying(true);\n        const onPause = () => setPlaying(false);\n        audio.addEventListener('timeupdate', onUpdate);\n        audio.addEventListener('play', onPlay);\n        audio.addEventListener('pause', onPause);\n        return () => {\n            audio.removeEventListener('timeupdate', onUpdate);\n            audio.removeEventListener('play', onPlay);\n            audio.removeEventListener('pause', onPause);\n        };\n    }, [audio]);\n    const onSeek = useCallback((_, newVal) => {\n        audio.currentTime = newVal;\n    }, [audio]);\n    const play = useCallback(() => audio.play(), [audio]);\n    const pause = useCallback(() => audio.pause(), [audio]);\n\n    const currentSegment = useMemo(() => {\n        for (let i = 0; i < sections.length; ++i) {\n            const { start, duration } = sections[i];\n            if (currentTime < start + duration) return i;\n        }\n        return sections.length - 1;\n    }, [currentTime, sections]);\n\n    const [initTime, setInitTime] = useState(new Date().getTime());\n    const renewTime = useCallback(() => {\n        setInitTime(() => new Date().getTime());\n    }, []);\n    const renderFrame = useCallback(() => {\n        if (!params || !canvas) return;\n\n        const currentTime = audio.currentTime;\n\n        const width = 1920, height = 1080;\n        // canvas\n        canvas.width = width;\n        canvas.height = height;\n        const scale = Math.min(canvas.parentNode.clientWidth / canvas.width, canvas.parentNode.clientHeight / canvas.height);\n        canvas.style.transform = `scale(${scale})`;\n        canvas.style.marginLeft = `${-width / 2}px`;\n        canvas.style.marginTop = `${-height / 2}px`;\n        const ctx = canvas.getContext('2d');\n        ctx.fillStyle = params[currentSegment].backgroundColor;\n        ctx.fillRect(0, 0, width, height);\n\n        lyrics\n            // .filter(({ section }) => section === currentSegment)\n            .forEach(({ start, end, content: lyric }, lyricIdx) => {\n                if (!(start - 1 <= currentTime && end + 1 >= currentTime)) return;\n                render({\n                    width, height, ctx, lyric, currentTime, start, end,\n                    seed: initTime /* + currentSegment * 1000 */ + lyricIdx,\n                    params: params[currentSegment],\n                });\n            });\n    }, [canvas, params, currentSegment, lyrics, audio, initTime]);\n    useFrame(renderFrame);\n\n    return (\n        <div className={classes.root}>\n            <div className={classes.canvasContainer}>\n                <canvas className={classes.canvas} ref={setCanvas} />\n            </div>\n            <div className={classes.side}>\n                <Typography color=\"textPrimary\" variant=\"h6\" classes={{ root: classes.title }}>\n                    段落 {currentSegment + 1}\n                </Typography>\n                {params && <DatGui\n                    data={params[currentSegment]}\n                    onUpdate={(newData) => {\n                        newData = { ...data, ...newData };\n                        setParams(params => {\n                            const newParams = _.cloneDeep(params);\n                            newParams[currentSegment] = newData;\n                            return newParams;\n                        });\n                    }}\n                    style={{\n                        position: 'relative',\n                        backgroundColor: '#1A1A1A',\n                        right: 0,\n                        left: 8,\n                        width: 'calc(100% - 8px)',\n                    }}\n                >\n                    {config.map(convert)}\n                </DatGui>}\n            </div>\n            <div className={classes.bottom}>\n                <Grid container direction=\"column\" justify=\"space-between\" classes={{ root: classes.bottomInner }}>\n                    <Grid item container>\n                        <Grid item xs={5}>\n                            <Typography color=\"textSecondary\">\n                                {song} / {artist} - {album.substring(0, 10)}\n                            </Typography>\n                        </Grid>\n                        <Grid item xs container justify=\"center\" spacing={4}>\n                            <Grid item>\n                                {playing ? (\n                                    <PauseIcon\n                                        style={{\n                                            color: grey[100],\n                                            cursor: 'pointer',\n                                        }}\n                                        onClick={pause}\n                                    />\n                                ) : (\n                                        <PlayArrowIcon\n                                            style={{\n                                                color: grey[100],\n                                                cursor: 'pointer',\n                                            }}\n                                            onClick={play}\n                                        />\n                                    )}\n                            </Grid>\n                            <Grid item>\n                                <FullscreenIcon\n                                    style={{\n                                        color: grey[100],\n                                        cursor: 'pointer',\n                                    }}\n                                />\n                            </Grid>\n                        </Grid>\n                        <Grid item xs={5} container justify=\"flex-end\" spacing={2}>\n                            <Grid item>\n                                <Button variant=\"outlined\" color=\"primary\" onClick={renewTime}>\n                                    换个效果\n                                </Button>\n                            </Grid>\n                            <Grid item>\n                                <Button variant=\"outlined\" color=\"primary\">\n                                    下载视频\n                                </Button>\n                            </Grid>\n                        </Grid>\n                    </Grid>\n                    <Grid item container direction=\"column\" spacing={0}>\n                        <Grid item>\n                            <Typography color=\"textPrimary\" variant=\"body2\">\n                                <Length time={currentTime} />\n                                &nbsp;/&nbsp;\n                                <Length time={length} />\n                            </Typography>\n                        </Grid>\n                        <Grid item>\n                            <Slider value={currentTime} onChange={onSeek} max={length} step={0.01} />\n                        </Grid>\n                        <Grid item>\n                            <div className={classes.sections}>\n                                {sections.map(({ start, climax }, i) => {\n                                    const end = (i === sections.length - 1 ? length : sections[i + 1].start);\n                                    return (\n                                        <div\n                                            key={`section-${i}`}\n                                            className={classes.section}\n                                            style={{\n                                                left: `${start / length * 100}%`,\n                                                right: `${(1 - end / length) * 100}%`,\n                                                backgroundColor: climax === 0 ? '#03DAC5' : '#F2994A',\n                                                opacity: i === currentSegment ? 1.0 : 0.2,\n                                            }}\n                                        />\n                                    );\n                                })}\n                            </div>\n                        </Grid>\n                    </Grid>\n                </Grid>\n            </div>\n        </div>\n    );\n}\n\nexport default Generation;\n","import SongSelection from './SongSelection';\nimport Loading from './Loading';\nimport Moodboard from './Moodboard';\nimport Segmentation from './Segmentation';\nimport { InitialValues, GenerationRules } from './Rules';\nimport Generation from './Generation';\n\nconst steps = {\n    SongSelection, Loading, Moodboard, Segmentation,\n    InitialValues, GenerationRules, Generation,\n};\n\nconst initialStep = 'SongSelection';\n\nexport { steps, initialStep };\n","import React from 'react';\nimport NodeMap from '../retex/NodeMap';\n\nfunction InitialValues({ initial, setInitial, setStep }) {\n    return (\n        <NodeMap setStep={setStep} defaults={initial} onUpdate={setInitial} name=\"initial\" next=\"Generation\"/>\n    );\n}\n\nfunction GenerationRules({ generation, setGeneration, setStep }) {\n    return (\n        <NodeMap setStep={setStep} defaults={generation} onUpdate={setGeneration} name=\"generation\" next=\"Generation\"/>\n    );\n}\n\nexport { InitialValues, GenerationRules };\n","import React, { useState, useMemo, useCallback, useRef } from 'react';\nimport { MuiThemeProvider, makeStyles } from '@material-ui/core';\nimport { createMuiTheme } from '@material-ui/core/styles';\n\nimport './index.css';\nimport { steps, initialStep } from './steps';\nimport defaultInitial from './assets/initial.json';\nimport defaultGeneration from './assets/generation.json';\n\nconst theme = createMuiTheme({\n    palette: {\n        primary: { main: '#BB86FC' },\n        secondary: { main: '#A0A0A0' },\n        type: 'dark',\n    },\n});\n\nconst useStyles = makeStyles({\n    root: {\n        backgroundColor: '#121212',\n        overflow: 'hidden',\n        height: '100vh',\n    },\n});\n\nconst useAutoSave = (initial, saveKey, timeout = 3000) => {\n    const actualInitial = useMemo(() => {\n        if (localStorage[saveKey]) {\n            return JSON.parse(localStorage[saveKey]);\n        } else return initial;\n    }, [initial, saveKey]);\n    const valueRef = useRef(actualInitial);\n    const setValue = useCallback((value) => {\n        valueRef.current = value;\n        setTimeout(() => {\n            if (value !== valueRef.current) return;\n            localStorage[saveKey] = JSON.stringify(value);\n            console.log('Data saved!');\n        }, timeout);\n    }, [saveKey, timeout]);\n    return [actualInitial, setValue, valueRef];\n}\n\nfunction App() {\n    const classes = useStyles();\n    const [step, setStep] = useState(initialStep);\n    const Component = steps[step];\n\n    const [id, setId] = useState('');\n    const [data, setData] = useState({});\n    const [error, setError] = useState(null);\n    const [moodboard, setMoodboard] = useState({});\n    const [initial, setInitial, initialRef] = useAutoSave(defaultInitial, 'initial');\n    const [generation, setGeneration, generationRef] = useAutoSave(defaultGeneration, 'generation');\n\n    const params = {\n        step, setStep,\n        id, setId,\n        error, setError,\n        data, setData,\n        moodboard, setMoodboard,\n        initial, setInitial, initialRef, generation, setGeneration, generationRef,\n    };\n\n    return (\n        <MuiThemeProvider theme={theme}>\n            <div className={classes.root}>\n                <Component {...params}/>\n            </div>\n        </MuiThemeProvider>\n    )\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(<App/>, document.querySelector('#root'));\n","module.exports = __webpack_public_path__ + \"static/media/logo-colored.9176ce0d.svg\";"],"sourceRoot":""}